var Uo=Object.defineProperty;var zo=(e,t,n)=>t in e?Uo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var et=(e,t,n)=>zo(e,typeof t!="symbol"?t+"":t,n);import{r as $a,a as qo,b as h,g as gt,u as St,c as Kt,L as wt,d as Bo,R as Fn,N as Wo,O as Yo,e as Go,f as Oe,B as Ko}from"./vendor-BaqZJf6O.js";import{_ as zt,C as qt,r as kt,S as Ho,F as Qr,g as Ma,a as Dt,b as Ht,c as Qo,d as Vo,E as Ua,o as Zo,L as Jo,i as za,e as qa,v as Ba,f as yi,h as Wa,j as Xo,k as bi,l as el,m as Ya,n as tl,p as Ge,q as $e,s as ke,t as ge,u as be,w as Qe,x as Me,y as nl,z as It,A as Ga,B as Ka,D as rl,G as il,H as al,I as sl,J as Nt,K as Cr,M as ol,N as vt}from"./firebase-BWXmirI4.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var nr={exports:{}},Lt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wi;function ll(){if(wi)return Lt;wi=1;var e=$a(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var u,m={},g=null,p=null;d!==void 0&&(g=""+d),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(p=c.ref);for(u in c)r.call(c,u)&&!s.hasOwnProperty(u)&&(m[u]=c[u]);if(l&&l.defaultProps)for(u in c=l.defaultProps,c)m[u]===void 0&&(m[u]=c[u]);return{$$typeof:t,type:l,key:g,ref:p,props:m,_owner:a.current}}return Lt.Fragment=n,Lt.jsx=o,Lt.jsxs=o,Lt}var ki;function cl(){return ki||(ki=1,nr.exports=ll()),nr.exports}var i=cl(),Zt={},ji;function dl(){if(ji)return Zt;ji=1;var e=qo();return Zt.createRoot=e.createRoot,Zt.hydrateRoot=e.hydrateRoot,Zt}var ul=dl(),rr={exports:{}},ir={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ri;function pl(){if(Ri)return ir;Ri=1;var e=$a();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,a=e.useRef,s=e.useEffect,o=e.useMemo,l=e.useDebugValue;return ir.useSyncExternalStoreWithSelector=function(c,d,u,m,g){var p=a(null);if(p.current===null){var y={hasValue:!1,value:null};p.current=y}else y=p.current;p=o(function(){function f(x){if(!k){if(k=!0,A=x,x=m(x),g!==void 0&&y.hasValue){var S=y.value;if(g(S,x))return C=S}return C=x}if(S=C,n(A,x))return S;var _=m(x);return g!==void 0&&g(S,_)?(A=x,S):(A=x,C=_)}var k=!1,A,C,v=u===void 0?null:u;return[function(){return f(d())},v===null?void 0:function(){return f(v())}]},[d,u,m,g]);var b=r(c,p[0],p[1]);return s(function(){y.hasValue=!0,y.value=b},[b]),l(b),b},ir}var Ci;function ml(){return Ci||(Ci=1,rr.exports=pl()),rr.exports}var fl=ml();function hl(e){e()}function gl(){let e=null,t=null;return{clear(){e=null,t=null},notify(){hl(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=e;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!r||e===null||(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Si={notify(){},get:()=>[]};function vl(e,t){let n,r=Si,a=0,s=!1;function o(b){u();const f=r.subscribe(b);let k=!1;return()=>{k||(k=!0,f(),m())}}function l(){r.notify()}function c(){y.onStateChange&&y.onStateChange()}function d(){return s}function u(){a++,n||(n=e.subscribe(c),r=gl())}function m(){a--,n&&a===0&&(n(),n=void 0,r.clear(),r=Si)}function g(){s||(s=!0,u())}function p(){s&&(s=!1,m())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:g,tryUnsubscribe:p,getListeners:()=>r};return y}var xl=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",yl=xl(),bl=()=>typeof navigator!="undefined"&&navigator.product==="ReactNative",wl=bl(),kl=()=>yl||wl?h.useLayoutEffect:h.useEffect,jl=kl(),ar=Symbol.for("react-redux-context"),sr=typeof globalThis!="undefined"?globalThis:{};function Rl(){var n;if(!h.createContext)return{};const e=(n=sr[ar])!=null?n:sr[ar]=new Map;let t=e.get(h.createContext);return t||(t=h.createContext(null),e.set(h.createContext,t)),t}var rt=Rl();function Cl(e){const{children:t,context:n,serverState:r,store:a}=e,s=h.useMemo(()=>{const c=vl(a);return{store:a,subscription:c,getServerState:r?()=>r:void 0}},[a,r]),o=h.useMemo(()=>a.getState(),[a]);jl(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=n||rt;return h.createElement(l.Provider,{value:s},t)}var Sl=Cl;function Vr(e=rt){return function(){return h.useContext(e)}}var Ha=Vr();function Qa(e=rt){const t=e===rt?Ha:Vr(e),n=()=>{const{store:r}=t();return r};return Object.assign(n,{withTypes:()=>n}),n}var Dl=Qa();function El(e=rt){const t=e===rt?Dl:Qa(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var it=El(),Al=(e,t)=>e===t;function Ll(e=rt){const t=e===rt?Ha:Vr(e),n=(r,a={})=>{const{equalityFn:s=Al}=typeof a=="function"?{equalityFn:a}:a,o=t(),{store:l,subscription:c,getServerState:d}=o;h.useRef(!0);const u=h.useCallback({[r.name](g){return r(g)}}[r.name],[r]),m=fl.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,d||l.getState,u,s);return h.useDebugValue(m),m};return Object.assign(n,{withTypes:()=>n}),n}var Se=Ll();function dn(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dn=function(n){return typeof n}:dn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},dn(e)}function _l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Il(e,t,n){return t&&Ol(e.prototype,t),e}function Tl(e,t){return t&&(dn(t)==="object"||typeof t=="function")?t:un(e)}function Sr(e){return Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Sr(e)}function un(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pl(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dr(e,t)}function Dr(e,t){return Dr=Object.setPrototypeOf||function(r,a){return r.__proto__=a,r},Dr(e,t)}function pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Va=(function(e){Pl(t,e);function t(){var n,r;_l(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return r=Tl(this,(n=Sr(t)).call.apply(n,[this].concat(s))),pn(un(r),"state",{bootstrapped:!1}),pn(un(r),"_unsubscribe",void 0),pn(un(r),"handlePersistorState",function(){var l=r.props.persistor,c=l.getState(),d=c.bootstrapped;d&&(r.props.onBeforeLift?Promise.resolve(r.props.onBeforeLift()).finally(function(){return r.setState({bootstrapped:!0})}):r.setState({bootstrapped:!0}),r._unsubscribe&&r._unsubscribe())}),r}return Il(t,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),t})(h.PureComponent);pn(Va,"defaultProps",{children:null,loading:null});let Nl={data:""},Fl=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Nl,$l=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ml=/\/\*[^]*?\*\/|  +/g,Di=/\n+/g,tt=(e,t)=>{let n="",r="",a="";for(let s in e){let o=e[s];s[0]=="@"?s[1]=="i"?n=s+" "+o+";":r+=s[1]=="f"?tt(o,s):s+"{"+tt(o,s[1]=="k"?"":t)+"}":typeof o=="object"?r+=tt(o,t?t.replace(/([^,])+/g,l=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=tt.p?tt.p(s,o):s+":"+o+";")}return n+(t&&a?t+"{"+a+"}":a)+r},Ke={},Za=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+Za(e[n]);return t}return e},Ul=(e,t,n,r,a)=>{let s=Za(e),o=Ke[s]||(Ke[s]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(s));if(!Ke[o]){let c=s!==e?e:(d=>{let u,m,g=[{}];for(;u=$l.exec(d.replace(Ml,""));)u[4]?g.shift():u[3]?(m=u[3].replace(Di," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][u[1]]=u[2].replace(Di," ").trim();return g[0]})(e);Ke[o]=tt(a?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&Ke.g?Ke.g:null;return n&&(Ke.g=Ke[o]),((c,d,u,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(Ke[o],t,r,l),o},zl=(e,t,n)=>e.reduce((r,a,s)=>{let o=t[s];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":tt(l,""):l===!1?"":l}return r+a+(o==null?"":o)},"");function $n(e){let t=this||{},n=e.call?e(t.p):e;return Ul(n.unshift?n.raw?zl(n,[].slice.call(arguments,1),t.p):n.reduce((r,a)=>Object.assign(r,a&&a.call?a(t.p):a),{}):n,Fl(t.target),t.g,t.o,t.k)}let Ja,Er,Ar;$n.bind({g:1});let Ze=$n.bind({k:1});function ql(e,t,n,r){tt.p=t,Ja=e,Er=n,Ar=r}function at(e,t){let n=this||{};return function(){let r=arguments;function a(s,o){let l=Object.assign({},s),c=l.className||a.className;n.p=Object.assign({theme:Er&&Er()},l),n.o=/ *go\d+/.test(c),l.className=$n.apply(n,r)+(c?" "+c:"");let d=e;return e[0]&&(d=l.as||e,delete l.as),Ar&&d[0]&&Ar(l),Ja(d,l)}return a}}var Bl=e=>typeof e=="function",Rn=(e,t)=>Bl(e)?e(t):e,Wl=(()=>{let e=0;return()=>(++e).toString()})(),Xa=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Yl=20,Zr="default",es=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:r}=t;return es(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(o=>o.id===a||a===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+s}))}}},mn=[],ts={toasts:[],pausedAt:void 0,settings:{toastLimit:Yl}},We={},ns=(e,t=Zr)=>{We[t]=es(We[t]||ts,e),mn.forEach(([n,r])=>{n===t&&r(We[t])})},rs=e=>Object.keys(We).forEach(t=>ns(e,t)),Gl=e=>Object.keys(We).find(t=>We[t].toasts.some(n=>n.id===e)),Mn=(e=Zr)=>t=>{ns(t,e)},Kl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Hl=(e={},t=Zr)=>{let[n,r]=h.useState(We[t]||ts),a=h.useRef(We[t]);h.useEffect(()=>(a.current!==We[t]&&r(We[t]),mn.push([t,r]),()=>{let o=mn.findIndex(([l])=>l===t);o>-1&&mn.splice(o,1)}),[t]);let s=n.toasts.map(o=>{var l,c,d;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||(e==null?void 0:e.duration)||Kl[o.type],style:{...e.style,...(d=e[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:s}},Ql=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Wl()}),Qt=e=>(t,n)=>{let r=Ql(t,e,n);return Mn(r.toasterId||Gl(r.id))({type:2,toast:r}),r.id},je=(e,t)=>Qt("blank")(e,t);je.error=Qt("error");je.success=Qt("success");je.loading=Qt("loading");je.custom=Qt("custom");je.dismiss=(e,t)=>{let n={type:3,toastId:e};t?Mn(t)(n):rs(n)};je.dismissAll=e=>je.dismiss(void 0,e);je.remove=(e,t)=>{let n={type:4,toastId:e};t?Mn(t)(n):rs(n)};je.removeAll=e=>je.remove(void 0,e);je.promise=(e,t,n)=>{let r=je.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let s=t.success?Rn(t.success,a):void 0;return s?je.success(s,{id:r,...n,...n==null?void 0:n.success}):je.dismiss(r),a}).catch(a=>{let s=t.error?Rn(t.error,a):void 0;s?je.error(s,{id:r,...n,...n==null?void 0:n.error}):je.dismiss(r)}),e};var Vl=1e3,Zl=(e,t="default")=>{let{toasts:n,pausedAt:r}=Hl(e,t),a=h.useRef(new Map).current,s=h.useCallback((m,g=Vl)=>{if(a.has(m))return;let p=setTimeout(()=>{a.delete(m),o({type:4,toastId:m})},g);a.set(m,p)},[]);h.useEffect(()=>{if(r)return;let m=Date.now(),g=n.map(p=>{if(p.duration===1/0)return;let y=(p.duration||0)+p.pauseDuration-(m-p.createdAt);if(y<0){p.visible&&je.dismiss(p.id);return}return setTimeout(()=>je.dismiss(p.id,t),y)});return()=>{g.forEach(p=>p&&clearTimeout(p))}},[n,r,t]);let o=h.useCallback(Mn(t),[t]),l=h.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=h.useCallback((m,g)=>{o({type:1,toast:{id:m,height:g}})},[o]),d=h.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=h.useCallback((m,g)=>{let{reverseOrder:p=!1,gutter:y=8,defaultPosition:b}=g||{},f=n.filter(C=>(C.position||b)===(m.position||b)&&C.height),k=f.findIndex(C=>C.id===m.id),A=f.filter((C,v)=>v<k&&C.visible).length;return f.filter(C=>C.visible).slice(...p?[A+1]:[0,A]).reduce((C,v)=>C+(v.height||0)+y,0)},[n]);return h.useEffect(()=>{n.forEach(m=>{if(m.dismissed)s(m.id,m.removeDelay);else{let g=a.get(m.id);g&&(clearTimeout(g),a.delete(m.id))}})},[n,s]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:d,calculateOffset:u}}},Jl=Ze`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Xl=Ze`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ec=Ze`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,tc=at("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Jl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Xl} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ec} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,nc=Ze`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,rc=at("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${nc} 1s linear infinite;
`,ic=Ze`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ac=Ze`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,sc=at("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ic} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ac} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,oc=at("div")`
  position: absolute;
`,lc=at("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,cc=Ze`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dc=at("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${cc} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,uc=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?h.createElement(dc,null,t):t:n==="blank"?null:h.createElement(lc,null,h.createElement(rc,{...r}),n!=="loading"&&h.createElement(oc,null,n==="error"?h.createElement(tc,{...r}):h.createElement(sc,{...r})))},pc=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,mc=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,fc="0%{opacity:0;} 100%{opacity:1;}",hc="0%{opacity:1;} 100%{opacity:0;}",gc=at("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,vc=at("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,xc=(e,t)=>{let n=e.includes("top")?1:-1,[r,a]=Xa()?[fc,hc]:[pc(n),mc(n)];return{animation:t?`${Ze(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ze(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},yc=h.memo(({toast:e,position:t,style:n,children:r})=>{let a=e.height?xc(e.position||t||"top-center",e.visible):{opacity:0},s=h.createElement(uc,{toast:e}),o=h.createElement(vc,{...e.ariaProps},Rn(e.message,e));return h.createElement(gc,{className:e.className,style:{...a,...n,...e.style}},typeof r=="function"?r({icon:s,message:o}):h.createElement(h.Fragment,null,s,o))});ql(h.createElement);var bc=({id:e,className:t,style:n,onHeightUpdate:r,children:a})=>{let s=h.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;r(e,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return h.createElement("div",{ref:s,className:t,style:n},a)},wc=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Xa()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...a}},kc=$n`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Jt=16,jc=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:a,toasterId:s,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:d}=Zl(n,s);return h.createElement("div",{"data-rht-toaster":s||"",style:{position:"fixed",zIndex:9999,top:Jt,left:Jt,right:Jt,bottom:Jt,pointerEvents:"none",...o},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(u=>{let m=u.position||t,g=d.calculateOffset(u,{reverseOrder:e,gutter:r,defaultPosition:t}),p=wc(m,g);return h.createElement(bc,{id:u.id,key:u.id,onHeightUpdate:d.updateHeight,className:u.visible?kc:"",style:p},u.type==="custom"?Rn(u.message,u):a?a(u):h.createElement(yc,{toast:u,position:m}))}))},yt=je;function Ce(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Rc=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ei=Rc,or=()=>Math.random().toString(36).substring(7).split("").join("."),Cc={INIT:`@@redux/INIT${or()}`,REPLACE:`@@redux/REPLACE${or()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${or()}`},Cn=Cc;function Jr(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Xr(e,t,n){if(typeof e!="function")throw new Error(Ce(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ce(0));if(typeof t=="function"&&typeof n=="undefined"&&(n=t,t=void 0),typeof n!="undefined"){if(typeof n!="function")throw new Error(Ce(1));return n(Xr)(e,t)}let r=e,a=t,s=new Map,o=s,l=0,c=!1;function d(){o===s&&(o=new Map,s.forEach((f,k)=>{o.set(k,f)}))}function u(){if(c)throw new Error(Ce(3));return a}function m(f){if(typeof f!="function")throw new Error(Ce(4));if(c)throw new Error(Ce(5));let k=!0;d();const A=l++;return o.set(A,f),function(){if(k){if(c)throw new Error(Ce(6));k=!1,d(),o.delete(A),s=null}}}function g(f){if(!Jr(f))throw new Error(Ce(7));if(typeof f.type=="undefined")throw new Error(Ce(8));if(typeof f.type!="string")throw new Error(Ce(17));if(c)throw new Error(Ce(9));try{c=!0,a=r(a,f)}finally{c=!1}return(s=o).forEach(A=>{A()}),f}function p(f){if(typeof f!="function")throw new Error(Ce(10));r=f,g({type:Cn.REPLACE})}function y(){const f=m;return{subscribe(k){if(typeof k!="object"||k===null)throw new Error(Ce(11));function A(){const v=k;v.next&&v.next(u())}return A(),{unsubscribe:f(A)}},[Ei](){return this}}}return g({type:Cn.INIT}),{dispatch:g,subscribe:m,getState:u,replaceReducer:p,[Ei]:y}}function Sc(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:Cn.INIT})=="undefined")throw new Error(Ce(12));if(typeof n(void 0,{type:Cn.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(Ce(13))})}function is(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(n[o]=e[o])}const r=Object.keys(n);let a;try{Sc(n)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<r.length;u++){const m=r[u],g=n[m],p=o[m],y=g(p,l);if(typeof y=="undefined")throw l&&l.type,new Error(Ce(14));d[m]=y,c=c||y!==p}return c=c||r.length!==Object.keys(o).length,c?d:o}}function Sn(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...r)=>t(n(...r)))}function Dc(...e){return t=>(n,r)=>{const a=t(n,r);let s=()=>{throw new Error(Ce(15))};const o={getState:a.getState,dispatch:(c,...d)=>s(c,...d)},l=e.map(c=>c(o));return s=Sn(...l)(a.dispatch),{...a,dispatch:s}}}function Ec(e){return Jr(e)&&"type"in e&&typeof e.type=="string"}var as=Symbol.for("immer-nothing"),Ai=Symbol.for("immer-draftable"),Ne=Symbol.for("immer-state");function ze(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var jt=Object.getPrototypeOf;function ut(e){return!!e&&!!e[Ne]}function Je(e){var t;return e?ss(e)||Array.isArray(e)||!!e[Ai]||!!((t=e.constructor)!=null&&t[Ai])||zn(e)||qn(e):!1}var Ac=Object.prototype.constructor.toString();function ss(e){if(!e||typeof e!="object")return!1;const t=jt(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Ac}function Dn(e,t){Un(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Un(e){const t=e[Ne];return t?t.type_:Array.isArray(e)?1:zn(e)?2:qn(e)?3:0}function Lr(e,t){return Un(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function os(e,t,n){const r=Un(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Lc(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function zn(e){return e instanceof Map}function qn(e){return e instanceof Set}function st(e){return e.copy_||e.base_}function _r(e,t){if(zn(e))return new Map(e);if(qn(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=ss(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[Ne];let a=Reflect.ownKeys(r);for(let s=0;s<a.length;s++){const o=a[s],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(jt(e),r)}else{const r=jt(e);if(r!==null&&n)return{...e};const a=Object.create(r);return Object.assign(a,e)}}function ei(e,t=!1){return Bn(e)||ut(e)||!Je(e)||(Un(e)>1&&(e.set=e.add=e.clear=e.delete=_c),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>ei(r,!0))),e}function _c(){ze(2)}function Bn(e){return Object.isFrozen(e)}var Oc={};function pt(e){const t=Oc[e];return t||ze(0,e),t}var Bt;function ls(){return Bt}function Ic(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Li(e,t){t&&(pt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Or(e){Ir(e),e.drafts_.forEach(Tc),e.drafts_=null}function Ir(e){e===Bt&&(Bt=e.parent_)}function _i(e){return Bt=Ic(Bt,e)}function Tc(e){const t=e[Ne];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Oi(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Ne].modified_&&(Or(t),ze(4)),Je(e)&&(e=En(t,e),t.parent_||An(t,e)),t.patches_&&pt("Patches").generateReplacementPatches_(n[Ne].base_,e,t.patches_,t.inversePatches_)):e=En(t,n,[]),Or(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==as?e:void 0}function En(e,t,n){if(Bn(t))return t;const r=t[Ne];if(!r)return Dn(t,(a,s)=>Ii(e,r,t,a,s,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return An(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const a=r.copy_;let s=a,o=!1;r.type_===3&&(s=new Set(a),a.clear(),o=!0),Dn(s,(l,c)=>Ii(e,r,a,l,c,n,o)),An(e,a,!1),n&&e.patches_&&pt("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function Ii(e,t,n,r,a,s,o){if(ut(a)){const l=s&&t&&t.type_!==3&&!Lr(t.assigned_,r)?s.concat(r):void 0,c=En(e,a,l);if(os(n,r,c),ut(c))e.canAutoFreeze_=!1;else return}else o&&n.add(a);if(Je(a)&&!Bn(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;En(e,a),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&An(e,a)}}function An(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ei(t,n)}function Pc(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:ls(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,s=ti;n&&(a=[r],s=Wt);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return r.draft_=l,r.revoke_=o,l}var ti={get(e,t){if(t===Ne)return e;const n=st(e);if(!Lr(n,t))return Nc(e,n,t);const r=n[t];return e.finalized_||!Je(r)?r:r===lr(e.base_,t)?(cr(e),e.copy_[t]=Pr(r,e)):r},has(e,t){return t in st(e)},ownKeys(e){return Reflect.ownKeys(st(e))},set(e,t,n){const r=cs(st(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const a=lr(st(e),t),s=a==null?void 0:a[Ne];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Lc(n,a)&&(n!==void 0||Lr(e.base_,t)))return!0;cr(e),Tr(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return lr(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,cr(e),Tr(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=st(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){ze(11)},getPrototypeOf(e){return jt(e.base_)},setPrototypeOf(){ze(12)}},Wt={};Dn(ti,(e,t)=>{Wt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Wt.deleteProperty=function(e,t){return Wt.set.call(this,e,t,void 0)};Wt.set=function(e,t,n){return ti.set.call(this,e[0],t,n,e[0])};function lr(e,t){const n=e[Ne];return(n?st(n):e)[t]}function Nc(e,t,n){var a;const r=cs(t,n);return r?"value"in r?r.value:(a=r.get)==null?void 0:a.call(e.draft_):void 0}function cs(e,t){if(!(t in e))return;let n=jt(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=jt(n)}}function Tr(e){e.modified_||(e.modified_=!0,e.parent_&&Tr(e.parent_))}function cr(e){e.copy_||(e.copy_=_r(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Fc=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const s=n;n=t;const o=this;return function(c=s,...d){return o.produce(c,u=>n.call(this,u,...d))}}typeof n!="function"&&ze(6),r!==void 0&&typeof r!="function"&&ze(7);let a;if(Je(t)){const s=_i(this),o=Pr(t,void 0);let l=!0;try{a=n(o),l=!1}finally{l?Or(s):Ir(s)}return Li(s,r),Oi(a,s)}else if(!t||typeof t!="object"){if(a=n(t),a===void 0&&(a=t),a===as&&(a=void 0),this.autoFreeze_&&ei(a,!0),r){const s=[],o=[];pt("Patches").generateReplacementPatches_(t,a,s,o),r(s,o)}return a}else ze(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let r,a;return[this.produce(t,n,(o,l)=>{r=o,a=l}),r,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Je(e)||ze(8),ut(e)&&(e=$c(e));const t=_i(this),n=Pr(e,void 0);return n[Ne].isManual_=!0,Ir(t),n}finishDraft(e,t){const n=e&&e[Ne];(!n||!n.isManual_)&&ze(9);const{scope_:r}=n;return Li(r,t),Oi(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const a=t[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(t=t.slice(n+1));const r=pt("Patches").applyPatches_;return ut(e)?r(e,t):this.produce(e,a=>r(a,t))}};function Pr(e,t){const n=zn(e)?pt("MapSet").proxyMap_(e,t):qn(e)?pt("MapSet").proxySet_(e,t):Pc(e,t);return(t?t.scope_:ls()).drafts_.push(n),n}function $c(e){return ut(e)||ze(10,e),ds(e)}function ds(e){if(!Je(e)||Bn(e))return e;const t=e[Ne];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=_r(e,t.scope_.immer_.useStrictShallowCopy_)}else n=_r(e,!0);return Dn(n,(r,a)=>{os(n,r,ds(a))}),t&&(t.finalized_=!1),n}var Fe=new Fc,us=Fe.produce;Fe.produceWithPatches.bind(Fe);Fe.setAutoFreeze.bind(Fe);Fe.setUseStrictShallowCopy.bind(Fe);Fe.applyPatches.bind(Fe);Fe.createDraft.bind(Fe);Fe.finishDraft.bind(Fe);function ps(e){return({dispatch:n,getState:r})=>a=>s=>typeof s=="function"?s(n,r,e):a(s)}var Mc=ps(),Uc=ps,zc=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Sn:Sn.apply(null,arguments)},qc=e=>e&&typeof e.match=="function";function Ft(e,t){function n(...r){if(t){let a=t(...r);if(!a)throw new Error(Ve(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:r[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=r=>Ec(r)&&r.type===e,n}var ms=class Tt extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Tt.prototype)}static get[Symbol.species](){return Tt}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Tt(...t[0].concat(this)):new Tt(...t.concat(this))}};function Ti(e){return Je(e)?us(e,()=>{}):e}function Xt(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function Bc(e){return typeof e=="boolean"}var Wc=()=>function(t){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=t!=null?t:{};let o=new ms;return n&&(Bc(n)?o.push(Mc):o.push(Uc(n.extraArgument))),o},Yc="RTK_autoBatch",Pi=e=>t=>{setTimeout(t,e)},Gc=(e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let a=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:Pi(10):e.type==="callback"?e.queueNotification:Pi(e.timeout),d=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},r,{subscribe(u){const m=()=>a&&u(),g=r.subscribe(m);return l.add(u),()=>{g(),l.delete(u)}},dispatch(u){var m;try{return a=!((m=u==null?void 0:u.meta)!=null&&m[Yc]),s=!a,s&&(o||(o=!0,c(d))),r.dispatch(u)}finally{a=!0}}})},Kc=e=>function(n){const{autoBatch:r=!0}=n!=null?n:{};let a=new ms(e);return r&&a.push(Gc(typeof r=="object"?r:void 0)),a};function Hc(e){const t=Wc(),{reducer:n=void 0,middleware:r,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof n=="function")l=n;else if(Jr(n))l=is(n);else throw new Error(Ve(1));let c;typeof r=="function"?c=r(t):c=t();let d=Sn;a&&(d=zc({trace:!1,...typeof a=="object"&&a}));const u=Dc(...c),m=Kc(u);let g=typeof o=="function"?o(m):m();const p=d(...g);return Xr(l,s,p)}function fs(e){const t={},n=[];let r;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Ve(28));if(l in t)throw new Error(Ve(29));return t[l]=o,a},addMatcher(s,o){return n.push({matcher:s,reducer:o}),a},addDefaultCase(s){return r=s,a}};return e(a),[t,n,r]}function Qc(e){return typeof e=="function"}function Vc(e,t){let[n,r,a]=fs(t),s;if(Qc(e))s=()=>Ti(e());else{const l=Ti(e);s=()=>l}function o(l=s(),c){let d=[n[c.type],...r.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,m)=>{if(m)if(ut(u)){const p=m(u,c);return p===void 0?u:p}else{if(Je(u))return us(u,g=>m(g,c));{const g=m(u,c);if(g===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return u},l)}return o.getInitialState=s,o}var Zc=(e,t)=>qc(e)?e.match(t):e(t);function Jc(...e){return t=>e.some(n=>Zc(n,t))}var Xc="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ed=(e=21)=>{let t="",n=e;for(;n--;)t+=Xc[Math.random()*64|0];return t},td=["name","message","stack","code"],dr=class{constructor(e,t){et(this,"_type");this.payload=e,this.meta=t}},Ni=class{constructor(e,t){et(this,"_type");this.payload=e,this.meta=t}},nd=e=>{if(typeof e=="object"&&e!==null){const t={};for(const n of td)typeof e[n]=="string"&&(t[n]=e[n]);return t}return{message:String(e)}},Fi="External signal was aborted",Re=(()=>{function e(t,n,r){const a=Ft(t+"/fulfilled",(c,d,u,m)=>({payload:c,meta:{...m||{},arg:u,requestId:d,requestStatus:"fulfilled"}})),s=Ft(t+"/pending",(c,d,u)=>({payload:void 0,meta:{...u||{},arg:d,requestId:c,requestStatus:"pending"}})),o=Ft(t+"/rejected",(c,d,u,m,g)=>({payload:m,error:(r&&r.serializeError||nd)(c||"Rejected"),meta:{...g||{},arg:u,requestId:d,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function l(c,{signal:d}={}){return(u,m,g)=>{const p=r!=null&&r.idGenerator?r.idGenerator(c):ed(),y=new AbortController;let b,f;function k(C){f=C,y.abort()}d&&(d.aborted?k(Fi):d.addEventListener("abort",()=>k(Fi),{once:!0}));const A=(async function(){var x,S;let C;try{let _=(x=r==null?void 0:r.condition)==null?void 0:x.call(r,c,{getState:m,extra:g});if(id(_)&&(_=await _),_===!1||y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const j=new Promise((O,E)=>{b=()=>{E({name:"AbortError",message:f||"Aborted"})},y.signal.addEventListener("abort",b)});u(s(p,c,(S=r==null?void 0:r.getPendingMeta)==null?void 0:S.call(r,{requestId:p,arg:c},{getState:m,extra:g}))),C=await Promise.race([j,Promise.resolve(n(c,{dispatch:u,getState:m,extra:g,requestId:p,signal:y.signal,abort:k,rejectWithValue:(O,E)=>new dr(O,E),fulfillWithValue:(O,E)=>new Ni(O,E)})).then(O=>{if(O instanceof dr)throw O;return O instanceof Ni?a(O.payload,p,c,O.meta):a(O,p,c)})])}catch(_){C=_ instanceof dr?o(null,p,c,_.payload,_.meta):o(_,p,c)}finally{b&&y.signal.removeEventListener("abort",b)}return r&&!r.dispatchConditionRejection&&o.match(C)&&C.meta.condition||u(C),C})();return Object.assign(A,{abort:k,requestId:p,arg:c,unwrap(){return A.then(rd)}})}}return Object.assign(l,{pending:s,rejected:o,fulfilled:a,settled:Jc(o,a),typePrefix:t})}return e.withTypes=()=>e,e})();function rd(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function id(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var ad=Symbol.for("rtk-slice-createasyncthunk");function sd(e,t){return`${e}/${t}`}function od({creators:e}={}){var n;const t=(n=e==null?void 0:e.asyncThunk)==null?void 0:n[ad];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Ve(11));const l=(typeof a.reducers=="function"?a.reducers(cd()):a.reducers)||{},c=Object.keys(l),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(v,x){const S=typeof v=="string"?v:v.type;if(!S)throw new Error(Ve(12));if(S in d.sliceCaseReducersByType)throw new Error(Ve(13));return d.sliceCaseReducersByType[S]=x,u},addMatcher(v,x){return d.sliceMatchers.push({matcher:v,reducer:x}),u},exposeAction(v,x){return d.actionCreators[v]=x,u},exposeCaseReducer(v,x){return d.sliceCaseReducersByName[v]=x,u}};c.forEach(v=>{const x=l[v],S={reducerName:v,type:sd(s,v),createNotation:typeof a.reducers=="function"};ud(x)?md(S,x,u,t):dd(S,x,u)});function m(){const[v={},x=[],S=void 0]=typeof a.extraReducers=="function"?fs(a.extraReducers):[a.extraReducers],_={...v,...d.sliceCaseReducersByType};return Vc(a.initialState,j=>{for(let O in _)j.addCase(O,_[O]);for(let O of d.sliceMatchers)j.addMatcher(O.matcher,O.reducer);for(let O of x)j.addMatcher(O.matcher,O.reducer);S&&j.addDefaultCase(S)})}const g=v=>v,p=new Map,y=new WeakMap;let b;function f(v,x){return b||(b=m()),b(v,x)}function k(){return b||(b=m()),b.getInitialState()}function A(v,x=!1){function S(j){let O=j[v];return typeof O=="undefined"&&x&&(O=Xt(y,S,k)),O}function _(j=g){const O=Xt(p,x,()=>new WeakMap);return Xt(O,j,()=>{var $;const E={};for(const[B,W]of Object.entries(($=a.selectors)!=null?$:{}))E[B]=ld(W,j,()=>Xt(y,j,k),x);return E})}return{reducerPath:v,getSelectors:_,get selectors(){return _(S)},selectSlice:S}}const C={name:s,reducer:f,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:k,...A(o),injectInto(v,{reducerPath:x,...S}={}){const _=x!=null?x:o;return v.inject({reducerPath:_,reducer:f},S),{...C,...A(_,!0)}}};return C}}function ld(e,t,n,r){function a(s,...o){let l=t(s);return typeof l=="undefined"&&r&&(l=n()),e(l,...o)}return a.unwrapped=e,a}var Et=od();function cd(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function dd({type:e,reducerName:t,createNotation:n},r,a){let s,o;if("reducer"in r){if(n&&!pd(r))throw new Error(Ve(17));s=r.reducer,o=r.prepare}else s=r;a.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Ft(e,o):Ft(e))}function ud(e){return e._reducerDefinitionType==="asyncThunk"}function pd(e){return e._reducerDefinitionType==="reducerWithPrepare"}function md({type:e,reducerName:t},n,r,a){if(!a)throw new Error(Ve(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=n,m=a(e,s,u);r.exposeAction(t,m),o&&r.addCase(m.fulfilled,o),l&&r.addCase(m.pending,l),c&&r.addCase(m.rejected,c),d&&r.addMatcher(m.settled,d),r.exposeCaseReducer(t,{fulfilled:o||en,pending:l||en,rejected:c||en,settled:d||en})}function en(){}function Ve(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ni="persist:",hs="persist/FLUSH",Wn="persist/REHYDRATE",gs="persist/PAUSE",vs="persist/PERSIST",ri="persist/PURGE",xs="persist/REGISTER",fd=-1;function fn(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fn=function(n){return typeof n}:fn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},fn(e)}function $i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$i(n,!0).forEach(function(r){gd(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$i(n).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vd(e,t,n,r){r.debug;var a=hd({},n);return e&&fn(e)==="object"&&Object.keys(e).forEach(function(s){s!=="_persist"&&t[s]===n[s]&&(a[s]=e[s])}),a}function xd(e){var t=e.blacklist||null,n=e.whitelist||null,r=e.transforms||[],a=e.throttle||0,s="".concat(e.keyPrefix!==void 0?e.keyPrefix:ni).concat(e.key),o=e.storage,l;e.serialize===!1?l=function(x){return x}:typeof e.serialize=="function"?l=e.serialize:l=yd;var c=e.writeFailHandler||null,d={},u={},m=[],g=null,p=null,y=function(x){Object.keys(x).forEach(function(S){k(S)&&d[S]!==x[S]&&m.indexOf(S)===-1&&m.push(S)}),Object.keys(d).forEach(function(S){x[S]===void 0&&k(S)&&m.indexOf(S)===-1&&d[S]!==void 0&&m.push(S)}),g===null&&(g=setInterval(b,a)),d=x};function b(){if(m.length===0){g&&clearInterval(g),g=null;return}var v=m.shift(),x=r.reduce(function(S,_){return _.in(S,v,d)},d[v]);if(x!==void 0)try{u[v]=l(x)}catch(S){console.error("redux-persist/createPersistoid: error serializing state",S)}else delete u[v];m.length===0&&f()}function f(){Object.keys(u).forEach(function(v){d[v]===void 0&&delete u[v]}),p=o.setItem(s,l(u)).catch(A)}function k(v){return!(n&&n.indexOf(v)===-1&&v!=="_persist"||t&&t.indexOf(v)!==-1)}function A(v){c&&c(v)}var C=function(){for(;m.length!==0;)b();return p||Promise.resolve()};return{update:y,flush:C}}function yd(e){return JSON.stringify(e)}function bd(e){var t=e.transforms||[],n="".concat(e.keyPrefix!==void 0?e.keyPrefix:ni).concat(e.key),r=e.storage;e.debug;var a;return e.deserialize===!1?a=function(o){return o}:typeof e.deserialize=="function"?a=e.deserialize:a=wd,r.getItem(n).then(function(s){if(s)try{var o={},l=a(s);return Object.keys(l).forEach(function(c){o[c]=t.reduceRight(function(d,u){return u.out(d,c,l)},a(l[c]))}),o}catch(c){throw c}else return})}function wd(e){return JSON.parse(e)}function kd(e){var t=e.storage,n="".concat(e.keyPrefix!==void 0?e.keyPrefix:ni).concat(e.key);return t.removeItem(n,jd)}function jd(e){}function Mi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mi(n,!0).forEach(function(r){Rd(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mi(n).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Rd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cd(e,t){if(e==null)return{};var n=Sd(e,t),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Sd(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,s;for(s=0;s<r.length;s++)a=r[s],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}var Dd=5e3;function Nr(e,t){var n=e.version!==void 0?e.version:fd;e.debug;var r=e.stateReconciler===void 0?vd:e.stateReconciler,a=e.getStoredState||bd,s=e.timeout!==void 0?e.timeout:Dd,o=null,l=!1,c=!0,d=function(m){return m._persist.rehydrated&&o&&!c&&o.update(m),m};return function(u,m){var g=u||{},p=g._persist,y=Cd(g,["_persist"]),b=y;if(m.type===vs){var f=!1,k=function(j,O){f||(m.rehydrate(e.key,j,O),f=!0)};if(s&&setTimeout(function(){!f&&k(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(e.key,'"')))},s),c=!1,o||(o=xd(e)),p)return He({},t(b,m),{_persist:p});if(typeof m.rehydrate!="function"||typeof m.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return m.register(e.key),a(e).then(function(_){var j=e.migrate||function(O,E){return Promise.resolve(O)};j(_,n).then(function(O){k(O)},function(O){k(void 0,O)})},function(_){k(void 0,_)}),He({},t(b,m),{_persist:{version:n,rehydrated:!1}})}else{if(m.type===ri)return l=!0,m.result(kd(e)),He({},t(b,m),{_persist:p});if(m.type===hs)return m.result(o&&o.flush()),He({},t(b,m),{_persist:p});if(m.type===gs)c=!0;else if(m.type===Wn){if(l)return He({},b,{_persist:He({},p,{rehydrated:!0})});if(m.key===e.key){var A=t(b,m),C=m.payload,v=r!==!1&&C!==void 0?r(C,u,A,e):A,x=He({},v,{_persist:He({},p,{rehydrated:!0})});return d(x)}}}if(!p)return t(u,m);var S=t(b,m);return S===b?u:d(He({},S,{_persist:p}))}}function Ui(e){return Ld(e)||Ad(e)||Ed()}function Ed(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Ad(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function Ld(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function zi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zi(n,!0).forEach(function(r){_d(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zi(n).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ys={registry:[],bootstrapped:!1},Od=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ys,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case xs:return Fr({},t,{registry:[].concat(Ui(t.registry),[n.key])});case Wn:var r=t.registry.indexOf(n.key),a=Ui(t.registry);return a.splice(r,1),Fr({},t,{registry:a,bootstrapped:a.length===0});default:return t}};function Id(e,t,n){var r=Xr(Od,ys,void 0),a=function(c){r.dispatch({type:xs,key:c})},s=function(c,d,u){var m={type:Wn,payload:d,err:u,key:c};e.dispatch(m),r.dispatch(m)},o=Fr({},r,{purge:function(){var c=[];return e.dispatch({type:ri,result:function(u){c.push(u)}}),Promise.all(c)},flush:function(){var c=[];return e.dispatch({type:hs,result:function(u){c.push(u)}}),Promise.all(c)},pause:function(){e.dispatch({type:gs})},persist:function(){e.dispatch({type:vs,register:a,rehydrate:s})}});return o.persist(),o}var _t={},tn={},nn={},qi;function Td(){if(qi)return nn;qi=1,nn.__esModule=!0,nn.default=a;function e(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(l){return typeof l}:e=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},e(s)}function t(){}var n={getItem:t,setItem:t,removeItem:t};function r(s){if((typeof self=="undefined"?"undefined":e(self))!=="object"||!(s in self))return!1;try{var o=self[s],l="redux-persist ".concat(s," test");o.setItem(l,"test"),o.getItem(l),o.removeItem(l)}catch(c){return!1}return!0}function a(s){var o="".concat(s,"Storage");return r(o)?self[o]:n}return nn}var Bi;function Pd(){if(Bi)return tn;Bi=1,tn.__esModule=!0,tn.default=n;var e=t(Td());function t(r){return r&&r.__esModule?r:{default:r}}function n(r){var a=(0,e.default)(r);return{getItem:function(o){return new Promise(function(l,c){l(a.getItem(o))})},setItem:function(o,l){return new Promise(function(c,d){c(a.setItem(o,l))})},removeItem:function(o){return new Promise(function(l,c){l(a.removeItem(o))})}}}return tn}var Wi;function Nd(){if(Wi)return _t;Wi=1,_t.__esModule=!0,_t.default=void 0;var e=t(Pd());function t(r){return r&&r.__esModule?r:{default:r}}var n=(0,e.default)("local");return _t.default=n,_t}var Fd=Nd();const ii=gt(Fd),De={APP_ID:"wxed0d87f9100935d4",APP_SECRET:"e8a88b5e0271b89a1dc71261d9063fad",REDIRECT_URI:"https://www.homefreshfoods.ai/wechat/callback",SCOPE:"snsapi_userinfo",WEB_SCOPE:"snsapi_login",MOBILE_AUTHORIZE_URL:"https://open.weixin.qq.com/connect/oauth2/authorize",QR_AUTHORIZE_URL:"https://open.weixin.qq.com/connect/qrconnect",ACCESS_TOKEN_URL:"https://api.weixin.qq.com/sns/oauth2/access_token",USER_INFO_URL:"https://api.weixin.qq.com/sns/userinfo"},Ln=()=>(console.log("� Redirect URI:",De.REDIRECT_URI),De.REDIRECT_URI),Yi=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Rt=()=>/micromessenger/i.test(navigator.userAgent),Gi=(e=null)=>{const t=e||Math.random().toString(36).substring(7);console.log("🔗 Generating WeChat OAuth URL");const n=Ln();console.log("🔍 Using redirect URI:",n);const r=new URLSearchParams({appid:De.APP_ID,redirect_uri:n,response_type:"code",scope:De.SCOPE,state:t}),s=`${Rt()?De.MOBILE_AUTHORIZE_URL:De.QR_AUTHORIZE_URL}?${r.toString()}#wechat_redirect`;return console.log("🔗 Final WeChat OAuth URL:",s),console.log("📋 OAuth parameters:",Object.fromEntries(r)),console.log("🌐 Browser type:",Rt()?"WeChat Browser":"External Browser"),s},Ki=(e=null)=>{const t=e||Math.random().toString(36).substring(7);console.log("🔗 Generating WeChat OAuth URL");const n=Ln();console.log("🔍 Using redirect URI:",n);const r=new URLSearchParams({appid:De.APP_ID,redirect_uri:n,response_type:"code",scope:De.SCOPE,state:t}),s=`${Rt()?De.MOBILE_AUTHORIZE_URL:De.QR_AUTHORIZE_URL}?${r.toString()}#wechat_redirect`;return console.log("🔗 Final WeChat OAuth URL:",s),console.log("📋 OAuth parameters:",Object.fromEntries(r)),console.log("🌐 Browser type:",Rt()?"WeChat Browser":"External Browser"),s},Hi={getAccessToken:async e=>{const t=new URLSearchParams({appid:De.APP_ID,secret:De.APP_SECRET,code:e,grant_type:"authorization_code"});return await(await fetch(`${De.ACCESS_TOKEN_URL}?${t.toString()}`)).json()},getUserInfo:async(e,t)=>{const n=new URLSearchParams({access_token:e,openid:t,lang:"en"});return await(await fetch(`${De.USER_INFO_URL}?${n.toString()}`)).json()}},ur=Re("auth/authenticateWithWeChat",async(e,{rejectWithValue:t})=>{try{console.log("Starting WeChat authentication with code:",e);const n=await Hi.getAccessToken(e);if(console.log("WeChat token response:",n),n.errcode)throw new Error(n.errmsg||"Failed to get WeChat access token");const{access_token:r,openid:a}=n,s=await Hi.getUserInfo(r,a);if(console.log("WeChat user response:",s),s.errcode)throw new Error(s.errmsg||"Failed to get WeChat user info");const o={id:`wechat_${a}`,openid:a,name:s.nickname,displayName:s.nickname,avatar:s.headimgurl,country:s.country,province:s.province,city:s.city,sex:s.sex,language:s.language,isAuthenticated:!0,authMethod:"wechat",wechatOpenId:a,accessToken:r,createdAt:new Date().toISOString()};return console.log("✅ WeChat authentication successful:",o),o}catch(n){return console.error("❌ WeChat authentication failed:",n),t(n.message||"WeChat authentication failed")}}),bs=Re("auth/logout",async(e,{rejectWithValue:t})=>{try{return console.log("User logged out"),sessionStorage.removeItem("wechat_access_token"),sessionStorage.removeItem("wechat_pending_cart_action"),{clearData:!0}}catch(n){return t(n.message)}}),ws=Et({name:"auth",initialState:{user:null,isAuthenticated:!1,loading:!1,error:null,wechatAuthUrl:null},reducers:{logout:e=>{e.user=null,e.isAuthenticated=!1,e.loading=!1,e.error=null,localStorage.removeItem("authToken"),localStorage.removeItem("userData")},clearError:e=>{e.error=null},updateUserProfile:(e,t)=>{e.user&&(e.user={...e.user,...t.payload})},setWeChatAuthUrl:(e,t)=>{e.wechatAuthUrl=t.payload},setWeChatUser:(e,t)=>{e.user=t.payload,e.isAuthenticated=!0,e.loading=!1,e.error=null},clearAllData:e=>{e.user=null,e.isAuthenticated=!1,e.loading=!1,e.error=null,e.wechatAuthUrl=null}},extraReducers:e=>{e.addCase(ur.pending,t=>{t.loading=!0,t.error=null}).addCase(ur.fulfilled,(t,n)=>{t.loading=!1,t.user=n.payload,t.isAuthenticated=!0,t.error=null}).addCase(ur.rejected,(t,n)=>{t.loading=!1,t.error=n.payload,t.isAuthenticated=!1,t.user=null}).addCase(bs.fulfilled,t=>{t.user=null,t.isAuthenticated=!1,t.loading=!1,t.error=null,t.wechatAuthUrl=null}).addCase(ri,t=>{t.user=null,t.isAuthenticated=!1,t.loading=!1,t.error=null,t.wechatAuthUrl=null})}}),{clearError:Qh,updateUserProfile:Vh,setWeChatAuthUrl:Zh,clearAllData:$d,logout:Jh,setWeChatUser:rn}=ws.actions,Md=ws.reducer;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="firebasestorage.googleapis.com",js="storageBucket",Ud=120*1e3,zd=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe extends Qr{constructor(t,n,r=0){super(pr(t),`Firebase Storage: ${n} (${pr(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xe.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return pr(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ve;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ve||(ve={}));function pr(e){return"storage/"+e}function ai(){const e="An unknown error occurred, please check the error payload for server response.";return new xe(ve.UNKNOWN,e)}function qd(e){return new xe(ve.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function Bd(e){return new xe(ve.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Wd(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xe(ve.UNAUTHENTICATED,e)}function Yd(){return new xe(ve.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Gd(e){return new xe(ve.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function Kd(){return new xe(ve.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Hd(){return new xe(ve.CANCELED,"User canceled the upload/download.")}function Qd(e){return new xe(ve.INVALID_URL,"Invalid URL '"+e+"'.")}function Vd(e){return new xe(ve.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function Zd(){return new xe(ve.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+js+"' property when initializing the app?")}function Jd(){return new xe(ve.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Xd(){return new xe(ve.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function eu(e){return new xe(ve.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function $r(e){return new xe(ve.INVALID_ARGUMENT,e)}function Rs(){return new xe(ve.APP_DELETED,"The Firebase app was deleted.")}function tu(e){return new xe(ve.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $t(e,t){return new xe(ve.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Ot(e){throw new xe(ve.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let r;try{r=Te.makeFromUrl(t,n)}catch(a){return new Te(t,"")}if(r.path==="")return r;throw Vd(t)}static makeFromUrl(t,n){let r=null;const a="([A-Za-z0-9.\\-_]+)";function s(v){v.path.charAt(v.path.length-1)==="/"&&(v.path_=v.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+a+o,"i"),c={bucket:1,path:3};function d(v){v.path_=decodeURIComponent(v.path)}const u="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",p=new RegExp(`^https?://${m}/${u}/b/${a}/o${g}`,"i"),y={bucket:1,path:3},b=n===ks?"(?:storage.googleapis.com|storage.cloud.google.com)":n,f="([^?#]*)",k=new RegExp(`^https?://${b}/${a}/${f}`,"i"),C=[{regex:l,indices:c,postModify:s},{regex:p,indices:y,postModify:d},{regex:k,indices:{bucket:1,path:2},postModify:d}];for(let v=0;v<C.length;v++){const x=C[v],S=x.regex.exec(t);if(S){const _=S[x.indices.bucket];let j=S[x.indices.path];j||(j=""),r=new Te(_,j),x.postModify(r);break}}if(r==null)throw Qd(t);return r}}class nu{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(e,t,n){let r=1,a=null,s=null,o=!1,l=0;function c(){return l===2}let d=!1;function u(...f){d||(d=!0,t.apply(null,f))}function m(f){a=setTimeout(()=>{a=null,e(p,c())},f)}function g(){s&&clearTimeout(s)}function p(f,...k){if(d){g();return}if(f){g(),u.call(null,f,...k);return}if(c()||o){g(),u.call(null,f,...k);return}r<64&&(r*=2);let C;l===1?(l=2,C=0):C=(r+Math.random())*1e3,m(C)}let y=!1;function b(f){y||(y=!0,g(),!d&&(a!==null?(f||(l=2),clearTimeout(a),m(0)):f||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,b(!0)},n),b}function iu(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(e){return e!==void 0}function su(e){return typeof e=="object"&&!Array.isArray(e)}function si(e){return typeof e=="string"||e instanceof String}function Qi(e){return oi()&&e instanceof Blob}function oi(){return typeof Blob!="undefined"}function Vi(e,t,n,r){if(r<t)throw $r(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw $r(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(e,t,n){let r=t;return n==null&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function Cs(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){const a=t(r)+"="+t(e[r]);n=n+a+"&"}return n=n.slice(0,-1),n}var dt;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(dt||(dt={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(e,t){const n=e>=500&&e<600,a=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return n||a||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(t,n,r,a,s,o,l,c,d,u,m,g=!0){this.url_=t,this.method_=n,this.headers_=r,this.body_=a,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=u,this.connectionFactory_=m,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,y)=>{this.resolve_=p,this.reject_=y,this.start_()})}start_(){const t=(r,a)=>{if(a){r(!1,new an(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===dt.NO_ERROR,c=s.getStatus();if(!l||ou(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===dt.ABORT;r(!1,new an(!1,null,u));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new an(d,s))})},n=(r,a)=>{const s=this.resolve_,o=this.reject_,l=a.connection;if(a.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());au(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=ai();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(a.canceled){const c=this.appDelete_?Rs():Hd();o(c)}else{const c=Kd();o(c)}};this.canceled_?n(!1,new an(!1,null,!0)):this.backoffId_=ru(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&iu(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class an{constructor(t,n,r){this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}}function cu(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function du(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t!=null?t:"AppManager")}function uu(e,t){t&&(e["X-Firebase-GMPID"]=t)}function pu(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function mu(e,t,n,r,a,s,o=!0){const l=Cs(e.urlParams),c=e.url+l,d=Object.assign({},e.headers);return uu(d,t),cu(d,n),du(d,s),pu(d,r),new lu(c,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function hu(...e){const t=fu();if(t!==void 0){const n=new t;for(let r=0;r<e.length;r++)n.append(e[r]);return n.getBlob()}else{if(oi())return new Blob(e);throw new xe(ve.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gu(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(e){if(typeof atob=="undefined")throw eu("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ye={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class mr{constructor(t,n){this.data=t,this.contentType=n||null}}function xu(e,t){switch(e){case Ye.RAW:return new mr(Ss(t));case Ye.BASE64:case Ye.BASE64URL:return new mr(Ds(e,t));case Ye.DATA_URL:return new mr(bu(t),wu(t))}throw ai()}function Ss(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const s=r,o=e.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function yu(e){let t;try{t=decodeURIComponent(e)}catch(n){throw $t(Ye.DATA_URL,"Malformed data URL.")}return Ss(t)}function Ds(e,t){switch(e){case Ye.BASE64:{const a=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(a||s)throw $t(e,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Ye.BASE64URL:{const a=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(a||s)throw $t(e,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=vu(t)}catch(a){throw a.message.includes("polyfill")?a:$t(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}class Es{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw $t(Ye.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=ku(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function bu(e){const t=new Es(e);return t.base64?Ds(Ye.BASE64,t.rest):yu(t.rest)}function wu(e){return new Es(e).contentType}function ku(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(t,n){let r=0,a="";Qi(t)?(this.data_=t,r=t.size,a=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=a}size(){return this.size_}type(){return this.type_}slice(t,n){if(Qi(this.data_)){const r=this.data_,a=gu(r,t,n);return a===null?null:new nt(a)}else{const r=new Uint8Array(this.data_.buffer,t,n-t);return new nt(r,!0)}}static getBlob(...t){if(oi()){const n=t.map(r=>r instanceof nt?r.data_:r);return new nt(hu.apply(null,n))}else{const n=t.map(o=>si(o)?xu(Ye.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const a=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)a[s++]=o[l]}),new nt(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(e){let t;try{t=JSON.parse(e)}catch(n){return null}return su(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function Ru(e,t){const n=t.split("/").filter(r=>r.length>0).join("/");return e.length===0?n:e+"/"+n}function Ls(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(e,t){return t}class Le{constructor(t,n,r,a){this.server=t,this.local=n||t,this.writable=!!r,this.xform=a||Cu}}let sn=null;function Su(e){return!si(e)||e.length<2?e:Ls(e)}function _s(){if(sn)return sn;const e=[];e.push(new Le("bucket")),e.push(new Le("generation")),e.push(new Le("metageneration")),e.push(new Le("name","fullPath",!0));function t(s,o){return Su(o)}const n=new Le("name");n.xform=t,e.push(n);function r(s,o){return o!==void 0?Number(o):o}const a=new Le("size");return a.xform=r,e.push(a),e.push(new Le("timeCreated")),e.push(new Le("updated")),e.push(new Le("md5Hash",null,!0)),e.push(new Le("cacheControl",null,!0)),e.push(new Le("contentDisposition",null,!0)),e.push(new Le("contentEncoding",null,!0)),e.push(new Le("contentLanguage",null,!0)),e.push(new Le("contentType",null,!0)),e.push(new Le("metadata","customMetadata",!0)),sn=e,sn}function Du(e,t){function n(){const r=e.bucket,a=e.fullPath,s=new Te(r,a);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:n})}function Eu(e,t,n){const r={};r.type="file";const a=n.length;for(let s=0;s<a;s++){const o=n[s];r[o.local]=o.xform(r,t[o.server])}return Du(r,e),r}function Os(e,t,n){const r=As(t);return r===null?null:Eu(e,r,n)}function Au(e,t,n,r){const a=As(t);if(a===null||!si(a.downloadTokens))return null;const s=a.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const u=e.bucket,m=e.fullPath,g="/b/"+o(u)+"/o/"+o(m),p=li(g,n,r),y=Cs({alt:"media",token:d});return p+y})[0]}function Lu(e,t){const n={},r=t.length;for(let a=0;a<r;a++){const s=t[a];s.writable&&(n[s.server]=e[s.local])}return JSON.stringify(n)}class Is{constructor(t,n,r,a){this.url=t,this.method=n,this.handler=r,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(e){if(!e)throw ai()}function _u(e,t){function n(r,a){const s=Os(e,a,t);return Ts(s!==null),s}return n}function Ou(e,t){function n(r,a){const s=Os(e,a,t);return Ts(s!==null),Au(s,a,e.host,e._protocol)}return n}function Ps(e){function t(n,r){let a;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?a=Yd():a=Wd():n.getStatus()===402?a=Bd(e.bucket):n.getStatus()===403?a=Gd(e.path):a=r,a.status=n.getStatus(),a.serverResponse=r.serverResponse,a}return t}function Iu(e){const t=Ps(e);function n(r,a){let s=t(r,a);return r.getStatus()===404&&(s=qd(e.path)),s.serverResponse=a.serverResponse,s}return n}function Tu(e,t,n){const r=t.fullServerUrl(),a=li(r,e.host,e._protocol),s="GET",o=e.maxOperationRetryTime,l=new Is(a,s,Ou(e,n),o);return l.errorHandler=Iu(t),l}function Pu(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Nu(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=Pu(null,t)),r}function Fu(e,t,n,r,a){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let C="";for(let v=0;v<2;v++)C=C+Math.random().toString().slice(2);return C}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const d=Nu(t,r,a),u=Lu(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,g=`\r
--`+c+"--",p=nt.getBlob(m,r,g);if(p===null)throw Jd();const y={name:d.fullPath},b=li(s,e.host,e._protocol),f="POST",k=e.maxUploadRetryTime,A=new Is(b,f,_u(e,n),k);return A.urlParams=y,A.headers=o,A.body=p.uploadData(),A.errorHandler=Ps(t),A}class $u{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=dt.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=dt.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=dt.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,r,a){if(this.sent_)throw Ot("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),a!==void 0)for(const s in a)a.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,a[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ot("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ot("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}}getResponse(){if(!this.sent_)throw Ot("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ot("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class Mu extends $u{initXhr(){this.xhr_.responseType="text"}}function Ns(){return new Mu}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(t,n){this._service=t,n instanceof Te?this._location=n:this._location=Te.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new mt(t,n)}get root(){const t=new Te(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ls(this._location.path)}get storage(){return this._service}get parent(){const t=ju(this._location.path);if(t===null)return null;const n=new Te(this._location.bucket,t);return new mt(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw tu(t)}}function Uu(e,t,n){e._throwIfRoot("uploadBytes");const r=Fu(e.storage,e._location,_s(),new nt(t,!0),n);return e.storage.makeRequestWithTokens(r,Ns).then(a=>({metadata:a,ref:e}))}function zu(e){e._throwIfRoot("getDownloadURL");const t=Tu(e.storage,e._location,_s());return e.storage.makeRequestWithTokens(t,Ns).then(n=>{if(n===null)throw Xd();return n})}function qu(e,t){const n=Ru(e._location.path,t),r=new Te(e._location.bucket,n);return new mt(e.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(e){return/^[A-Za-z]+:\/\//.test(e)}function Wu(e,t){return new mt(e,t)}function Fs(e,t){if(e instanceof ci){const n=e;if(n._bucket==null)throw Zd();const r=new mt(n,n._bucket);return t!=null?Fs(r,t):r}else return t!==void 0?qu(e,t):e}function Yu(e,t){if(t&&Bu(t)){if(e instanceof ci)return Wu(e,t);throw $r("To use ref(service, url), the first argument must be a Storage instance.")}else return Fs(e,t)}function Zi(e,t){const n=t==null?void 0:t[js];return n==null?null:Te.makeFromBucketSpec(n,e)}function Gu(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:a}=r;a&&(e._overrideAuthToken=typeof a=="string"?a:Vo(a,e.app.options.projectId))}class ci{constructor(t,n,r,a,s){this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=a,this._firebaseVersion=s,this._bucket=null,this._host=ks,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ud,this._maxUploadRetryTime=zd,this._requests=new Set,a!=null?this._bucket=Te.makeFromBucketSpec(a,this._host):this._bucket=Zi(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Te.makeFromBucketSpec(this._url,t):this._bucket=Zi(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Vi("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Vi("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new mt(this,t)}_makeRequest(t,n,r,a,s=!0){if(this._deleted)return new nu(Rs());{const o=mu(t,this._appId,r,a,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,r,a).getPromise()}}const Ji="@firebase/storage",Xi="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="storage";function Ku(e,t,n){return e=Dt(e),Uu(e,t,n)}function Hu(e){return e=Dt(e),zu(e)}function Qu(e,t){return e=Dt(e),Yu(e,t)}function Vu(e=Ma(),t){e=Dt(e);const r=Ht(e,$s).getImmediate({identifier:t}),a=Qo("storage");return a&&Zu(r,...a),r}function Zu(e,t,n,r={}){Gu(e,t,n,r)}function Ju(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new ci(n,r,a,t,Ho)}function Xu(){zt(new qt($s,Ju,"PUBLIC").setMultipleInstances(!0)),kt(Ji,Xi,""),kt(Ji,Xi,"esm2017")}Xu();const Ms="@firebase/installations",di="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=1e4,zs=`w:${di}`,qs="FIS_v2",ep="https://firebaseinstallations.googleapis.com/v1",tp=3600*1e3,np="installations",rp="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ft=new Ua(np,rp,ip);function Bs(e){return e instanceof Qr&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws({projectId:e}){return`${ep}/projects/${e}/installations`}function Ys(e){return{token:e.token,requestStatus:2,expiresIn:sp(e.expiresIn),creationTime:Date.now()}}async function Gs(e,t){const r=(await t.json()).error;return ft.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Ks({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function ap(e,{refreshToken:t}){const n=Ks(e);return n.append("Authorization",op(t)),n}async function Hs(e){const t=await e();return t.status>=500&&t.status<600?e():t}function sp(e){return Number(e.replace("s","000"))}function op(e){return`${qs} ${e}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lp({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=Ws(e),a=Ks(e),s=t.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&a.append("x-firebase-client",d)}const o={fid:n,authVersion:qs,appId:e.appId,sdkVersion:zs},l={method:"POST",headers:a,body:JSON.stringify(o)},c=await Hs(()=>fetch(r,l));if(c.ok){const d=await c.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:Ys(d.authToken)}}else throw await Gs("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp=/^[cdef][\w-]{21}$/,Mr="";function up(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const n=pp(e);return dp.test(n)?n:Mr}catch(e){return Mr}}function pp(e){return cp(e).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=new Map;function Zs(e,t){const n=Yn(e);Js(n,t),mp(n,t)}function Js(e,t){const n=Vs.get(e);if(n)for(const r of n)r(t)}function mp(e,t){const n=fp();n&&n.postMessage({key:e,fid:t}),hp()}let ct=null;function fp(){return!ct&&"BroadcastChannel"in self&&(ct=new BroadcastChannel("[Firebase] FID Change"),ct.onmessage=e=>{Js(e.data.key,e.data.fid)}),ct}function hp(){Vs.size===0&&ct&&(ct.close(),ct=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="firebase-installations-database",vp=1,ht="firebase-installations-store";let fr=null;function ui(){return fr||(fr=Zo(gp,vp,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(ht)}}})),fr}async function _n(e,t){const n=Yn(e),a=(await ui()).transaction(ht,"readwrite"),s=a.objectStore(ht),o=await s.get(n);return await s.put(t,n),await a.done,(!o||o.fid!==t.fid)&&Zs(e,t.fid),t}async function Xs(e){const t=Yn(e),r=(await ui()).transaction(ht,"readwrite");await r.objectStore(ht).delete(t),await r.done}async function Gn(e,t){const n=Yn(e),a=(await ui()).transaction(ht,"readwrite"),s=a.objectStore(ht),o=await s.get(n),l=t(o);return l===void 0?await s.delete(n):await s.put(l,n),await a.done,l&&(!o||o.fid!==l.fid)&&Zs(e,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pi(e){let t;const n=await Gn(e.appConfig,r=>{const a=xp(r),s=yp(e,a);return t=s.registrationPromise,s.installationEntry});return n.fid===Mr?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function xp(e){const t=e||{fid:up(),registrationStatus:0};return eo(t)}function yp(e,t){if(t.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(ft.create("app-offline"));return{installationEntry:t,registrationPromise:a}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=bp(e,n);return{installationEntry:n,registrationPromise:r}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:wp(e)}:{installationEntry:t}}async function bp(e,t){try{const n=await lp(e,t);return _n(e.appConfig,n)}catch(n){throw Bs(n)&&n.customData.serverCode===409?await Xs(e.appConfig):await _n(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function wp(e){let t=await ea(e.appConfig);for(;t.registrationStatus===1;)await Qs(100),t=await ea(e.appConfig);if(t.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await pi(e);return r||n}return t}function ea(e){return Gn(e,t=>{if(!t)throw ft.create("installation-not-found");return eo(t)})}function eo(e){return kp(e)?{fid:e.fid,registrationStatus:0}:e}function kp(e){return e.registrationStatus===1&&e.registrationTime+Us<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jp({appConfig:e,heartbeatServiceProvider:t},n){const r=Rp(e,n),a=ap(e,n),s=t.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&a.append("x-firebase-client",d)}const o={installation:{sdkVersion:zs,appId:e.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},c=await Hs(()=>fetch(r,l));if(c.ok){const d=await c.json();return Ys(d)}else throw await Gs("Generate Auth Token",c)}function Rp(e,{fid:t}){return`${Ws(e)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mi(e,t=!1){let n;const r=await Gn(e.appConfig,s=>{if(!to(s))throw ft.create("not-registered");const o=s.authToken;if(!t&&Dp(o))return s;if(o.requestStatus===1)return n=Cp(e,t),s;{if(!navigator.onLine)throw ft.create("app-offline");const l=Ap(s);return n=Sp(e,l),l}});return n?await n:r.authToken}async function Cp(e,t){let n=await ta(e.appConfig);for(;n.authToken.requestStatus===1;)await Qs(100),n=await ta(e.appConfig);const r=n.authToken;return r.requestStatus===0?mi(e,t):r}function ta(e){return Gn(e,t=>{if(!to(t))throw ft.create("not-registered");const n=t.authToken;return Lp(n)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function Sp(e,t){try{const n=await jp(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await _n(e.appConfig,r),n}catch(n){if(Bs(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Xs(e.appConfig);else{const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await _n(e.appConfig,r)}throw n}}function to(e){return e!==void 0&&e.registrationStatus===2}function Dp(e){return e.requestStatus===2&&!Ep(e)}function Ep(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+tp}function Ap(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function Lp(e){return e.requestStatus===1&&e.requestTime+Us<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _p(e){const t=e,{installationEntry:n,registrationPromise:r}=await pi(t);return r?r.catch(console.error):mi(t).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Op(e,t=!1){const n=e;return await Ip(n),(await mi(n,t)).token}async function Ip(e){const{registrationPromise:t}=await pi(e);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(e){if(!e||!e.options)throw hr("App Configuration");if(!e.name)throw hr("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw hr(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function hr(e){return ft.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no="installations",Pp="installations-internal",Np=e=>{const t=e.getProvider("app").getImmediate(),n=Tp(t),r=Ht(t,"heartbeat");return{app:t,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Fp=e=>{const t=e.getProvider("app").getImmediate(),n=Ht(t,no).getImmediate();return{getId:()=>_p(n),getToken:a=>Op(n,a)}};function $p(){zt(new qt(no,Np,"PUBLIC")),zt(new qt(Pp,Fp,"PRIVATE"))}$p();kt(Ms,di);kt(Ms,di,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On="analytics",Mp="firebase_id",Up="origin",zp=60*1e3,qp="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",fi="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie=new Jo("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Pe=new Ua("analytics","Analytics",Bp);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(e){if(!e.startsWith(fi)){const t=Pe.create("invalid-gtag-resource",{gtagURL:e});return Ie.warn(t.message),""}return e}function ro(e){return Promise.all(e.map(t=>t.catch(n=>n)))}function Yp(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function Gp(e,t){const n=Yp("firebase-js-sdk-policy",{createScriptURL:Wp}),r=document.createElement("script"),a=`${fi}?l=${e}&id=${t}`;r.src=n?n==null?void 0:n.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function Kp(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function Hp(e,t,n,r,a,s){const o=r[a];try{if(o)await t[o];else{const c=(await ro(n)).find(d=>d.measurementId===a);c&&await t[c.appId]}}catch(l){Ie.error(l)}e("config",a,s)}async function Qp(e,t,n,r,a){try{let s=[];if(a&&a.send_to){let o=a.send_to;Array.isArray(o)||(o=[o]);const l=await ro(n);for(const c of o){const d=l.find(m=>m.measurementId===c),u=d&&t[d.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(t)),await Promise.all(s),e("event",r,a||{})}catch(s){Ie.error(s)}}function Vp(e,t,n,r){async function a(s,...o){try{if(s==="event"){const[l,c]=o;await Qp(e,t,n,l,c)}else if(s==="config"){const[l,c]=o;await Hp(e,t,n,r,l,c)}else if(s==="consent"){const[l,c]=o;e("consent",l,c)}else if(s==="get"){const[l,c,d]=o;e("get",l,c,d)}else if(s==="set"){const[l]=o;e("set",l)}else e(s,...o)}catch(l){Ie.error(l)}}return a}function Zp(e,t,n,r,a){let s=function(...o){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(s=window[a]),window[a]=Vp(s,e,t,n),{gtagCore:s,wrappedGtag:window[a]}}function Jp(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(fi)&&n.src.includes(e))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=30,em=1e3;class tm{constructor(t={},n=em){this.throttleMetadata=t,this.intervalMillis=n}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,n){this.throttleMetadata[t]=n}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const io=new tm;function nm(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function rm(e){var t;const{appId:n,apiKey:r}=e,a={method:"GET",headers:nm(r)},s=qp.replace("{app-id}",n),o=await fetch(s,a);if(o.status!==200&&o.status!==304){let l="";try{const c=await o.json();!((t=c.error)===null||t===void 0)&&t.message&&(l=c.error.message)}catch(c){}throw Pe.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function im(e,t=io,n){const{appId:r,apiKey:a,measurementId:s}=e.options;if(!r)throw Pe.create("no-app-id");if(!a){if(s)return{measurementId:s,appId:r};throw Pe.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new om;return setTimeout(async()=>{l.abort()},zp),ao({appId:r,apiKey:a,measurementId:s},o,l,t)}async function ao(e,{throttleEndTimeMillis:t,backoffCount:n},r,a=io){var s;const{appId:o,measurementId:l}=e;try{await am(r,t)}catch(c){if(l)return Ie.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const c=await rm(e);return a.deleteThrottleMetadata(o),c}catch(c){const d=c;if(!sm(d)){if(a.deleteThrottleMetadata(o),l)return Ie.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:o,measurementId:l};throw c}const u=Number((s=d==null?void 0:d.customData)===null||s===void 0?void 0:s.httpStatus)===503?yi(n,a.intervalMillis,Xp):yi(n,a.intervalMillis),m={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return a.setThrottleMetadata(o,m),Ie.debug(`Calling attemptFetch again in ${u} millis`),ao(e,m,r,a)}}function am(e,t){return new Promise((n,r)=>{const a=Math.max(t-Date.now(),0),s=setTimeout(n,a);e.addEventListener(()=>{clearTimeout(s),r(Pe.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function sm(e){if(!(e instanceof Qr)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}class om{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function lm(e,t,n,r,a){if(a&&a.global){e("event",n,r);return}else{const s=await t,o=Object.assign(Object.assign({},r),{send_to:s});e("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cm(){if(qa())try{await Ba()}catch(e){return Ie.warn(Pe.create("indexeddb-unavailable",{errorInfo:e==null?void 0:e.toString()}).message),!1}else return Ie.warn(Pe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function dm(e,t,n,r,a,s,o){var l;const c=im(e);c.then(p=>{n[p.measurementId]=p.appId,e.options.measurementId&&p.measurementId!==e.options.measurementId&&Ie.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>Ie.error(p)),t.push(c);const d=cm().then(p=>{if(p)return r.getId()}),[u,m]=await Promise.all([c,d]);Jp(s)||Gp(s,u.measurementId),a("js",new Date);const g=(l=o==null?void 0:o.config)!==null&&l!==void 0?l:{};return g[Up]="firebase",g.update=!0,m!=null&&(g[Mp]=m),a("config",u.measurementId,g),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(t){this.app=t}_delete(){return delete Mt[this.app.options.appId],Promise.resolve()}}let Mt={},na=[];const ra={};let gr="dataLayer",pm="gtag",ia,so,aa=!1;function mm(){const e=[];if(za()&&e.push("This is a browser extension environment."),Wa()||e.push("Cookies are not available."),e.length>0){const t=e.map((r,a)=>`(${a+1}) ${r}`).join(" "),n=Pe.create("invalid-analytics-context",{errorInfo:t});Ie.warn(n.message)}}function fm(e,t,n){mm();const r=e.options.appId;if(!r)throw Pe.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)Ie.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Pe.create("no-api-key");if(Mt[r]!=null)throw Pe.create("already-exists",{id:r});if(!aa){Kp(gr);const{wrappedGtag:s,gtagCore:o}=Zp(Mt,na,ra,gr,pm);so=s,ia=o,aa=!0}return Mt[r]=dm(e,na,ra,t,ia,gr,n),new um(e)}function hm(e=Ma()){e=Dt(e);const t=Ht(e,On);return t.isInitialized()?t.getImmediate():gm(e)}function gm(e,t={}){const n=Ht(e,On);if(n.isInitialized()){const a=n.getImmediate();if(Xo(t,n.getOptions()))return a;throw Pe.create("already-initialized")}return n.initialize({options:t})}async function vm(){if(za()||!Wa()||!qa())return!1;try{return await Ba()}catch(e){return!1}}function xm(e,t,n,r){e=Dt(e),lm(so,Mt[e.app.options.appId],t,n,r).catch(a=>Ie.error(a))}const sa="@firebase/analytics",oa="0.10.8";function ym(){zt(new qt(On,(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),a=t.getProvider("installations-internal").getImmediate();return fm(r,a,n)},"PUBLIC")),zt(new qt("analytics-internal",e,"PRIVATE")),kt(sa,oa),kt(sa,oa,"esm2017");function e(t){try{const n=t.getProvider(On).getImmediate();return{logEvent:(r,a,s)=>xm(n,r,a,s)}}catch(n){throw Pe.create("interop-component-reg-failed",{reason:n})}}}ym();const Ur={apiKey:"AIzaSyD1TjtSC-Mukd2EdNtiuQq-u3l3gdMP0dc",authDomain:"homefoods-16e56.firebaseapp.com",projectId:"homefoods-16e56",storageBucket:"homefoods-16e56.firebasestorage.app",messagingSenderId:"495709118320",appId:"1:495709118320:web:6fe3b7ec2b7c19d66cf9b5",measurementId:"G-6MR0ED1C3E"},bm=["apiKey","authDomain","projectId","appId"],_e=bm.some(e=>!Ur[e]);let ot,Pt,le,oo,la;_e?Promise.resolve(null):(ot=bi().length?bi()[0]:el(Ur),Pt=Ya(ot),le=tl(ot),oo=Vu(ot),Ur.measurementId?vm().then(e=>e?(la=hm(ot),la):null):Promise.resolve(null));async function wm(e,t=null,n=20){if(console.log(`[getFoodReviews] Starting fetch for foodId: "${e}", kitchenId: "${t}", limit: ${n}`),_e)return console.warn("[getFoodReviews] Firebase disabled, returning mock data"),[];if(!e||e.trim()==="")return console.log("[getFoodReviews] No foodId provided, returning empty array"),[];const r=e.trim();console.log(`[getFoodReviews] Cleaned foodId: "${r}"`);try{let a=[];if(t){console.log(`[getFoodReviews] Searching reviews in kitchen: ${t}`);const s=ge(le,"kitchens",t,"reviews"),o=ke(s,Me("foodId","==",r),Qe(n));a=(await be(o)).docs.map(c=>({id:c.id,kitchenId:t,...c.data()})),console.log(`[getFoodReviews] Found ${a.length} reviews in kitchen ${t}`)}else{console.log("[getFoodReviews] Searching reviews across all kitchens...");const s=ke(ge(le,"kitchens")),o=await be(s);console.log(`[getFoodReviews] Found ${o.size} kitchens to search`);for(const l of o.docs)try{const c=ge(le,"kitchens",l.id,"reviews"),d=ke(c,Me("foodId","==",r),Qe(n)),m=(await be(d)).docs.map(g=>({id:g.id,kitchenId:l.id,...g.data()}));if(a.push(...m),console.log(`[getFoodReviews] Found ${m.length} reviews in kitchen ${l.id}`),a.length>=n)break}catch(c){console.warn(`[getFoodReviews] Error searching kitchen ${l.id}:`,c);continue}}return a.length>0&&(a=a.sort((s,o)=>{const l=u=>u?typeof u=="string"?u.includes(" at ")?new Date(u.replace(" at "," ").replace(" UTC+5","")):new Date(u):u.seconds?new Date(u.seconds*1e3):new Date(u):new Date(0),c=l(s.timeStamp);return l(o.timeStamp)-c}),a=a.slice(0,n)),console.log(`[getFoodReviews] Final result - Found ${a.length} reviews for food '${r}':`,a),a}catch(a){return console.error("[getFoodReviews] Error fetching food reviews:",a),console.log("[getFoodReviews] Returning mock data due to error"),[]}}async function km(e,t=null){if(console.log(`[debugReviewsQuery] Testing query for foodId: ${e}, kitchenId: ${t}`),_e)return console.warn("[debugReviewsQuery] Firebase disabled"),{status:"disabled"};try{let n=[],r=[];const a=ke(ge(le,"kitchens")),s=await be(a);console.log(`[debugReviewsQuery] Found ${s.size} kitchens`);for(const l of s.docs)try{r.push(l.id);const c=ge(le,"kitchens",l.id,"reviews"),u=(await be(ke(c,Qe(50)))).docs.map(m=>({id:m.id,kitchenId:l.id,...m.data()}));if(console.log(`[debugReviewsQuery] Kitchen ${l.id} has ${u.length} total reviews`),u.length>0&&console.log(`[debugReviewsQuery] Sample reviews from kitchen ${l.id}:`,u.slice(0,2)),e){const m=ke(c,Me("foodId","==",e)),p=(await be(m)).docs.map(y=>({id:y.id,kitchenId:l.id,...y.data()}));p.length>0&&(console.log(`[debugReviewsQuery] Found ${p.length} reviews for foodId '${e}' in kitchen ${l.id}:`,p),n.push(...p))}n.push(...u)}catch(c){console.warn(`[debugReviewsQuery] Error checking kitchen ${l.id}:`,c);continue}const o=[...new Set(n.map(l=>l.foodId))];return console.log("[debugReviewsQuery] All unique foodIds in reviews:",o),{status:"success",requestedFoodId:e,kitchensSearched:r,allReviewsCount:n.length,matchingReviewsCount:n.filter(l=>l.foodId===e).length,uniqueFoodIds:o,sampleReviews:n.slice(0,5)}}catch(n){return console.error("[debugReviewsQuery] Error:",n),{status:"error",error:n.message}}}async function jm(e,t=null){if(console.log(`[getFoodLikes] Starting fetch for foodId: ${e}, kitchenId: ${t}`),_e)return console.warn("[getFoodLikes] Firebase disabled, returning mock data"),[];if(!e||e.trim()==="")return console.log("[getFoodLikes] No foodId provided, returning empty array"),[];try{let n=[];if(t)try{console.log(`[getFoodLikes] Searching likes in kitchen ${t} subcollection`);const l=ge(le,"kitchens",t,"Likes");let c=ke(l,Me("foodId","==",e)),d=await be(c),u=d.docs.map(m=>({id:m.id,kitchenId:t,...m.data()}));u.length===0&&(c=ke(l,Me("productId","==",e)),d=await be(c),u=d.docs.map(m=>({id:m.id,kitchenId:t,...m.data()}))),n.push(...u),console.log(`[getFoodLikes] Found ${u.length} likes in kitchen subcollection`)}catch(l){console.warn("[getFoodLikes] Error searching kitchen subcollection:",l)}console.log("[getFoodLikes] Querying top-level Likes collection");let r=ke(ge(le,"Likes"),Me("foodId","==",e)),a=await be(r),s=a.docs.map(l=>({id:l.id,...l.data()}));s.length===0&&(console.log("[getFoodLikes] No results with foodId, trying productId in top-level..."),r=ke(ge(le,"Likes"),Me("productId","==",e)),a=await be(r),s=a.docs.map(l=>({id:l.id,...l.data()}))),n.push(...s),console.log(`[getFoodLikes] Found ${s.length} likes in top-level collection`);const o=n.filter((l,c,d)=>d.findIndex(u=>u.id===l.id)===c);return console.log(`[getFoodLikes] Total unique likes: ${o.length}`),o}catch(n){return console.error("[getFoodLikes] Error fetching food likes:",n),console.log("[getFoodLikes] Returning mock data due to error"),[]}}async function Rm(){if(_e)return console.log("Firebase is disabled - check your .env file"),{status:"disabled"};try{console.log("Testing Firestore connection...");const e=ge(le,"kitchens"),t=await be(ke(e,Qe(5))),n=t.docs.map(d=>({id:d.id,...d.data()}));let r=[],a=[];for(const d of n)try{const u=ge(le,"kitchens",d.id,"reviews"),g=(await be(ke(u,Qe(5)))).docs.map(f=>({id:f.id,kitchenId:d.id,...f.data()}));r.push(...g);const p=ge(le,"kitchens",d.id,"Likes"),b=(await be(ke(p,Qe(5)))).docs.map(f=>({id:f.id,kitchenId:d.id,...f.data()}));a.push(...b),console.log(`Kitchen ${d.id}: ${g.length} reviews, ${b.length} likes`)}catch(u){console.warn(`Error testing kitchen ${d.id} subcollections:`,u)}const s=ge(le,"Likes"),l=(await be(ke(s,Qe(10)))).docs.map(d=>({id:d.id,...d.data()}));console.log("Reviews found in kitchen subcollections:",r),console.log("Likes found in kitchen subcollections:",a),console.log("Likes found in top-level collection:",l);const c={status:"connected",collections:{kitchens:{count:t.size,samples:n,sampleIds:n.map(d=>d.id)},reviews:{source:"kitchen_subcollections",count:r.length,samples:r,sampleIds:r.map(d=>d.id),foodIds:r.map(d=>d.foodId)},likes:{subcollectionCount:a.length,topLevelCount:l.length,samples:[...a,...l],foodIds:[...a,...l].map(d=>d.foodId||d.productId)}}};return console.log("Firestore Test Results:",c),c}catch(e){return console.error("Firestore connection test failed:",e),{status:"error",error:e.message}}}async function Cm(e,t=null){console.log(`[getFoodDetailWithKitchenAndReviews] Fetching food: ${e}, kitchen: ${t}`);try{const n=await lo(e,t),r=t||n.kitchenId;console.log(`[getFoodDetailWithKitchenAndReviews] Using kitchenId: ${r}`);const[a,s,o]=await Promise.all([r?Sm(r):Promise.resolve(null),jm(e,r),wm(e,r)]),l=co(o);console.log("🚀 ~ getFoodDetailWithKitchenAndReviews ~ reviewStats:",l);const c={food:n,kitchen:a,likes:s,reviews:o,totalLikes:s.length,reviewStats:l};return console.log("[getFoodDetailWithKitchenAndReviews] Complete result:",c),c}catch(n){throw console.error("[getFoodDetailWithKitchenAndReviews] Error fetching food detail:",n),n}}async function lo(e,t=null){if(console.log(`[getFoodById] Starting fetch for foodId: ${e}, kitchenId: ${t}`),_e)return console.warn("[getFoodById] Firebase disabled, returning mock data"),null;if(!e||e.trim()==="")throw console.error("[getFoodById] Invalid foodId provided:",e),new Error("Food ID is required and cannot be empty");try{let n,r=null,a=null;if(t&&(console.log(`[getFoodById] Querying kitchens/${t}/foodItems/${e}`),n=await Ge($e(le,"kitchens",t,"foodItems",e)),n.exists()))return r={id:n.id,...n.data()},a=t,console.log("[getFoodById] Found in specific kitchen subcollection:",r),{...r,kitchenId:a};if(!r){console.log("[getFoodById] Searching across all kitchen subcollections...");const s=ke(ge(le,"kitchens")),o=await be(s);for(const l of o.docs)try{const c=$e(le,"kitchens",l.id,"foodItems",e),d=await Ge(c);if(d.exists())return r={id:d.id,...d.data()},a=l.id,console.log(`[getFoodById] Found in kitchen ${l.id}:`,r),{...r,kitchenId:a}}catch(c){console.warn(`[getFoodById] Error checking kitchen ${l.id}:`,c);continue}}if(console.log(`[getFoodById] Trying top-level foodItems/${e}`),n=await Ge($e(le,"foodItems",e)),n.exists()){const s={id:n.id,...n.data()};return console.log("[getFoodById] Found in top-level collection:",s),s}return console.warn(`[getFoodById] Food item with ID '${e}' not found anywhere`),null}catch(n){return console.error("[getFoodById] Error fetching food item:",n),null}}async function Sm(e){if(console.log(`[getKitchenById] Starting fetch for kitchenId: ${e}`),_e)return console.warn("[getKitchenById] Firebase disabled, returning mock data"),null;if(!e||e.trim()==="")throw console.error("[getKitchenById] Invalid kitchenId provided:",e),new Error("Kitchen ID is required and cannot be empty");try{console.log(`[getKitchenById] Querying Firestore collection 'kitchens' for document: ${e}`);const t=await Ge($e(le,"kitchens",e));if(console.log(`[getKitchenById] Document exists: ${t.exists()}`),!t.exists())return console.warn(`[getKitchenById] Kitchen with ID '${e}' not found in Firestore`),console.log("[getKitchenById] Returning mock data as fallback"),null;const n={id:t.id,...t.data()};return console.log("[getKitchenById] Successfully fetched kitchen data:",n),n}catch(t){return console.error("[getKitchenById] Error fetching kitchen:",t),console.log("[getKitchenById] Returning mock data due to error"),null}}function co(e){if(!e||e.length===0)return{totalReviews:0,averageRating:0,ratingBreakdown:{5:0,4:0,3:0,2:0,1:0},ratingPercentages:{5:0,4:0,3:0,2:0,1:0}};const t=e.length;console.log("🚀 ~ calculateReviewStats ~ totalReviews:",t);const n={5:0,4:0,3:0,2:0,1:0};let r=0;e.forEach(o=>{const l=Math.floor(o.rating||0);l>=1&&l<=5&&(n[l]++,r+=o.rating)});const a=t>0?r/t:0,s={};for(let o=1;o<=5;o++)s[o]=t>0?n[o]/t*100:0;return{totalReviews:t,averageRating:parseFloat(a.toFixed(1)),ratingBreakdown:n,ratingPercentages:s}}async function Dm(e=20){if(console.log(`[getAllFoods] Starting fetch with limit: ${e}`),_e)return[];try{const t=ke(ge(le,"foodItems"),Qe(e)),r=(await be(t)).docs.map(a=>({id:a.id,...a.data()}));return r.length>0?r:po()}catch(t){return console.error("[getAllFoods] Error:",t),[]}}async function uo(e,t=1e3){if(console.log(`[getKitchenAllReviews] Fetching all reviews for kitchen: ${e}`),_e)return console.warn("[getKitchenAllReviews] Firebase disabled, returning mock data"),[];if(!e||e.trim()==="")return console.log("[getKitchenAllReviews] No kitchenId provided, returning empty array"),[];try{console.log(`[getKitchenAllReviews] Querying reviews subcollection for kitchen: ${e}`);const n=ge(le,"kitchens",e,"reviews"),r=ke(n,Qe(t)),s=(await be(r)).docs.map(o=>({id:o.id,kitchenId:e,...o.data()}));return console.log(`[getKitchenAllReviews] Found ${s.length} total reviews for kitchen ${e}`),s.length>0&&s.sort((o,l)=>{const c=m=>m?typeof m=="string"?m.includes(" at ")?new Date(m.replace(" at "," ").replace(" UTC+5","")):new Date(m):m.seconds?new Date(m.seconds*1e3):new Date(m):new Date(0),d=c(o.timeStamp);return c(l.timeStamp)-d}),console.log(`[getKitchenAllReviews] Returning ${s.length} reviews for kitchen ${e}`),s}catch(n){return console.error("[getKitchenAllReviews] Error fetching kitchen reviews:",n),console.log("[getKitchenAllReviews] Returning mock data due to error"),[]}}async function Em(e){console.log(`[getKitchenReviewStats] Getting review stats for kitchen: ${e}`);try{const t=await uo(e),r={...co(t),kitchenId:e,reviewsList:t,uniqueFoodIds:[...new Set(t.map(a=>a.foodId).filter(Boolean))],lastUpdated:new Date().toISOString()};return console.log(`[getKitchenReviewStats] Kitchen ${e} stats:`,r),r}catch(t){return console.error("[getKitchenReviewStats] Error calculating kitchen stats:",t),{kitchenId:e,totalReviews:0,averageRating:0,ratingBreakdown:{5:0,4:0,3:0,2:0,1:0},ratingPercentages:{5:0,4:0,3:0,2:0,1:0},reviewsList:[],uniqueFoodIds:[],lastUpdated:new Date().toISOString(),error:t.message}}}function on(e){return{id:e,name:"Dim Sum (Dumplings)",description:"A timeless delicacy from Chinese cuisine, Dim Sum dumplings are handcrafted pockets of flavor, delicately wrapped in thin, translucent dough. Each dumpling is steamed to perfection, preserving the juicy, savory filling inside.",cost:150,foodCategory:"1, 2",foodType:"Chinese",imageUrl:"/src/assets/images/product.png",kitchenId:"mock-kitchen-1",kitchenName:"Resto Parmato Bapo",isFeatured:!0,availability:{numAvailable:15,numOfSoldItem:85},engagement:{numOfLike:127,rating:4.9,numRatings:1247,countRating:1247}}}function Am(e){const t=new Date,n=new Date(t);n.setDate(t.getDate()+1);const r=new Date(t);r.setDate(t.getDate()+2);const a=s=>s.toISOString().split("T")[0];return{id:e,name:"Coco's Kitchen",address:"Lahore-Sialkot Motorway",city:"San Francisco",cuisine:"Thai",description:"This is the kitchen of James done. This is the kitchen of James done, This is the kitchen of James done.This is the kitchen of James done",ownerId:"mock-owner-1",location:{latitude:37.5485,longitude:-121.9886},rating:4.9,ratingCount:1247,preorderSchedule:{dates:{[a(n)]:[{id:"schedule-1",foodItemId:"food-3",nameOfFood:"Dim Sum (Dumplings)",availableTimes:["6:22 PM","7:30 PM"],numOfAvailableItems:10,isLimitedOrder:!1},{id:"schedule-2",foodItemId:"food-4",nameOfFood:"Margherita Pizza",availableTimes:["6:22 PM","8:00 PM"],numOfAvailableItems:8,isLimitedOrder:!1}],[a(r)]:[{id:"schedule-3",foodItemId:"food-3",nameOfFood:"Dim Sum (Dumplings)",availableTimes:["5:30 PM","7:00 PM"],numOfAvailableItems:12,isLimitedOrder:!1}]}}}}function po(){return[on("food-1"),{...on("food-2"),id:"food-2",name:"Margherita Pizza",cost:12.45,availability:{numAvailable:5,numOfSoldItem:2},imageUrl:"/src/assets/images/order2.png"},{...on("food-3"),id:"food-3",name:"Dim Sum (Dumplings)",cost:22.45,availability:{numAvailable:0,numOfSoldItem:15},imageUrl:"/src/assets/images/order1.png"},{...on("food-4"),id:"food-4",name:"Margherita Pizza (Pre-order)",cost:12.45,availability:{numAvailable:0,numOfSoldItem:8},imageUrl:"/src/assets/images/order2.png"}]}async function Lm(e){if(console.log(`[getKitchenWithFoodItems] Fetching kitchen: ${e}`),_e)return console.warn("[getKitchenWithFoodItems] Firebase disabled, returning mock data"),{kitchen:Am(e),foods:po()};try{const t=await Ge($e(le,"kitchens",e));if(!t.exists())return console.warn(`[getKitchenWithFoodItems] Kitchen ${e} not found`),{kitchen:null,foods:[]};const n={id:t.id,...t.data()},r=ge(le,"kitchens",e,"foodItems"),s=(await be(r)).docs.map(o=>({id:o.id,kitchenId:e,...o.data()}));return console.log(`[getKitchenWithFoodItems] Found ${s.length} food items for kitchen ${e}`),{kitchen:n,foods:s}}catch(t){return console.error("[getKitchenWithFoodItems] Error:",t),{kitchen:null,foods:[]}}}const _m=async(e,t,n)=>{try{console.log("🔥 Adding like to Firestore:",{kitchenId:e,productId:t,userId:n});const r=ge(le,"kitchens",e,"likes"),a={productId:t,userId:n,timestamp:It()},s=await Ga(r,a);return console.log("✅ Like added successfully with ID:",s.id),{id:s.id,...a}}catch(r){throw console.error("❌ Error adding like:",r),r}},Om=async(e,t,n)=>{try{console.log("🔥 Removing like from Firestore:",{kitchenId:e,productId:t,userId:n});const r=ge(le,"kitchens",e,"likes"),a=ke(r,Me("productId","==",t),Me("userId","==",n)),s=await be(a);if(s.empty)return console.warn("⚠️ No like found to remove"),!1;const o=s.docs.map(l=>nl(l.ref));return await Promise.all(o),console.log("✅ Like(s) removed successfully"),!0}catch(r){throw console.error("❌ Error removing like:",r),r}},mo=async(e,t,n)=>{try{const r=ge(le,"kitchens",e,"likes"),a=ke(r,Me("productId","==",t),Me("userId","==",n));return!(await be(a)).empty}catch(r){return console.error("❌ Error checking user like:",r),!1}},ca=e=>!e||!e._lat||!e._long?null:{lat:e._lat,lng:e._long},Im=e=>!e||!e.seconds?null:new Date(e.seconds*1e3+(e.nanoseconds||0)/1e6).toISOString(),Be=e=>{if(!e||typeof e!="object")return e;const t={...e};return t.location&&t.location._lat!==void 0&&(t.location=ca(t.location)),Object.keys(t).forEach(n=>{const r=t[n];r&&typeof r=="object"&&(r._lat!==void 0&&r._long!==void 0?t[n]=ca(r):r.seconds!==void 0&&(r.nanoseconds!==void 0||r.nanoseconds===0)?t[n]=Im(r):Array.isArray(r)?t[n]=r.map(a=>Be(a)):t[n]=Be(r))}),t},Ut=Re("food/fetchDetail",async({foodId:e,kitchenId:t})=>{try{return{...await Cm(e,t),foodId:e,kitchenId:t}}catch(n){return{food:await lo(e),kitchen:null,likes:[],reviews:[],reviewStats:null,foodId:e,kitchenId:t}}}),vr=Re("food/fetchAll",async(e=20)=>await Dm(e)),fo=Re("food/checkLikeStatus",async({foodId:e,kitchenId:t},{getState:n})=>{var s;const{auth:r}=n(),a=(s=r.user)==null?void 0:s.id;if(console.log("🔍 Checking like status:",{foodId:e,kitchenId:t,userId:a}),!a||!t)return console.log("❌ Missing userId or kitchenId for like status check"),{foodId:e,liked:!1};try{const o=await mo(t,e,a);return console.log("✅ Like status check result:",{foodId:e,isLiked:o}),{foodId:e,liked:o}}catch(o){return console.error("❌ Error checking like status:",o),{foodId:e,liked:!1}}}),zr=Re("food/toggleLike",async(e,{getState:t})=>{var c,d;const{auth:n,food:r}=t(),a=(c=n.user)==null?void 0:c.id,s=(d=r.currentKitchen)==null?void 0:d.id;if(console.log("🔄 Toggle like action:",{foodId:e,userId:a,kitchenId:s,currentLikedFoods:r.likedFoods}),!a)throw new Error("User not authenticated");if(!s)throw new Error("Kitchen information not available");const o=r.likedFoods.includes(e);console.log("🔍 Current like state from Redux:",{foodId:e,isCurrentlyLiked:o}),console.log("🔍 Checking actual Firestore like state before toggle");const l=await mo(s,e,a);console.log("🔍 Actual Firestore like state:",{foodId:e,actualFirestoreState:l});try{return l?(console.log("🔥 Attempting to remove like from Firestore"),await Om(s,e,a),console.log("✅ Like removed from Firestore")):(console.log("🔥 Attempting to add like to Firestore"),await _m(s,e,a),console.log("✅ Like added to Firestore")),{foodId:e,userId:a,kitchenId:s,liked:!l}}catch(u){throw console.error("❌ Error toggling like in Firestore:",u),u}});Re("food/refresh",async({foodId:e,kitchenId:t},{dispatch:n})=>n(Ut({foodId:e,kitchenId:t})));const ho=Et({name:"food",initialState:{currentFood:null,currentKitchen:null,currentReviews:[],currentReviewStats:null,currentLikes:[],allFoods:[],likedFoods:[],loading:!1,allFoodsLoading:!1,error:null,allFoodsError:null,lastUpdated:null,allFoodsLastUpdated:null},reducers:{clearCurrentFood:e=>{e.currentFood=null,e.currentKitchen=null,e.currentReviews=[],e.currentReviewStats=null,e.currentLikes=[],e.error=null},clearError:e=>{e.error=null},clearAllFoodsError:e=>{e.allFoodsError=null},updateFoodInList:(e,t)=>{var s;const{foodId:n,updates:r}=t.payload,a=e.allFoods.findIndex(o=>o.id===n);a!==-1&&(e.allFoods[a]={...e.allFoods[a],...r}),((s=e.currentFood)==null?void 0:s.id)===n&&(e.currentFood={...e.currentFood,...r})},toggleLikeLocally:(e,t)=>{const n=t.payload,r=e.likedFoods.includes(n);console.log("🔄 toggleLikeLocally called:",{foodId:n,currentlyLiked:r,likedFoods:e.likedFoods}),r?(e.likedFoods=e.likedFoods.filter(a=>a!==n),console.log("➖ Locally removed like for:",n)):(e.likedFoods.push(n),console.log("➕ Locally added like for:",n)),console.log("🔍 Updated likedFoods locally:",e.likedFoods)}},extraReducers:e=>{e.addCase(Ut.pending,t=>{t.loading=!0,t.error=null}).addCase(Ut.fulfilled,(t,n)=>{t.loading=!1;const{food:r,kitchen:a,likes:s,reviews:o,reviewStats:l}=n.payload;t.currentFood=Be(r),t.currentKitchen=Be(a),t.currentReviews=o?o.map(c=>Be(c)):[],t.currentReviewStats=Be(l),t.currentLikes=s?s.map(c=>Be(c)):[],t.lastUpdated=new Date().toISOString()}).addCase(Ut.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message}).addCase(vr.pending,t=>{t.allFoodsLoading=!0,t.allFoodsError=null}).addCase(vr.fulfilled,(t,n)=>{t.allFoodsLoading=!1,t.allFoods=n.payload,t.allFoodsLastUpdated=new Date().toISOString()}).addCase(vr.rejected,(t,n)=>{t.allFoodsLoading=!1,t.allFoodsError=n.error.message}).addCase(zr.fulfilled,(t,n)=>{const{foodId:r,liked:a}=n.payload;a&&!t.likedFoods.includes(r)?t.likedFoods.push(r):a||(t.likedFoods=t.likedFoods.filter(s=>s!==r))}).addCase(zr.rejected,(t,n)=>{const r=n.meta.arg;t.likedFoods.includes(r)?t.likedFoods=t.likedFoods.filter(s=>s!==r):t.likedFoods.push(r)}).addCase(fo.fulfilled,(t,n)=>{const{foodId:r,liked:a}=n.payload;console.log("✅ Like status check fulfilled:",{foodId:r,liked:a,currentLikedFoods:t.likedFoods}),a&&!t.likedFoods.includes(r)?(t.likedFoods.push(r),console.log("➕ Added foodId to likedFoods:",r)):a||(t.likedFoods=t.likedFoods.filter(s=>s!==r),console.log("➖ Removed foodId from likedFoods:",r)),console.log("🔍 Updated likedFoods:",t.likedFoods)})}}),{clearCurrentFood:Tm,clearError:Xh,clearAllFoodsError:eg,updateFoodInList:tg,toggleLikeLocally:ng}=ho.actions,Pm=ho.reducer,bt=Et({name:"cart",initialState:{items:[],totalItems:0,totalAmount:0,loading:!1,error:null,lastUpdated:null},reducers:{addToCart:(e,t)=>{var o;console.log("🛒 Adding to cart:",t.payload);const n=t.payload,{selectedDate:r,selectedTime:a}=t.payload;console.log("newItem redux item:",n),console.log("state item length redux items:",(o=e==null?void 0:e.items)==null?void 0:o.length);const s=e.items.findIndex(l=>l.foodId===n.foodId&&l.orderType===n.orderType);if(console.log("existingItemIndex",s),s!==-1){const l=e.items[s].quantity;e.items[s].quantity+=n.quantity||1,e.items[s].updatedAt=new Date().toISOString(),e.items[s].selectedDate=r,e.items[s].selectedTime=a,console.log("📦 Updated existing cart item quantity:",{foodId:n.foodId,selectedDate:n.selectedDate,oldQuantity:l,newQuantity:e.items[s].quantity,addedQuantity:n.quantity||1})}else{const l={id:`cart-item-${Date.now()}-${Math.random()}`,foodId:n.foodId,kitchenId:n.kitchenId,userId:n.userId||"local_user",quantity:n.quantity||1,selectedDate:n.selectedDate||null,selectedTime:n.selectedTime||null,orderType:n.orderType||"GO_GRAB",specialInstructions:n.specialInstructions||"",food:n.food||null,kitchen:n.kitchen||null,pickupDetails:n.pickupDetails||{date:n.selectedDate,time:n.selectedTime,display:n.orderType==="GO_GRAB"?"Pick up today":`Pick up ${n.selectedDate}`,orderType:n.orderType||"GO_GRAB"},isPreOrder:n.isPreOrder||!1,addedAt:new Date().toISOString()};e.items.push(l),console.log("📦 Added new cart item:",l)}bt.caseReducers.calculateTotals(e)},removeFromCart:(e,t)=>{const n=t.payload;console.log("🗑️ Removing from cart:",n);const r=e.items.length;e.items=e.items.filter(a=>a.id!==n),console.log("🗑️ Removed cart item:",{itemId:n,itemsRemoved:r-e.items.length,remainingItems:e.items.length}),bt.caseReducers.calculateTotals(e)},updateCartItem:(e,t)=>{var d;const{cartItemId:n,quantity:r,specialInstructions:a,orderType:s,selectedDate:o,selectedTime:l}=t.payload;console.log("📝 Updating cart item:",t.payload),console.log("state item length redux items:",(d=e==null?void 0:e.items)==null?void 0:d.length);const c=e.items.findIndex(u=>u.id===n&&u.orderType===s);console.log("itemIndex redux items:",c),c!==-1?(r!==void 0&&(e.items[c].quantity=r),a!==void 0&&(e.items[c].specialInstructions=a),o!==void 0&&(e.items[c].selectedDate=o),l!==void 0&&(e.items[c].selectedTime=l),e.items[c].updatedAt=new Date().toISOString(),console.log("Updated cart redux items:",e.items),console.log("📝 Updated cart item:",{itemId:n,newQuantity:r,specialInstructions:a}),bt.caseReducers.calculateTotals(e)):console.error("❌ Cart item not found for update:",n)},updatePickupDetails:(e,t)=>{const{cartItemId:n,pickupDate:r,pickupTime:a,orderType:s}=t.payload;console.log("📅 Updating pickup details:",t.payload);const o=e.items.find(l=>l.id===n);o?(r!==void 0&&(o.selectedDate=r),a!==void 0&&(o.selectedTime=a),s!==void 0&&(o.orderType=s),o.pickupDetails||(o.pickupDetails={}),r!==void 0&&(o.pickupDetails.date=r,o.pickupDetails.display=s==="GO_GRAB"?"Pick up today":`Pick up ${r}`),a!==void 0&&(o.pickupDetails.time=a),s!==void 0&&(o.pickupDetails.orderType=s),o.updatedAt=new Date().toISOString(),console.log("📅 Updated pickup details for item:",n)):console.error("❌ Cart item not found for pickup details update:",n)},clearCart:e=>{console.log("🗑️ Clearing entire cart"),e.items=[],e.totalItems=0,e.totalAmount=0,e.lastUpdated=new Date().toISOString()},clearError:e=>{e.error=null},calculateTotals:e=>{e.totalItems=e.items.reduce((t,n)=>t+(n.quantity||1),0),e.totalAmount=e.items.reduce((t,n)=>{var s;const r=((s=n.food)==null?void 0:s.cost)||0,a=typeof r=="string"?parseFloat(r):r;return t+a*(n.quantity||1)},0),e.lastUpdated=new Date().toISOString(),console.log("🧮 Calculated totals:",{totalItems:e.totalItems,totalAmount:e.totalAmount,itemCount:e.items.length})},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload}},extraReducers:e=>{e.addCase(Wn,(t,n)=>{var r;if((r=n.payload)!=null&&r.cart){console.log("💾 Rehydrating cart from persistence:",n.payload.cart);const a={...t,...n.payload.cart,loading:!1,error:null};return bt.caseReducers.calculateTotals(a),a}})}}),{addToCart:go,removeFromCart:Nm,updateCartItem:qr,updatePickupDetails:rg,clearCart:Kn,clearError:ig,calculateTotals:ag,setLoading:sg,setError:og}=bt.actions,Fm=bt.reducer,hn=Re("kitchen/fetchStats",async e=>{try{const t=await Em(e);return{kitchenId:e,stats:t}}catch(t){throw console.error("Error fetching kitchen stats:",t),t}}),gn=Re("kitchen/fetchReviews",async({kitchenId:e,limit:t=10})=>{try{const n=await uo(e,t);return{kitchenId:e,reviews:n}}catch(n){throw console.error("Error fetching kitchen reviews:",n),n}}),$m=Re("kitchen/addReview",async({kitchenId:e,reviewData:t},{getState:n})=>{var l,c;const{auth:r}=n(),a=(l=r.user)==null?void 0:l.id,s=((c=r.user)==null?void 0:c.name)||"Anonymous";if(!a)throw new Error("User not authenticated");console.log("Adding kitchen review:",{kitchenId:e,reviewData:t,userId:a,userName:s}),await new Promise(d=>setTimeout(d,500));const o={id:`review-${Date.now()}`,userId:a,userName:s,rating:t.rating,comment:t.comment,timestamp:new Date().toISOString(),kitchenId:e};return{kitchenId:e,review:o}}),Mm=Re("kitchen/updateReview",async({kitchenId:e,reviewId:t,updates:n},{getState:r})=>{var o;const{auth:a}=r(),s=(o=a.user)==null?void 0:o.id;if(!s)throw new Error("User not authenticated");return console.log("Updating kitchen review:",{kitchenId:e,reviewId:t,updates:n,userId:s}),await new Promise(l=>setTimeout(l,300)),{kitchenId:e,reviewId:t,updates:n}}),Um=Re("kitchen/deleteReview",async({kitchenId:e,reviewId:t},{getState:n})=>{var s;const{auth:r}=n(),a=(s=r.user)==null?void 0:s.id;if(!a)throw new Error("User not authenticated");return console.log("Deleting kitchen review:",{kitchenId:e,reviewId:t,userId:a}),await new Promise(o=>setTimeout(o,300)),{kitchenId:e,reviewId:t}}),vo=Et({name:"kitchen",initialState:{kitchenStats:{},kitchenReviews:{},statsLoading:{},reviewsLoading:{},statsError:{},reviewsError:{},statsLastUpdated:{},reviewsLastUpdated:{}},reducers:{clearKitchenData:(e,t)=>{const n=t.payload;delete e.kitchenStats[n],delete e.kitchenReviews[n],delete e.statsLoading[n],delete e.reviewsLoading[n],delete e.statsError[n],delete e.reviewsError[n],delete e.statsLastUpdated[n],delete e.reviewsLastUpdated[n]},clearAllKitchenData:()=>({kitchenStats:{},kitchenReviews:{},statsLoading:{},reviewsLoading:{},statsError:{},reviewsError:{},statsLastUpdated:{},reviewsLastUpdated:{}}),clearKitchenErrors:(e,t)=>{const n=t.payload;delete e.statsError[n],delete e.reviewsError[n]}},extraReducers:e=>{e.addCase(hn.pending,(t,n)=>{const r=n.meta.arg;t.statsLoading[r]=!0,delete t.statsError[r]}).addCase(hn.fulfilled,(t,n)=>{const{kitchenId:r,stats:a}=n.payload;t.statsLoading[r]=!1,t.kitchenStats[r]=Be(a),t.statsLastUpdated[r]=new Date().toISOString()}).addCase(hn.rejected,(t,n)=>{const r=n.meta.arg;t.statsLoading[r]=!1,t.statsError[r]=n.error.message}).addCase(gn.pending,(t,n)=>{const{kitchenId:r}=n.meta.arg;t.reviewsLoading[r]=!0,delete t.reviewsError[r]}).addCase(gn.fulfilled,(t,n)=>{const{kitchenId:r,reviews:a}=n.payload;t.reviewsLoading[r]=!1,t.kitchenReviews[r]=a?a.map(s=>Be(s)):[],t.reviewsLastUpdated[r]=new Date().toISOString()}).addCase(gn.rejected,(t,n)=>{const{kitchenId:r}=n.meta.arg;t.reviewsLoading[r]=!1,t.reviewsError[r]=n.error.message}).addCase($m.fulfilled,(t,n)=>{const{kitchenId:r,review:a}=n.payload;t.kitchenReviews[r]||(t.kitchenReviews[r]=[]);const s=Be(a);if(t.kitchenReviews[r].unshift(s),t.kitchenStats[r]){const o=t.kitchenStats[r],l=o.totalReviews||0,c=(o.averageRating||0)*l,d=l+1,u=c+a.rating;t.kitchenStats[r]={...o,totalReviews:d,averageRating:u/d}}}).addCase(Mm.fulfilled,(t,n)=>{const{kitchenId:r,reviewId:a,updates:s}=n.payload;if(t.kitchenReviews[r]){const o=t.kitchenReviews[r].findIndex(l=>l.id===a);if(o!==-1){const l=t.kitchenReviews[r][o].rating;if(t.kitchenReviews[r][o]={...t.kitchenReviews[r][o],...s,updatedAt:new Date().toISOString()},s.rating&&s.rating!==l&&t.kitchenStats[r]){const c=t.kitchenStats[r],d=c.totalReviews||0,m=(c.averageRating||0)*d-l+s.rating;t.kitchenStats[r]={...c,averageRating:m/d}}}}}).addCase(Um.fulfilled,(t,n)=>{const{kitchenId:r,reviewId:a}=n.payload;if(t.kitchenReviews[r]){const s=t.kitchenReviews[r].findIndex(o=>o.id===a);if(s!==-1){const o=t.kitchenReviews[r][s].rating;if(t.kitchenReviews[r].splice(s,1),t.kitchenStats[r]){const l=t.kitchenStats[r],c=l.totalReviews||0;if(c>1){const d=(l.averageRating||0)*c,u=c-1,m=d-o;t.kitchenStats[r]={...l,totalReviews:u,averageRating:m/u}}else t.kitchenStats[r]={...l,totalReviews:0,averageRating:0}}}}})}}),{clearKitchenData:lg,clearAllKitchenData:cg,clearKitchenErrors:dg}=vo.actions,zm=vo.reducer,vn=Re("reviews/fetchFoodReviews",async({foodId:e,kitchenId:t,limit:n=10})=>{try{console.log("Fetching food reviews:",{foodId:e,kitchenId:t,limit:n}),await new Promise(a=>setTimeout(a,300));const r=[{id:`review-1-${e}`,userId:"user-001",userName:"Alice Chen",rating:5,comment:"Absolutely delicious! Perfect taste and portion size.",timestamp:new Date(Date.now()-864e5).toISOString(),foodId:e,kitchenId:t,verified:!0},{id:`review-2-${e}`,userId:"user-002",userName:"Bob Wilson",rating:4,comment:"Great food, fast delivery. Will order again!",timestamp:new Date(Date.now()-1728e5).toISOString(),foodId:e,kitchenId:t,verified:!0},{id:`review-3-${e}`,userId:"user-003",userName:"Carol Davis",rating:5,comment:"Outstanding quality! Fresh ingredients and amazing flavors.",timestamp:new Date(Date.now()-2592e5).toISOString(),foodId:e,kitchenId:t,verified:!0}].slice(0,n);return{foodId:e,kitchenId:t,reviews:r}}catch(r){throw console.error("Error fetching food reviews:",r),r}}),xn=Re("reviews/addFoodReview",async({foodId:e,kitchenId:t,reviewData:n},{getState:r})=>{var c,d;const{auth:a}=r(),s=(c=a.user)==null?void 0:c.id,o=((d=a.user)==null?void 0:d.name)||"Anonymous";if(!s)throw new Error("User not authenticated");console.log("Adding food review:",{foodId:e,kitchenId:t,reviewData:n,userId:s,userName:o}),await new Promise(u=>setTimeout(u,500));const l={id:`review-${Date.now()}`,userId:s,userName:o,rating:n.rating,comment:n.comment,timestamp:new Date().toISOString(),foodId:e,kitchenId:t,verified:!0};return{foodId:e,kitchenId:t,review:l}}),qm=Re("reviews/updateFoodReview",async({foodId:e,kitchenId:t,reviewId:n,updates:r},{getState:a})=>{var l;const{auth:s}=a(),o=(l=s.user)==null?void 0:l.id;if(!o)throw new Error("User not authenticated");return console.log("Updating food review:",{foodId:e,kitchenId:t,reviewId:n,updates:r,userId:o}),await new Promise(c=>setTimeout(c,300)),{foodId:e,kitchenId:t,reviewId:n,updates:r}}),Bm=Re("reviews/deleteFoodReview",async({foodId:e,kitchenId:t,reviewId:n},{getState:r})=>{var o;const{auth:a}=r(),s=(o=a.user)==null?void 0:o.id;if(!s)throw new Error("User not authenticated");return console.log("Deleting food review:",{foodId:e,kitchenId:t,reviewId:n,userId:s}),await new Promise(l=>setTimeout(l,300)),{foodId:e,kitchenId:t,reviewId:n}}),xr=Re("reviews/fetchUserReviews",async({limit:e=20},{getState:t})=>{var s;const{auth:n}=t(),r=(s=n.user)==null?void 0:s.id;if(!r)throw new Error("User not authenticated");return console.log("Fetching user reviews:",{userId:r,limit:e}),await new Promise(o=>setTimeout(o,300)),[{id:"user-review-1",userId:r,userName:n.user.name,rating:5,comment:"Loved this dish! Perfect for dinner.",timestamp:new Date(Date.now()-864e5).toISOString(),foodId:"food-001",foodName:"Kung Pao Chicken",kitchenId:"kitchen-001",kitchenName:"Mary's Kitchen",verified:!0},{id:"user-review-2",userId:r,userName:n.user.name,rating:4,comment:"Good value for money. Quick delivery.",timestamp:new Date(Date.now()-1728e5).toISOString(),foodId:"food-002",foodName:"Beef Noodle Soup",kitchenId:"kitchen-002",kitchenName:"Tom's Noodles",verified:!0}]}),xo=Et({name:"reviews",initialState:{foodReviews:{},userReviews:[],foodReviewsLoading:{},userReviewsLoading:!1,foodReviewsError:{},userReviewsError:null,foodReviewsLastUpdated:{},userReviewsLastUpdated:null,submissionLoading:!1,submissionError:null},reducers:{clearFoodReviews:(e,t)=>{const n=t.payload;delete e.foodReviews[n],delete e.foodReviewsLoading[n],delete e.foodReviewsError[n],delete e.foodReviewsLastUpdated[n]},clearAllReviews:e=>{e.foodReviews={},e.userReviews=[],e.foodReviewsLoading={},e.userReviewsLoading=!1,e.foodReviewsError={},e.userReviewsError=null,e.foodReviewsLastUpdated={},e.userReviewsLastUpdated=null},clearReviewErrors:(e,t)=>{if(t.payload){const n=t.payload;delete e.foodReviewsError[n]}else e.foodReviewsError={},e.userReviewsError=null,e.submissionError=null},clearSubmissionError:e=>{e.submissionError=null}},extraReducers:e=>{e.addCase(vn.pending,(t,n)=>{const{foodId:r}=n.meta.arg;t.foodReviewsLoading[r]=!0,delete t.foodReviewsError[r]}).addCase(vn.fulfilled,(t,n)=>{const{foodId:r,reviews:a}=n.payload;t.foodReviewsLoading[r]=!1,t.foodReviews[r]=a,t.foodReviewsLastUpdated[r]=new Date().toISOString()}).addCase(vn.rejected,(t,n)=>{const{foodId:r}=n.meta.arg;t.foodReviewsLoading[r]=!1,t.foodReviewsError[r]=n.error.message}).addCase(xn.pending,t=>{t.submissionLoading=!0,t.submissionError=null}).addCase(xn.fulfilled,(t,n)=>{t.submissionLoading=!1;const{foodId:r,review:a}=n.payload;t.foodReviews[r]||(t.foodReviews[r]=[]),t.foodReviews[r].unshift(a),t.userReviews.unshift({...a,foodName:"Unknown Food",kitchenName:"Unknown Kitchen"})}).addCase(xn.rejected,(t,n)=>{t.submissionLoading=!1,t.submissionError=n.error.message}).addCase(qm.fulfilled,(t,n)=>{const{foodId:r,reviewId:a,updates:s}=n.payload;if(t.foodReviews[r]){const l=t.foodReviews[r].findIndex(c=>c.id===a);l!==-1&&(t.foodReviews[r][l]={...t.foodReviews[r][l],...s,updatedAt:new Date().toISOString()})}const o=t.userReviews.findIndex(l=>l.id===a);o!==-1&&(t.userReviews[o]={...t.userReviews[o],...s,updatedAt:new Date().toISOString()})}).addCase(Bm.fulfilled,(t,n)=>{const{foodId:r,reviewId:a}=n.payload;t.foodReviews[r]&&(t.foodReviews[r]=t.foodReviews[r].filter(s=>s.id!==a)),t.userReviews=t.userReviews.filter(s=>s.id!==a)}).addCase(xr.pending,t=>{t.userReviewsLoading=!0,t.userReviewsError=null}).addCase(xr.fulfilled,(t,n)=>{t.userReviewsLoading=!1,t.userReviews=n.payload,t.userReviewsLastUpdated=new Date().toISOString()}).addCase(xr.rejected,(t,n)=>{t.userReviewsLoading=!1,t.userReviewsError=n.error.message})}}),{clearFoodReviews:ug,clearAllReviews:pg,clearReviewErrors:mg,clearSubmissionError:fg}=xo.actions,Wm=xo.reducer,da={goGrabItems:[],preOrderItems:[],availablePreorderDates:[],kitchen:null,isLoading:!1,lastUpdated:null,kitchenId:null},yo=Et({name:"listing",initialState:da,reducers:{setListingLoading:(e,t)=>{e.isLoading=t.payload},setListingData:(e,t)=>{const{goGrabItems:n,preOrderItems:r,availablePreorderDates:a,kitchen:s}=t.payload;e.goGrabItems=n,e.preOrderItems=r,e.availablePreorderDates=a,e.kitchen=s,e.kitchenId=(s==null?void 0:s.id)||null,e.isLoading=!1,e.lastUpdated=Date.now()},clearListingData:e=>da}}),{setListingLoading:ua,setListingData:Ym,clearListingData:hg}=yo.actions,Gm=yo.reducer,Km={key:"root",storage:ii,whitelist:["auth","cart"],blacklist:["food","kitchen","reviews"]},Hm={key:"auth",storage:ii,whitelist:["user","isAuthenticated","isDevelopmentMode"],blacklist:["loading","error","wechatAuthUrl"]},Qm={key:"cart",storage:ii,whitelist:["items","totalItems","totalAmount"],blacklist:["loading","error"]},Vm=is({auth:Nr(Hm,Md),food:Pm,cart:Nr(Qm,Fm),kitchen:zm,reviews:Wm,listing:Gm}),Zm=Nr(Km,Vm),bo=Hc({reducer:Zm,middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE"]}})}),wo=Id(bo),ko=Re("app/performCompleteLogout",async(e,{dispatch:t})=>{try{return console.log("🚪 Starting complete logout process..."),t($d()),t(Kn()),await wo.purge(),localStorage.removeItem("persist:root"),localStorage.removeItem("persist:auth"),localStorage.removeItem("persist:cart"),sessionStorage.clear(),console.log("✅ Complete logout successful"),{success:!0}}catch(n){throw console.error("❌ Logout error:",n),n}}),Jm=()=>{const[e,t]=h.useState(!1),[n,r]=h.useState(null),[a,s]=h.useState(null),[o,l]=h.useState(null),c=h.useCallback(()=>Ka(Pt,v=>{console.log("[useUserAccount] Firebase Auth state changed:",v==null?void 0:v.uid),l(v)}),[]),d=h.useCallback((C,v)=>{var j;console.log("[useUserAccount] Generating email",{unionid:(C==null?void 0:C.substring(0,10))+"...",nickname:v});const x=C.slice(-4),S=(v||"user").replace(/\s+/g,"").replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),_=(j=`${S}${x}@gmail.com`)==null?void 0:j.toLowerCase();return console.log("[useUserAccount] Email generated:",_,{original:v,cleaned:S,last4:x}),_},[]),u=h.useCallback((C,v)=>{const x=`${C}_${v}`;return`WC_${x.substring(0,8)}_${x.slice(-8)}!`},[]),m=h.useCallback(async(C,v,x)=>{console.log("[useUserAccount] Authenticating with Firebase Auth");try{let S=null;try{console.log("[useUserAccount] Attempting to sign in existing user"),S=(await rl(Pt,C,v)).user,console.log("[useUserAccount] Existing Firebase user signed in:",S.uid)}catch(_){console.log("[useUserAccount] Sign in failed, creating new Firebase user"),S=(await il(Pt,C,v)).user,console.log("[useUserAccount] New Firebase user created:",S.uid),await al(S,{displayName:x.nickname||x.name,photoURL:x.headimgurl||x.avatar}),console.log("[useUserAccount] Firebase user profile updated")}return{success:!0,firebaseUser:S,firebaseUid:S.uid}}catch(S){return console.error("[useUserAccount] Firebase authentication failed:",S),{success:!1,error:S.message,firebaseUser:null,firebaseUid:null}}},[]),g=h.useCallback(async C=>{console.log("[useUserAccount] Checking account existence for:",C);try{const v=ge(le,"accounts"),x=ke(v,Me("email","==",C)),S=await be(x);if(!S.empty){const _=S.docs[0],j={id:_.id,..._.data()};return console.log("[useUserAccount] Account found:",_.id),{exists:!0,data:j,method:"query"}}return console.log("[useUserAccount] No account found"),{exists:!1,data:null,method:"not_found"}}catch(v){return console.error("[useUserAccount] Error checking account:",v),{exists:!1,data:null,error:v.message,method:"error_fallback"}}},[]),p=h.useCallback(async(C,v)=>{console.log("[useUserAccount] Creating new account for:",v);const{openid:x,nickname:S,headimgurl:_,sex:j,country:O,province:E,city:$,unionid:B}=C.user||C;try{const W=u(B,x),R=await m(v,W,{nickname:S,headimgurl:_,name:S,avatar:_});if(!R.success)throw new Error(`Firebase authentication failed: ${R.error}`);const w=ge(le,"accounts"),P=$e(w),F={email:v,name:S||"WeChat User",firebaseUid:R.firebaseUid,firebaseEmail:R.firebaseUser.email,isAdmin:!1,isChef:!1,isLogInWithWechat:!0,wantsToBeChef:!1,wechatOpenId:x,wechatUnionId:B||"",wechatNickname:S||"",wechatAvatar:_||"",wechatSex:j||0,wechatCountry:O||"",wechatProvince:E||"",wechatCity:$||"",favoriteCuisines:[],howHeardAboutUs:"WeChat",fcmToken:"",accountCreationDate:It(),lastLoginAt:It(),authMethod:"wechat",profileComplete:!1};return console.log("[useUserAccount] Saving to Firestore..."),await sl(P,F),console.log("[useUserAccount] Account created:",P.id),{success:!0,account:{id:P.id,...F,accountCreationDate:new Date().toISOString(),lastLoginAt:new Date().toISOString(),firebaseUid:R.firebaseUid},firebaseUser:R.firebaseUser}}catch(W){throw console.error("[useUserAccount] Error creating account:",W),alert(`❌ Failed to create account:
${W.message}`),W}},[u,m]),y=h.useCallback(async(C,v)=>{var x,S,_;console.log("[useUserAccount] Updating login for account:",C),console.log("[useUserAccount] Skipping Firebase authentication for existing user update");try{const j=$e(le,"accounts",C);if(!(await Ge(j)).exists())throw new Error("Account not found");const E={lastLoginAt:It(),wechatOpenId:v.openid||((x=v.user)==null?void 0:x.openid),wechatAvatar:((S=v.user)==null?void 0:S.headimgurl)||v.headimgurl||"",wechatNickname:((_=v.user)==null?void 0:_.nickname)||v.nickname||""};return await Nt(j,E),console.log("[useUserAccount] Login updated successfully without Firebase auth"),{success:!0}}catch(j){return console.error("[useUserAccount] Error updating login:",j),{success:!1,error:j.message}}},[]),b=h.useCallback(async C=>{console.log("[useUserAccount] Processing WeChat account with Firebase Auth"),t(!0),r(null);try{if(!C)throw new Error("No WeChat user info provided");const v=C.user||C,{unionid:x,nickname:S}=v;if(!x)throw new Error("No UnionID in WeChat user info");const _=d(x,S),j=await g(_);if(j.exists){console.log(`[useUserAccount] Existing user found - Document ID: ${j.data.id}`),console.log("[useUserAccount] Skipping Firebase authentication for existing user"),console.log(`[useUserAccount] Using stored Firebase UID: ${j.data.firebaseUid||"Not available"}`),y(j.data.id,C).catch($=>{console.warn("[useUserAccount] Failed to update login:",$)});const E={isNewUser:!1,account:j.data,email:_,method:j.method,userId:j.data.id,documentId:j.data.id,firebaseUid:j.data.firebaseUid||null,firebaseUser:null,isExistingUser:!0};return s(E),E}console.log(`[useUserAccount] Creating new account for: ${S}`),console.log("[useUserAccount] New user will be authenticated with Firebase");const O=await p(C,_);if(O.success){console.log(`[useUserAccount] New account created - Document ID: ${O.account.id}`);const E={isNewUser:!0,account:O.account,email:_,method:"created",userId:O.account.id,documentId:O.account.id,firebaseUid:O.account.firebaseUid,firebaseUser:O.firebaseUser,isExistingUser:!1};return s(E),E}throw new Error("Account creation failed")}catch(v){return console.error("[useUserAccount] Error:",v),t(!1),v}finally{t(!1)}},[d,g,p,y,u,m]),f=h.useCallback(async()=>{try{return await Cr(Pt),l(null),s(null),console.log("[useUserAccount] Signed out from Firebase"),{success:!0}}catch(C){return console.error("[useUserAccount] Error signing out:",C),{success:!1,error:C.message}}},[]),k=h.useCallback(async C=>{if(console.log("[useUserAccount] Fetching account:",C),!C)return null;try{const v=$e(le,"accounts",C),x=await Ge(v);if(x.exists()){const S={id:x.id,...x.data()};return console.log("[useUserAccount] Account fetched:",S),S}return null}catch(v){return console.error("[useUserAccount] Error fetching account:",v),null}},[]),A=h.useCallback(async(C,v)=>{if(console.log("[useUserAccount] Updating profile:",C),!C||C.startsWith("temp_"))return{success:!1,error:"Temporary account"};try{const x=$e(le,"accounts",C);return await Nt(x,{...v,lastUpdatedAt:It()}),console.log("[useUserAccount] Profile updated"),{success:!0}}catch(x){return console.error("[useUserAccount] Error updating profile:",x),{success:!1,error:x.message}}},[]);return{loading:e,error:n,accountData:a,firebaseUser:o,processWeChatAccount:b,getAccountById:k,updateUserProfile:A,generateEmailFromWeChatUser:d,checkAccountExists:g,signOutFromFirebase:f,initializeAuthListener:c}},hi=h.createContext(null),Ue=ot?Ya(ot):null;function Xm({children:e}){const[t,n]=h.useState(null),[r,a]=h.useState(!0),{processWeChatAccount:s}=Jm(),o=it();h.useEffect(()=>{if(_e||!Ue){const y=localStorage.getItem("test_user_session");if(y)try{const f=JSON.parse(y);n(f),o(rn(f)),console.log("🧪 Restored test user session:",f)}catch(f){console.warn("Failed to restore test session:",f),localStorage.removeItem("test_user_session")}const b=localStorage.getItem("wechat_user");if(b)try{const f=JSON.parse(b);n(f),o(rn(f)),console.log("🔄 Restored WeChat user session:",f)}catch(f){console.warn("Failed to restore WeChat session:",f),localStorage.removeItem("wechat_user")}a(!1);return}const p=Ka(Ue,y=>{n(y||null),a(!1)});return()=>p()},[Ue,o]);const l=h.useCallback(async()=>{if(_e||!Ue){console.info("Auth disabled: anonymous sign-in skipped");return}await ol(Ue)},[Ue]),c=h.useCallback(()=>{const p=De.APP_ID,y=encodeURIComponent(Ln()),b=De.WEB_SCOPE,f="we_"+Math.random().toString(36).slice(2),k=`${De.QR_AUTHORIZE_URL}?appid=${p}&redirect_uri=${y}&response_type=code&scope=${b}&state=${f}#wechat_redirect`;console.log("🔗 [AuthContext] WeChat OAuth URL:",k),console.log("🔍 [AuthContext] Using redirect URI:",Ln()),window.location.href=k},[]),d=h.useCallback(async p=>{var y,b,f,k,A,C,v,x;try{if(console.log("🔄 Exchanging WeChat code for user info..."),!p)throw new Error("WeChat User Info Error: No user info returned");console.log("✅ Got user info:",p);const _={id:(await s(p)).account.id,uid:p.uid,openid:p.openid,name:p.nickname,displayName:(y=p==null?void 0:p.user)==null?void 0:y.nickname,avatar:(b=p==null?void 0:p.user)==null?void 0:b.headimgurl,photoURL:(f=p==null?void 0:p.user)==null?void 0:f.headimgurl,country:(k=p==null?void 0:p.user)==null?void 0:k.country,province:(A=p==null?void 0:p.user)==null?void 0:A.province,city:(C=p==null?void 0:p.user)==null?void 0:C.city,sex:(v=p==null?void 0:p.user)==null?void 0:v.sex,language:(x=p==null?void 0:p.user)==null?void 0:x.language,isAuthenticated:!0,authMethod:"wechat",wechatOpenId:p.openid,accessToken:p.access_token,refreshToken:p.refresh_token,expireAt:Date.now()+(p.expires_in||7200)*1e3,scope:p.scope,createdAt:new Date().toISOString()};return localStorage.setItem("wechat_user",JSON.stringify(_)),n(_),o(rn(_)),console.log("✅ WeChat authentication successful:",_),_}catch(S){throw console.error("❌ WeChat authentication failed:",S),S}},[o]),u=h.useCallback(async()=>{console.log("🧪 Using WeChat user bypass");const p={id:`test_user_${Date.now()}`,uid:`test_user_${Date.now()}`,openid:`test_openid_${Date.now()}`,name:"Test User",displayName:"Test User",avatar:null,photoURL:null,email:null,country:"Test Country",province:"Test Province",city:"Test City",sex:0,language:"en",isAuthenticated:!0,authMethod:"test",wechatOpenId:`test_openid_${Date.now()}`,accessToken:"test_access_token",providerId:"test",isAnonymous:!1,createdAt:new Date().toISOString()};return n(p),o(rn(p)),localStorage.setItem("test_user_session",JSON.stringify(p)),console.log("✅ Test user signed in:",p),p},[o]),m=h.useCallback(async()=>{try{!_e&&Ue&&await Cr(Ue),localStorage.removeItem("test_user_session"),localStorage.removeItem("wechat_user"),n(null),await o(ko()).unwrap(),console.log("✅ Complete logout successful")}catch(p){console.error("❌ Logout error:",p),!_e&&Ue&&await Cr(Ue),localStorage.removeItem("test_user_session"),localStorage.removeItem("wechat_user"),n(null)}},[Ue,o]),g={user:t,initializing:r,authDisabled:_e,signInAnonymously:l,signInWithWeChatPopup:c,signInWithWeChatUser:u,handleWeChatCallback:d,signOut:m};return i.jsx(hi.Provider,{value:g,children:e})}function gi(){const e=h.useContext(hi);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function ef(){const{user:e,signOut:t,authDisabled:n}=gi();return i.jsxs("div",{className:"container py-3",children:[i.jsxs("h1",{className:"h4 mb-3",children:["Welcome ",(e==null?void 0:e.displayName)||"User"]}),i.jsx("p",{className:"text-secondary small mb-4",children:"This is a mobile-first boilerplate."}),n&&i.jsx("div",{className:"alert alert-warning p-2 small",role:"alert",children:"Firebase auth disabled (placeholder config). Add real env values to enable."}),i.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:t,children:"Sign out"})]})}const Br="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='512'%20height='512'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='1.2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='9'%20cy='10'%20r='1'/%3e%3ccircle%20cx='15'%20cy='10'%20r='1'/%3e%3cpath%20d='M5%2015c-1.143-1.012-2-2.547-2-4.25C3%207.798%205.91%205%209.5%205s6.5%202.798%206.5%205.75S13.09%2016.5%209.5%2016.5c-.517%200-1.02-.057-1.5-.165L5%2018l.8-2.4'/%3e%3cpath%20d='M16.5%208.5c2.485%200%204.5%201.79%204.5%204s-2.015%204-4.5%204c-.275%200-.544-.02-.805-.06L14%2018l.6-1.8'/%3e%3c/svg%3e";function tf(){const{signInWithWeChatPopup:e,signInAnonymously:t}=gi();return i.jsxs("div",{className:"container py-5",children:[i.jsx("h1",{className:"h5 mb-4 text-center",children:"Sign In"}),i.jsxs("div",{className:"d-grid gap-3",children:[i.jsxs("button",{className:"btn btn-success d-flex align-items-center justify-content-center gap-2",onClick:e,children:[i.jsx("img",{src:Br,alt:"WeChat",style:{width:20,height:20}}),i.jsx("span",{children:"Continue with WeChat"})]}),i.jsx("button",{className:"btn btn-outline-secondary",onClick:t,children:"Continue as Guest"})]})]})}const nf="https://us-central1-homefoods-16e56.cloudfunctions.net/exchangeWeChatCode",rf=()=>{const[e,t]=h.useState("loading"),[n,r]=h.useState(null),{handleWeChatCallback:a}=h.useContext(hi),s=St();return h.useEffect(()=>{(async()=>{const o=new URLSearchParams(window.location.search),l=o.get("code");console.log("code",l);const c=o.get("state");if(!l){alert("missing code"),t("error"),r({error:"missing_code"});return}try{const d=await fetch(nf,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:l}),credentials:"omit"}),u=await d.json();if(!d.ok||u.error){t("error"),r({error:u.error||`http_${d.status}`});return}t("ok"),u.firebaseImageUrl=c,r(u),a(u);const m=JSON.stringify(localStorage.getItem("page"));if(m.isDetailPage){s(m.detailPageUrl,{replace:!0});return}s("/checkout?"+new URLSearchParams({firebaseImageUrl:c}),{replace:!0})}catch(d){t("error"),r({error:(d==null?void 0:d.message)||"network_error"})}})()},[]),e==="loading"?i.jsx("p",{children:"Exchanging code…"}):e==="error"?i.jsxs("pre",{children:["Error: ",JSON.stringify(n,null,2)]}):i.jsxs("div",{children:[i.jsx("h2",{children:"WeChat login success"}),i.jsx("pre",{style:{fontSize:12,background:"#f6f6f6",padding:12},children:JSON.stringify(n,null,2)})]})};class Hn{constructor(){this.domain="homefreshfoods.ai",this.appId="wx4a71fe09bb125182",this.redirectUri=`https://${this.domain}/wechat/callback`,this.results={timestamp:new Date().toISOString(),domain:this.domain,appId:this.appId,tests:{}}}async runAllTests(){console.log("🔍 Starting WeChat diagnostics...");try{this.results.tests.domainAccess=await this.testDomainAccess(),this.results.tests.verificationFile=await this.testVerificationFile(),this.results.tests.sslCertificate=await this.testSSLCertificate(),this.results.tests.redirectAccess=await this.testRedirectAccess(),this.results.tests.authUrl=this.generateAuthUrl();const t=Object.values(this.results.tests).filter(r=>r.success).length,n=Object.keys(this.results.tests).length-1;return this.results.overall={success:t===n,score:`${t}/${n}`,message:t===n?"All tests passed!":"Some tests failed - check WeChat Console configuration"},console.log("✅ Diagnostics complete:",this.results),this.results}catch(t){return console.error("❌ Diagnostics failed:",t),this.results.error=t.message,this.results}}async testDomainAccess(){const t={name:"Domain Access",success:!1,message:"",url:`https://${this.domain}/`};try{const n=new AbortController,r=setTimeout(()=>n.abort(),1e4),a=await fetch(t.url,{method:"HEAD",signal:n.signal});clearTimeout(r),a.ok?(t.success=!0,t.message=`Domain ${this.domain} is accessible`,t.status=a.status):(t.message=`HTTP ${a.status}: ${a.statusText}`,t.status=a.status)}catch(n){t.message=`Connection failed: ${n.message}`,t.error=n.name}return t}async testVerificationFile(){const t={name:"Verification File",success:!1,message:"",checkedFiles:[]},n=["MP_verify_placeholder.txt",`MP_verify_${this.appId}.txt`,"MP_verify_wx4a71fe09bb125182.txt"];for(const r of n){const a=`https://${this.domain}/${r}`;t.checkedFiles.push(r);try{const s=await fetch(a);if(s.ok){const o=await s.text();t.success=!0,t.message=`Found verification file: ${r}`,t.filename=r,t.content=o.substring(0,100),t.url=a;break}}catch(s){}}return t.success||(t.message="No verification file found. Upload MP_verify_*.txt from WeChat Console",t.recommendation="Download verification file from WeChat Developer Console and upload to website root"),t}async testSSLCertificate(){const t={name:"SSL Certificate",success:!1,message:"",url:`https://${this.domain}/`};try{const n=await fetch(t.url,{method:"HEAD"});n.ok?(t.success=!0,t.message="Valid HTTPS connection established",t.protocol="HTTPS"):(t.message=`HTTPS connection established but got HTTP ${n.status}`,t.protocol="HTTPS",t.status=n.status)}catch(n){t.message=`SSL/HTTPS error: ${n.message}`,t.error=n.name}return t}async testRedirectAccess(){const t={name:"Redirect URI Access",success:!1,message:"",url:this.redirectUri};try{const n=await fetch(this.redirectUri,{method:"HEAD"});n.ok||n.status===404||n.status===405?(t.success=!0,t.message=`Redirect URI is accessible (HTTP ${n.status})`,t.status=n.status):(t.message=`Redirect URI returned HTTP ${n.status}`,t.status=n.status)}catch(n){t.message=`Redirect URI test failed: ${n.message}`,t.error=n.name}return t}generateAuthUrl(t=null){const n=t||`test_${Math.random().toString(36).substring(7)}`,a=`https://open.weixin.qq.com/connect/oauth2/authorize?${new URLSearchParams({appid:this.appId,redirect_uri:this.redirectUri,response_type:"code",scope:"snsapi_base",state:n}).toString()}#wechat_redirect`;return{name:"Auth URL Generation",success:!0,message:"WeChat OAuth URL generated successfully",url:a,state:n,qrCodeUrl:`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(a)}`}}getWeChatConsoleChecklist(){return{title:"WeChat Developer Console Checklist",url:"https://developers.weixin.qq.com/",steps:[{step:1,action:"Login to WeChat Developer Console",url:"https://developers.weixin.qq.com/",status:"manual"},{step:2,action:"Navigate to Development Configuration (开发配置) tab",description:"Click on the Development Configuration tab in your app dashboard",status:"manual"},{step:3,action:"Find Web Authorization Domain (网页授权域名) section",description:"Look for the Web Authorization Domain configuration area",status:"critical"},{step:4,action:`Verify ${this.domain} is listed and verified`,description:`Ensure ${this.domain} appears in the authorized domains list with verified status`,status:"critical"},{step:5,action:"Check verification file accessibility",description:`Ensure MP_verify_*.txt file is uploaded and accessible at https://${this.domain}/MP_verify_*.txt`,status:"critical"},{step:6,action:'Verify domain status is "Verified" or "Active"',description:"Domain status should show as verified, not pending",status:"critical"}],commonIssues:[`Domain ${this.domain} not added to Web Authorization Domain list`,"Verification file missing or inaccessible","Domain added but not verified (still pending)","Wrong verification file uploaded","HTTPS not properly configured"]}}generateReport(){var n,r,a;const t={...this.results,checklist:this.getWeChatConsoleChecklist(),recommendations:[],nextSteps:[]};return(n=this.results.tests.domainAccess)!=null&&n.success||(t.recommendations.push("Fix domain accessibility issues"),t.nextSteps.push("Check DNS configuration and hosting setup")),(r=this.results.tests.verificationFile)!=null&&r.success||(t.recommendations.push("Upload WeChat verification file"),t.nextSteps.push("Download MP_verify_*.txt from WeChat Console and upload to website root")),(a=this.results.tests.sslCertificate)!=null&&a.success||(t.recommendations.push("Fix SSL certificate issues"),t.nextSteps.push("Ensure HTTPS is properly configured for the domain")),t.recommendations.length===0&&(t.recommendations.push("All technical tests passed - check WeChat Console configuration"),t.nextSteps.push("Verify domain is added to Web Authorization Domain list in WeChat Console")),t}}const jo=async()=>await new Hn().runAllTests(),Ro=async()=>{const e=new Hn;await e.runAllTests();const t=e.generateReport();return console.group("🔍 WeChat Domain Verification Report"),console.log("Overall Status:",t.overall),console.log("Test Results:",t.tests),console.log("Recommendations:",t.recommendations),console.log("Next Steps:",t.nextSteps),console.groupEnd(),t};typeof window!="undefined"&&(window.WeChatDiagnostics=Hn,window.runWeChatDiagnostics=jo,window.checkWeChatDomain=Ro);const af=({isVisible:e=!1,onClose:t=()=>{},autoRun:n=!1})=>{var g,p,y,b;const[r,a]=h.useState(null),[s,o]=h.useState(!1),[l,c]=h.useState(null);h.useEffect(()=>{n&&e&&d()},[n,e]);const d=async()=>{o(!0);try{const f=new Hn,k=await f.runAllTests(),A=f.generateReport();a(k),c(A)}catch(f){console.error("Diagnostic error:",f),a({error:f.message})}finally{o(!1)}},u=f=>f?"✅":"❌",m=f=>f?"#4CAF50":"#F44336";return e?i.jsx("div",{style:ue.overlay,children:i.jsxs("div",{style:ue.panel,children:[i.jsxs("div",{style:ue.header,children:[i.jsx("h2",{children:"WeChat Diagnostics"}),i.jsx("button",{onClick:t,style:ue.closeButton,children:"×"})]}),i.jsx("div",{style:ue.actions,children:i.jsx("button",{onClick:d,disabled:s,style:ue.runButton,children:s?"Running Tests...":"Run Diagnostics"})}),s&&i.jsxs("div",{style:ue.loading,children:[i.jsx("div",{style:ue.spinner}),i.jsx("p",{children:"Running WeChat diagnostic tests..."})]}),r&&!s&&i.jsx("div",{style:ue.results,children:r.error?i.jsxs("div",{style:ue.error,children:[i.jsx("h3",{children:"Error"}),i.jsx("p",{children:r.error})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:ue.overall,children:[i.jsxs("h3",{children:["Overall Status: ",u((g=r.overall)==null?void 0:g.success)]}),i.jsx("p",{style:{color:m((p=r.overall)==null?void 0:p.success)},children:(y=r.overall)==null?void 0:y.message}),i.jsxs("p",{children:["Score: ",(b=r.overall)==null?void 0:b.score]})]}),i.jsxs("div",{style:ue.tests,children:[i.jsx("h3",{children:"Test Results"}),Object.entries(r.tests).map(([f,k])=>i.jsxs("div",{style:ue.testItem,children:[i.jsxs("div",{style:ue.testHeader,children:[i.jsx("span",{style:ue.testIcon,children:u(k.success)}),i.jsx("strong",{children:k.name})]}),i.jsx("p",{style:ue.testMessage,children:k.message}),k.url&&i.jsxs("p",{style:ue.testUrl,children:["URL:"," ",i.jsx("a",{href:k.url,target:"_blank",rel:"noopener noreferrer",children:k.url})]}),k.qrCodeUrl&&i.jsxs("div",{style:ue.qrCode,children:[i.jsx("p",{children:"QR Code for mobile testing:"}),i.jsx("img",{src:k.qrCodeUrl,alt:"WeChat Auth QR",style:ue.qrImage})]})]},f))]}),l&&i.jsxs("div",{style:ue.recommendations,children:[i.jsx("h3",{children:"Recommendations"}),l.recommendations.map((f,k)=>i.jsxs("div",{style:ue.recommendation,children:[i.jsx("span",{style:ue.bullet,children:"•"})," ",f]},k)),i.jsx("h3",{children:"Next Steps"}),l.nextSteps.map((f,k)=>i.jsxs("div",{style:ue.nextStep,children:[i.jsxs("span",{style:ue.stepNumber,children:[k+1,"."]})," ",f]},k))]}),i.jsxs("div",{style:ue.checklist,children:[i.jsx("h3",{children:"WeChat Console Checklist"}),i.jsx("p",{children:i.jsx("a",{href:"https://developers.weixin.qq.com/",target:"_blank",rel:"noopener noreferrer",style:ue.link,children:"Open WeChat Developer Console"})}),l==null?void 0:l.checklist.steps.map(f=>i.jsxs("div",{style:ue.checklistItem,children:[i.jsxs("span",{style:ue.stepNumber,children:[f.step,"."]}),i.jsx("span",{children:f.action}),f.status==="critical"&&i.jsx("span",{style:ue.critical,children:" (Critical)"})]},f.step))]})]})})]})}):null},ue={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e4,overflow:"auto"},panel:{backgroundColor:"white",margin:"20px auto",padding:"20px",maxWidth:"800px",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #eee",paddingBottom:"10px",marginBottom:"20px"},closeButton:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px"},actions:{marginBottom:"20px"},runButton:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},loading:{textAlign:"center",padding:"20px"},spinner:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 10px"},results:{marginTop:"20px"},overall:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"4px",marginBottom:"20px"},error:{backgroundColor:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"4px"},tests:{marginBottom:"20px"},testItem:{border:"1px solid #ddd",padding:"10px",marginBottom:"10px",borderRadius:"4px"},testHeader:{display:"flex",alignItems:"center",marginBottom:"5px"},testIcon:{marginRight:"8px"},testMessage:{margin:"5px 0",fontSize:"14px"},testUrl:{margin:"5px 0",fontSize:"12px",color:"#666"},qrCode:{textAlign:"center",marginTop:"10px"},qrImage:{maxWidth:"200px",height:"auto"},recommendations:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"20px"},recommendation:{display:"flex",alignItems:"flex-start",marginBottom:"5px"},bullet:{marginRight:"8px",color:"#856404"},nextStep:{display:"flex",alignItems:"flex-start",marginBottom:"5px"},stepNumber:{marginRight:"8px",color:"#856404",fontWeight:"bold"},checklist:{backgroundColor:"#e1f5fe",padding:"15px",borderRadius:"4px"},checklistItem:{display:"flex",alignItems:"flex-start",marginBottom:"8px"},critical:{color:"#d32f2f",fontWeight:"bold"},link:{color:"#1976d2",textDecoration:"none"}},sf=()=>{const[e,t]=h.useState(!1),[n,r]=h.useState(null),a=async()=>{console.log("🚀 Running quick WeChat test...");const c=await jo();r(c),console.log("✅ Quick test completed:",c)},s=async()=>{console.log("📊 Generating full WeChat report...");const c=await Ro();r(c),console.log("📋 Full report completed:",c)},o=()=>{window.open("https://developers.weixin.qq.com/","_blank")},l=()=>{window.open("/wechat-diagnosis.html","_blank")};return i.jsxs("div",{style:me.container,children:[i.jsxs("div",{style:me.header,children:[i.jsx("h1",{children:"WeChat Authentication Debug"}),i.jsx("p",{children:"Diagnostic tools for troubleshooting WeChat domain verification issues"})]}),i.jsxs("div",{style:me.section,children:[i.jsx("h2",{children:"Quick Actions"}),i.jsxs("div",{style:me.buttonGrid,children:[i.jsx("button",{onClick:a,style:me.button,children:"🔍 Run Quick Test"}),i.jsx("button",{onClick:s,style:me.button,children:"📊 Generate Full Report"}),i.jsx("button",{onClick:()=>t(!0),style:me.button,children:"🛠️ Open Diagnostic Panel"}),i.jsx("button",{onClick:l,style:me.button,children:"🌐 Open Web Diagnostic Tool"})]})]}),i.jsxs("div",{style:me.section,children:[i.jsx("h2",{children:"External Resources"}),i.jsxs("div",{style:me.buttonGrid,children:[i.jsx("button",{onClick:o,style:me.externalButton,children:"🏗️ WeChat Developer Console"}),i.jsx("a",{href:"https://homefreshfoods.ai/MP_verify_placeholder.txt",target:"_blank",rel:"noopener noreferrer",style:me.link,children:"📄 Check Verification File"})]})]}),i.jsxs("div",{style:me.section,children:[i.jsx("h2",{children:"Current Configuration"}),i.jsxs("div",{style:me.config,children:[i.jsxs("div",{style:me.configItem,children:[i.jsx("strong",{children:"Domain:"})," homefreshfoods.ai"]}),i.jsxs("div",{style:me.configItem,children:[i.jsx("strong",{children:"App ID:"})," wx4a71fe09bb125182"]}),i.jsxs("div",{style:me.configItem,children:[i.jsx("strong",{children:"Redirect URI:"})," ","https://homefreshfoods.ai/wechat/callback"]}),i.jsxs("div",{style:me.configItem,children:[i.jsx("strong",{children:"Environment:"})," Production"]})]})]}),n&&i.jsxs("div",{style:me.section,children:[i.jsx("h2",{children:"Latest Results"}),i.jsx("div",{style:me.results,children:i.jsx("pre",{style:me.pre,children:JSON.stringify(n,null,2)})})]}),i.jsxs("div",{style:me.section,children:[i.jsx("h2",{children:"Common Issues & Solutions"}),i.jsxs("div",{style:me.troubleshooting,children:[i.jsxs("div",{style:me.issue,children:[i.jsx("h3",{children:"Error 10003: Redirect URI Domain Mismatch"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Verify domain is added to Web Authorization Domain list"}),i.jsx("li",{children:"Ensure verification file is uploaded and accessible"}),i.jsx("li",{children:'Check domain status is "Verified" not "Pending"'}),i.jsx("li",{children:"Confirm no typos in domain name"})]})]}),i.jsxs("div",{style:me.issue,children:[i.jsx("h3",{children:"Verification File Not Found"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Download MP_verify_*.txt from WeChat Console"}),i.jsx("li",{children:"Upload to website root directory"}),i.jsx("li",{children:"Ensure file is accessible via HTTPS"}),i.jsx("li",{children:"Check file permissions and hosting configuration"})]})]}),i.jsxs("div",{style:me.issue,children:[i.jsx("h3",{children:"Domain Not Verified"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Upload correct verification file"}),i.jsx("li",{children:"Wait for WeChat verification process (can take minutes)"}),i.jsx("li",{children:"Try removing and re-adding domain"}),i.jsx("li",{children:"Ensure HTTPS is properly configured"})]})]})]})]}),i.jsx(af,{isVisible:e,onClose:()=>t(!1),autoRun:!0})]})},me={container:{maxWidth:"800px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif"},header:{textAlign:"center",marginBottom:"30px",paddingBottom:"20px",borderBottom:"2px solid #eee"},section:{marginBottom:"30px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px"},buttonGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",marginTop:"15px"},button:{padding:"12px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"16px",textAlign:"center"},externalButton:{padding:"12px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"16px",textAlign:"center"},link:{display:"inline-block",padding:"12px 20px",backgroundColor:"#6c757d",color:"white",textDecoration:"none",borderRadius:"6px",textAlign:"center"},config:{backgroundColor:"white",padding:"15px",borderRadius:"6px",border:"1px solid #ddd"},configItem:{padding:"8px 0",borderBottom:"1px solid #eee"},results:{backgroundColor:"white",padding:"15px",borderRadius:"6px",border:"1px solid #ddd",maxHeight:"400px",overflow:"auto"},pre:{margin:0,fontSize:"12px",lineHeight:"1.4"},troubleshooting:{backgroundColor:"white",padding:"15px",borderRadius:"6px",border:"1px solid #ddd"},issue:{marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid #eee"}},Co="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20width='1024'%20height='1024'%20viewBox='0%200%20500%20500'%3e%3crect%20x='0'%20y='0'%20width='500'%20height='500'%20fill='%23ffffff'/%3e%3cg%20transform='scale(18.519)'%3e%3cg%20transform='translate(1,1)'%3e%3cg%3e%3cg%20transform='translate(3.5,3.5)'%3e%3cpath%20fill-rule='evenodd'%20d='M-3.5%20-3.5L3.5%20-3.5L3.5%203.5L-3.5%203.5ZM-2.5%20-2.5L-2.5%202.5L2.5%202.5L2.5%20-2.5Z'%20fill='%23000000'/%3e%3cpath%20fill-rule='evenodd'%20d='M-1.5%20-1.5L1.5%20-1.5L1.5%201.5L-1.5%201.5Z'%20fill='%23000000'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%20transform='translate(21.5,3.5)'%3e%3cg%20transform='rotate(90)'%3e%3cpath%20fill-rule='evenodd'%20d='M-3.5%20-3.5L3.5%20-3.5L3.5%203.5L-3.5%203.5ZM-2.5%20-2.5L-2.5%202.5L2.5%202.5L2.5%20-2.5Z'%20fill='%23000000'/%3e%3cpath%20fill-rule='evenodd'%20d='M-1.5%20-1.5L1.5%20-1.5L1.5%201.5L-1.5%201.5Z'%20fill='%23000000'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%20transform='translate(3.5,21.5)'%3e%3cg%20transform='rotate(-90)'%3e%3cpath%20fill-rule='evenodd'%20d='M-3.5%20-3.5L3.5%20-3.5L3.5%203.5L-3.5%203.5ZM-2.5%20-2.5L-2.5%202.5L2.5%202.5L2.5%20-2.5Z'%20fill='%23000000'/%3e%3cpath%20fill-rule='evenodd'%20d='M-1.5%20-1.5L1.5%20-1.5L1.5%201.5L-1.5%201.5Z'%20fill='%23000000'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cpath%20fill-rule='evenodd'%20d='M9%200L9%202L8%202L8%208L10%208L10%209L9%209L9%2011L8%2011L8%2013L7%2013L7%2012L5%2012L5%2013L4%2013L4%2012L2%2012L2%2013L3%2013L3%2014L4%2014L4%2015L5%2015L5%2016L6%2016L6%2017L7%2017L7%2016L8%2016L8%2018L9%2018L9%2012L10%2012L10%2013L12%2013L12%2017L10%2017L10%2018L12%2018L12%2019L11%2019L11%2020L12%2020L12%2022L13%2022L13%2023L11%2023L11%2024L12%2024L12%2025L13%2025L13%2023L14%2023L14%2024L15%2024L15%2021L16%2021L16%2022L17%2022L17%2024L22%2024L22%2025L25%2025L25%2024L24%2024L24%2023L25%2023L25%2021L23%2021L23%2022L22%2022L22%2023L21%2023L21%2021L22%2021L22%2019L25%2019L25%2015L23%2015L23%2014L22%2014L22%2015L23%2015L23%2016L24%2016L24%2018L22%2018L22%2019L21%2019L21%2017L22%2017L22%2016L15%2016L15%2013L16%2013L16%2014L17%2014L17%2015L19%2015L19%2014L20%2014L20%2015L21%2015L21%2013L22%2013L22%2012L18%2012L18%2011L19%2011L19%2010L20%2010L20%2011L21%2011L21%209L23%209L23%208L18%208L18%209L17%209L17%2010L16%2010L16%208L17%208L17%206L16%206L16%204L17%204L17%202L16%202L16%201L17%201L17%200L16%200L16%201L15%201L15%200L14%200L14%201L13%201L13%200L12%200L12%202L16%202L16%203L14%203L14%205L13%205L13%203L9%203L9%202L11%202L11%201L10%201L10%200ZM9%204L9%207L10%207L10%208L12%208L12%209L13%209L13%2011L12%2011L12%2010L11%2010L11%2011L12%2011L12%2012L13%2012L13%2014L14%2014L14%2013L15%2013L15%2012L16%2012L16%2013L17%2013L17%2014L19%2014L19%2013L17%2013L17%2012L16%2012L16%2011L15%2011L15%2012L13%2012L13%2011L14%2011L14%209L13%209L13%207L14%207L14%208L16%208L16%206L15%206L15%205L14%205L14%206L13%206L13%205L12%205L12%204L11%204L11%207L10%207L10%204ZM12%206L12%207L13%207L13%206ZM14%206L14%207L15%207L15%206ZM0%208L0%209L1%209L1%2010L0%2010L0%2017L1%2017L1%2010L2%2010L2%2011L5%2011L5%2010L3%2010L3%209L7%209L7%2010L6%2010L6%2011L7%2011L7%2010L8%2010L8%209L7%209L7%208L2%208L2%209L1%209L1%208ZM18%209L18%2010L19%2010L19%209ZM24%209L24%2010L25%2010L25%209ZM22%2010L22%2011L23%2011L23%2010ZM23%2012L23%2013L24%2013L24%2014L25%2014L25%2012ZM5%2013L5%2015L6%2015L6%2016L7%2016L7%2015L8%2015L8%2014L7%2014L7%2013ZM6%2014L6%2015L7%2015L7%2014ZM10%2014L10%2016L11%2016L11%2014ZM2%2015L2%2017L3%2017L3%2015ZM13%2015L13%2016L14%2016L14%2015ZM12%2017L12%2018L13%2018L13%2019L12%2019L12%2020L14%2020L14%2021L13%2021L13%2022L14%2022L14%2021L15%2021L15%2020L16%2020L16%2017ZM17%2017L17%2020L20%2020L20%2017ZM14%2018L14%2019L15%2019L15%2018ZM18%2018L18%2019L19%2019L19%2018ZM8%2019L8%2023L9%2023L9%2024L8%2024L8%2025L10%2025L10%2022L11%2022L11%2021L10%2021L10%2022L9%2022L9%2020L10%2020L10%2019ZM17%2021L17%2022L19%2022L19%2023L20%2023L20%2021ZM23%2022L23%2023L22%2023L22%2024L23%2024L23%2023L24%2023L24%2022Z'%20fill='%23000000'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";var yn={exports:{}},of=yn.exports,pa;function lf(){return pa||(pa=1,(function(e,t){(function(n,r){e.exports=r()})(of,(function(){var n=1e3,r=6e4,a=36e5,s="millisecond",o="second",l="minute",c="hour",d="day",u="week",m="month",g="quarter",p="year",y="date",b="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(R){var w=["th","st","nd","rd"],P=R%100;return"["+R+(w[(P-20)%10]||w[P]||w[0])+"]"}},C=function(R,w,P){var F=String(R);return!F||F.length>=w?R:""+Array(w+1-F.length).join(P)+R},v={s:C,z:function(R){var w=-R.utcOffset(),P=Math.abs(w),F=Math.floor(P/60),I=P%60;return(w<=0?"+":"-")+C(F,2,"0")+":"+C(I,2,"0")},m:function R(w,P){if(w.date()<P.date())return-R(P,w);var F=12*(P.year()-w.year())+(P.month()-w.month()),I=w.clone().add(F,m),z=P-I<0,H=w.clone().add(F+(z?-1:1),m);return+(-(F+(P-I)/(z?I-H:H-I))||0)},a:function(R){return R<0?Math.ceil(R)||0:Math.floor(R)},p:function(R){return{M:m,y:p,w:u,d,D:y,h:c,m:l,s:o,ms:s,Q:g}[R]||String(R||"").toLowerCase().replace(/s$/,"")},u:function(R){return R===void 0}},x="en",S={};S[x]=A;var _="$isDayjsObject",j=function(R){return R instanceof B||!(!R||!R[_])},O=function R(w,P,F){var I;if(!w)return x;if(typeof w=="string"){var z=w.toLowerCase();S[z]&&(I=z),P&&(S[z]=P,I=z);var H=w.split("-");if(!I&&H.length>1)return R(H[0])}else{var V=w.name;S[V]=w,I=V}return!F&&I&&(x=I),I||!F&&x},E=function(R,w){if(j(R))return R.clone();var P=typeof w=="object"?w:{};return P.date=R,P.args=arguments,new B(P)},$=v;$.l=O,$.i=j,$.w=function(R,w){return E(R,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var B=(function(){function R(P){this.$L=O(P.locale,null,!0),this.parse(P),this.$x=this.$x||P.x||{},this[_]=!0}var w=R.prototype;return w.parse=function(P){this.$d=(function(F){var I=F.date,z=F.utc;if(I===null)return new Date(NaN);if($.u(I))return new Date;if(I instanceof Date)return new Date(I);if(typeof I=="string"&&!/Z$/i.test(I)){var H=I.match(f);if(H){var V=H[2]-1||0,ie=(H[7]||"0").substring(0,3);return z?new Date(Date.UTC(H[1],V,H[3]||1,H[4]||0,H[5]||0,H[6]||0,ie)):new Date(H[1],V,H[3]||1,H[4]||0,H[5]||0,H[6]||0,ie)}}return new Date(I)})(P),this.init()},w.init=function(){var P=this.$d;this.$y=P.getFullYear(),this.$M=P.getMonth(),this.$D=P.getDate(),this.$W=P.getDay(),this.$H=P.getHours(),this.$m=P.getMinutes(),this.$s=P.getSeconds(),this.$ms=P.getMilliseconds()},w.$utils=function(){return $},w.isValid=function(){return this.$d.toString()!==b},w.isSame=function(P,F){var I=E(P);return this.startOf(F)<=I&&I<=this.endOf(F)},w.isAfter=function(P,F){return E(P)<this.startOf(F)},w.isBefore=function(P,F){return this.endOf(F)<E(P)},w.$g=function(P,F,I){return $.u(P)?this[F]:this.set(I,P)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(P,F){var I=this,z=!!$.u(F)||F,H=$.p(P),V=function(T,q){var X=$.w(I.$u?Date.UTC(I.$y,q,T):new Date(I.$y,q,T),I);return z?X:X.endOf(d)},ie=function(T,q){return $.w(I.toDate()[T].apply(I.toDate("s"),(z?[0,0,0,0]:[23,59,59,999]).slice(q)),I)},Z=this.$W,ne=this.$M,oe=this.$D,fe="set"+(this.$u?"UTC":"");switch(H){case p:return z?V(1,0):V(31,11);case m:return z?V(1,ne):V(0,ne+1);case u:var Y=this.$locale().weekStart||0,G=(Z<Y?Z+7:Z)-Y;return V(z?oe-G:oe+(6-G),ne);case d:case y:return ie(fe+"Hours",0);case c:return ie(fe+"Minutes",1);case l:return ie(fe+"Seconds",2);case o:return ie(fe+"Milliseconds",3);default:return this.clone()}},w.endOf=function(P){return this.startOf(P,!1)},w.$set=function(P,F){var I,z=$.p(P),H="set"+(this.$u?"UTC":""),V=(I={},I[d]=H+"Date",I[y]=H+"Date",I[m]=H+"Month",I[p]=H+"FullYear",I[c]=H+"Hours",I[l]=H+"Minutes",I[o]=H+"Seconds",I[s]=H+"Milliseconds",I)[z],ie=z===d?this.$D+(F-this.$W):F;if(z===m||z===p){var Z=this.clone().set(y,1);Z.$d[V](ie),Z.init(),this.$d=Z.set(y,Math.min(this.$D,Z.daysInMonth())).$d}else V&&this.$d[V](ie);return this.init(),this},w.set=function(P,F){return this.clone().$set(P,F)},w.get=function(P){return this[$.p(P)]()},w.add=function(P,F){var I,z=this;P=Number(P);var H=$.p(F),V=function(ne){var oe=E(z);return $.w(oe.date(oe.date()+Math.round(ne*P)),z)};if(H===m)return this.set(m,this.$M+P);if(H===p)return this.set(p,this.$y+P);if(H===d)return V(1);if(H===u)return V(7);var ie=(I={},I[l]=r,I[c]=a,I[o]=n,I)[H]||1,Z=this.$d.getTime()+P*ie;return $.w(Z,this)},w.subtract=function(P,F){return this.add(-1*P,F)},w.format=function(P){var F=this,I=this.$locale();if(!this.isValid())return I.invalidDate||b;var z=P||"YYYY-MM-DDTHH:mm:ssZ",H=$.z(this),V=this.$H,ie=this.$m,Z=this.$M,ne=I.weekdays,oe=I.months,fe=I.meridiem,Y=function(q,X,ee,M){return q&&(q[X]||q(F,z))||ee[X].slice(0,M)},G=function(q){return $.s(V%12||12,q,"0")},T=fe||function(q,X,ee){var M=q<12?"AM":"PM";return ee?M.toLowerCase():M};return z.replace(k,(function(q,X){return X||(function(ee){switch(ee){case"YY":return String(F.$y).slice(-2);case"YYYY":return $.s(F.$y,4,"0");case"M":return Z+1;case"MM":return $.s(Z+1,2,"0");case"MMM":return Y(I.monthsShort,Z,oe,3);case"MMMM":return Y(oe,Z);case"D":return F.$D;case"DD":return $.s(F.$D,2,"0");case"d":return String(F.$W);case"dd":return Y(I.weekdaysMin,F.$W,ne,2);case"ddd":return Y(I.weekdaysShort,F.$W,ne,3);case"dddd":return ne[F.$W];case"H":return String(V);case"HH":return $.s(V,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return T(V,ie,!0);case"A":return T(V,ie,!1);case"m":return String(ie);case"mm":return $.s(ie,2,"0");case"s":return String(F.$s);case"ss":return $.s(F.$s,2,"0");case"SSS":return $.s(F.$ms,3,"0");case"Z":return H}return null})(q)||H.replace(":","")}))},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(P,F,I){var z,H=this,V=$.p(F),ie=E(P),Z=(ie.utcOffset()-this.utcOffset())*r,ne=this-ie,oe=function(){return $.m(H,ie)};switch(V){case p:z=oe()/12;break;case m:z=oe();break;case g:z=oe()/3;break;case u:z=(ne-Z)/6048e5;break;case d:z=(ne-Z)/864e5;break;case c:z=ne/a;break;case l:z=ne/r;break;case o:z=ne/n;break;default:z=ne}return I?z:$.a(z)},w.daysInMonth=function(){return this.endOf(m).$D},w.$locale=function(){return S[this.$L]},w.locale=function(P,F){if(!P)return this.$L;var I=this.clone(),z=O(P,F,!0);return z&&(I.$L=z),I},w.clone=function(){return $.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},R})(),W=B.prototype;return E.prototype=W,[["$ms",s],["$s",o],["$m",l],["$H",c],["$W",d],["$M",m],["$y",p],["$D",y]].forEach((function(R){W[R[1]]=function(w){return this.$g(w,R[0],R[1])}})),E.extend=function(R,w){return R.$i||(R(w,B,E),R.$i=!0),E},E.locale=O,E.isDayjs=j,E.unix=function(R){return E(1e3*R)},E.en=S[x],E.Ls=S,E.p={},E}))})(yn)),yn.exports}var cf=lf();const Q=gt(cf),At=()=>{const e=it(),t=Se(o=>o.cart.items),n=h.useCallback((o,l,c=null,d=99,u=null)=>{var p,y;debugger;if(!u)return;if(!o)return{isAvailable:!1,maxAvailable:0,orderType:c?"PRE_ORDER":"GO_GRAB",message:"Food item not found",warning:null,actualCheckingDate:c};const m=Q().startOf("day"),g=((p=o.availability)==null?void 0:p.numAvailable)||o.numAvailable||0;if(g>0&&u==="GO_GRAB")return{isAvailable:!0,maxAvailable:Math.min(g,d),orderType:"GO_GRAB",message:null,warning:g<5?`Only ${g} left`:null,actualCheckingDate:null};if(c&&u==="PRE_ORDER"){if(Q(c).startOf("day").isBefore(m))return g>0?{isAvailable:!0,maxAvailable:Math.min(g,d),orderType:"GO_GRAB",message:null,warning:g<5?`Only ${g} left`:null,actualCheckingDate:null}:{isAvailable:!1,maxAvailable:0,orderType:"GO_GRAB",message:"Sold Out",warning:null,actualCheckingDate:null};const f="PRE_ORDER";if(!((y=l==null?void 0:l.preorderSchedule)!=null&&y.dates))return{isAvailable:!1,maxAvailable:0,orderType:f,message:"Pre-orders not available for this kitchen",warning:null,actualCheckingDate:c};const k=c.includes("-")?c:Q(c).format("YYYY-MM-DD"),A=l.preorderSchedule.dates[k];if(!A||!Array.isArray(A))return{isAvailable:!1,maxAvailable:0,orderType:f,message:"Not available for pre-order on selected date",warning:null,actualCheckingDate:c};const C=A.find(v=>v.foodItemId===o.id);if(!C)return{isAvailable:!1,maxAvailable:0,orderType:f,message:"This item is not available for pre-order on selected date",warning:null,actualCheckingDate:c};if(C.isLimitedOrder===!1){const v=C.numOfAvailableItems||0;return{isAvailable:v>0,maxAvailable:Math.min(v,d),orderType:f,message:v<=0?"Sold Out":null,warning:v<5&&v>0?`Only ${v} left`:null,actualCheckingDate:c}}else return{isAvailable:!0,maxAvailable:d,orderType:f,message:null,warning:null,actualCheckingDate:c}}return{isAvailable:!1,maxAvailable:0,orderType:"GO_GRAB",message:"Sold Out",warning:null,actualCheckingDate:null}},[]),r=h.useCallback((o,l=null,c=null)=>{if(!o||!t||t.length===0)return 0;console.log("orderType getCartQuantity",c);const u=t.filter(m=>{console.log("item getCartQuantity",m);const g=String(m.foodId)===String(o)&&m.orderType===c,p=m.orderType==="GO_GRAB"||m.orderType==="Go&Grab"||m.orderType==="Go & Grab"||!m.orderType;let y;return p?y=!0:l?y=m.selectedDate===l:y=!m.selectedDate,g&&y}).reduce((m,g)=>m+(g.quantity||1),0);return console.log("totalQuantity",u),u},[t]),a=h.useCallback(({food:o,kitchen:l,newQuantity:c,selectedDate:d=null,selectedTime:u=null,specialInstructions:m="",incomingOrderType:g})=>{debugger;console.log("🔥 handleQuantityChange called with:",g);try{console.log("selectedDate",d),console.log("selectedTime",u);debugger;const p=n(o,l,d,99,g);if(!p){console.log("🔥 Missing availability data");return}const y=p.orderType,b=y==="GO_GRAB"||y==="Go&Grab"||y==="Go & Grab",f=t.find(k=>{const A=String(k.foodId)===String(o.id)&&k.orderType===y,C=k.orderType==="GO_GRAB"||k.orderType==="Go&Grab"||k.orderType==="Go & Grab"||!k.orderType;let v;b&&C?v=!0:!b&&!C?v=k.selectedDate===d:v=!1;const x=(k.specialInstructions||"")===(m||"");return A&&(b?C:!C)&&v&&x});if(c===0){f&&e(Nm(f.id));return}if(f){const k={cartItemId:f.id,quantity:c,specialInstructions:m};b?(console.log("updatedData",k),k.selectedDate=d,k.selectedTime=u,k.orderType="GO_GRAB"):(console.log("updatedData",k),k.selectedDate=d,k.selectedTime=u,k.orderType="PRE_ORDER"),console.log("Updating cart item with data:",k),e(qr(k))}else{const k={foodId:o.id,food:{id:o.id,name:o.name,cost:o.cost,imageUrl:o.imageUrl,description:o.description},kitchen:{id:l.id,name:l.name},kitchenId:l.id,quantity:c,selectedDate:d,selectedTime:u,specialInstructions:m,isPreOrder:y==="PRE_ORDER",orderType:y};console.log("Adding new cart item:",k),console.log("orderType",y),e(go(k))}}catch(p){console.error("❌ Error updating cart:",p)}},[e,t,n]),s=o=>{console.log("🔍 Validating cart selections for",o.length,"items");let l=!1;return o.forEach((c,d)=>{var g;const u=c.name||((g=c.food)==null?void 0:g.name)||"Unknown Item",m=c.orderType==="PRE_ORDER"?"Pre-Order":"Go & Grab";if(console.log(`📦 Checking item ${d+1}: ${u} (${m})`),c.orderType==="PRE_ORDER"||c.isPreOrder){if(!c.selectedDate){const p=`Please select a pickup date for "${u}" (${m})`;alert(p),l=!0,console.warn("⚠️ Missing date:",p)}if(!c.selectedTime){const p=`Please select a pickup time for "${u}" (${m})`;alert(p),l=!0,console.warn("⚠️ Missing time:",p)}}else if(c.orderType==="GO_GRAB"||c.orderType==="Go&Grab"){if(!c.selectedDate){const p=`Please select a pickup date for "${u}" (${m})`;alert(p),l=!0,console.warn("⚠️ Missing date:",p)}if(!c.selectedTime){const p=`Please select a pickup time for "${u}" (${m})`;alert(p),l=!0,console.warn("⚠️ Missing time:",p)}}}),console.log("✅ All cart items validated successfully"),{isValid:!l,errors:[],message:"All selections are valid"}};return{cartItems:t,getCartQuantity:r,handleQuantityChange:a,validateCartSelections:()=>s(t),calculateAvailability:n}},Yt=({food:e=null,kitchen:t=null,selectedDate:n,maxQuantity:r=99,minQuantity:a=1,onAvailabilityChange:s=()=>{},onError:o=()=>{},onWarning:l=()=>{},size:c="medium",className:d="",disabled:u=!1,orderType:m,selectedTime:g})=>{console.log("selectedDate in QuantitySelector:",n);const{calculateAvailability:p,getCartQuantity:y,handleQuantityChange:b}=At(),[f,k]=h.useState(!1),[A,C]=h.useState({title:"",body:""}),v=h.useMemo(()=>e!=null&&e.id?y(e.id,n,m):0,[e==null?void 0:e.id,n,y]);console.log("cartQuantity",v);const x=h.useMemo(()=>p(e,t,n,r,m),[p,e,t,n,r,m]),S=h.useCallback(E=>{if(E<0){o("Quantity cannot be negative");return}if(E>x.maxAvailable){x.maxAvailable===0?alert("♡ this food to the chef that we want it! When it is added to Go&Grab or Pre-Order, you will be notified."):alert(`Currently only ${x.maxAvailable} items are available.`),o(`Maximum available quantity is ${x.maxAvailable}`);return}if(!e||!t){console.log("🔥 Missing food or kitchen data"),o("Missing food or kitchen information");return}console.log("🔥 Calling useGenericCart food:",{food:e}),console.log("newQuantity:",E),console.log("orderType:",m),b({food:e,kitchen:t,newQuantity:E,currentQuantity:v,selectedDate:n,selectedTime:g,specialInstructions:"",incomingOrderType:m})},[v,x==null?void 0:x.maxAvailable,x==null?void 0:x.orderType,o,e,t,n,b,m]);h.useEffect(()=>{s(x),x&&(x!=null&&x.warning)&&l(x.warning),x!=null&&x.message&&(x!=null&&x.isAvailable)},[x,s,l,o]);const _=h.useCallback(()=>{if(console.log("🔥 INCREMENT CLICKED!",{disabled:u,isAvailable:x.isAvailable,currentCartQuantity:v,maxAvailable:x.maxAvailable}),u||!x.isAvailable){alert("♡ this food to the chef that we want it! When it is added to Go&Grab or Pre-Order, you will be notified."),console.log("🔥 INCREMENT BLOCKED: Item not available");return}const E=v+1;if(E>x.maxAvailable){console.log("🔥 INCREMENT BLOCKED: At maximum quantity"),x.maxAvailable===0?alert("♡ this food to the chef that we want it! When it is added to Go&Grab or Pre-Order, you will be notified."):alert(`Currently only ${x.maxAvailable} items are available.`);return}console.log("🔥 INCREMENT: Calling handleQuantityChange with:",E),S(E)},[u,x==null?void 0:x.isAvailable,x==null?void 0:x.maxAvailable,v,S]),j=h.useCallback(()=>{if(console.log("🔥 DECREMENT CLICKED!",{disabled:u,currentCartQuantity:v,minQuantity:a}),u){console.log("🔥 DECREMENT BLOCKED: Component disabled");return}const E=v-1;if(E<0){console.log("🔥 DECREMENT BLOCKED: Cannot go below 0");return}console.log("🔥 DECREMENT: Calling handleQuantityChange with:",E),S(E)},[u,v,S,a]),O=["quantity-selector",`quantity-selector--${c}`,d,u&&"quantity-selector--disabled",!(x!=null&&x.isAvailable)&&"quantity-selector--unavailable"].filter(Boolean).join(" ");return console.log("getCartQuantity",y),i.jsxs("div",{className:O,children:[f&&i.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:i.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:A.title}),i.jsx("button",{className:"modal-close",onClick:()=>k(!1),children:"×"})]}),i.jsxs("div",{className:"modal-body",children:[i.jsx("p",{children:A.body}),i.jsx("button",{onClick:()=>k(!1),children:"OK"})]})]})}),i.jsxs("div",{className:"quantity-selector__controls",children:[i.jsx("div",{className:"quantity-selector__display",children:i.jsx("span",{className:"quantity-number",children:v})}),i.jsxs("div",{className:"quantity-selector__buttons",children:[i.jsx("button",{type:"button",className:"quantity-btn quantity-btn--decrement",onClick:j,disabled:u||v<=0,"aria-label":"Decrease quantity",children:i.jsx("svg",{width:"13",height:"2",viewBox:"0 0 13 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("rect",{x:"0.887695",width:"11.6854",height:"1.46067",fill:"currentColor"})})}),i.jsx("button",{type:"button",className:"quantity-btn quantity-btn--increment",onClick:_,"aria-label":"Increase quantity",children:i.jsxs("svg",{width:"13",height:"12",viewBox:"0 0 13 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("path",{d:"M0.707673 5.27007H12.3931V6.73075H0.707673V5.27007Z",fill:"currentColor"}),i.jsx("path",{d:"M7.28071 0.157715L7.28071 11.8431H5.82003L5.82003 0.157715L7.28071 0.157715Z",fill:"currentColor"})]})})]})]})]})};var bn={exports:{}},df=bn.exports,ma;function uf(){return ma||(ma=1,(function(e,t){(function(n,r){e.exports=r()})(df,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d/,s=/\d\d/,o=/\d\d?/,l=/\d*[^-_:/,()\s\d]+/,c={},d=function(f){return(f=+f)+(f>68?1900:2e3)},u=function(f){return function(k){this[f]=+k}},m=[/[+-]\d\d:?(\d\d)?|Z/,function(f){(this.zone||(this.zone={})).offset=(function(k){if(!k||k==="Z")return 0;var A=k.match(/([+-]|\d\d)/g),C=60*A[1]+(+A[2]||0);return C===0?0:A[0]==="+"?-C:C})(f)}],g=function(f){var k=c[f];return k&&(k.indexOf?k:k.s.concat(k.f))},p=function(f,k){var A,C=c.meridiem;if(C){for(var v=1;v<=24;v+=1)if(f.indexOf(C(v,0,k))>-1){A=v>12;break}}else A=f===(k?"pm":"PM");return A},y={A:[l,function(f){this.afternoon=p(f,!1)}],a:[l,function(f){this.afternoon=p(f,!0)}],Q:[a,function(f){this.month=3*(f-1)+1}],S:[a,function(f){this.milliseconds=100*+f}],SS:[s,function(f){this.milliseconds=10*+f}],SSS:[/\d{3}/,function(f){this.milliseconds=+f}],s:[o,u("seconds")],ss:[o,u("seconds")],m:[o,u("minutes")],mm:[o,u("minutes")],H:[o,u("hours")],h:[o,u("hours")],HH:[o,u("hours")],hh:[o,u("hours")],D:[o,u("day")],DD:[s,u("day")],Do:[l,function(f){var k=c.ordinal,A=f.match(/\d+/);if(this.day=A[0],k)for(var C=1;C<=31;C+=1)k(C).replace(/\[|\]/g,"")===f&&(this.day=C)}],w:[o,u("week")],ww:[s,u("week")],M:[o,u("month")],MM:[s,u("month")],MMM:[l,function(f){var k=g("months"),A=(g("monthsShort")||k.map((function(C){return C.slice(0,3)}))).indexOf(f)+1;if(A<1)throw new Error;this.month=A%12||A}],MMMM:[l,function(f){var k=g("months").indexOf(f)+1;if(k<1)throw new Error;this.month=k%12||k}],Y:[/[+-]?\d+/,u("year")],YY:[s,function(f){this.year=d(f)}],YYYY:[/\d{4}/,u("year")],Z:m,ZZ:m};function b(f){var k,A;k=f,A=c&&c.formats;for(var C=(f=k.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(E,$,B){var W=B&&B.toUpperCase();return $||A[B]||n[B]||A[W].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(R,w,P){return w||P.slice(1)}))}))).match(r),v=C.length,x=0;x<v;x+=1){var S=C[x],_=y[S],j=_&&_[0],O=_&&_[1];C[x]=O?{regex:j,parser:O}:S.replace(/^\[|\]$/g,"")}return function(E){for(var $={},B=0,W=0;B<v;B+=1){var R=C[B];if(typeof R=="string")W+=R.length;else{var w=R.regex,P=R.parser,F=E.slice(W),I=w.exec(F)[0];P.call($,I),E=E.replace(I,"")}}return(function(z){var H=z.afternoon;if(H!==void 0){var V=z.hours;H?V<12&&(z.hours+=12):V===12&&(z.hours=0),delete z.afternoon}})($),$}}return function(f,k,A){A.p.customParseFormat=!0,f&&f.parseTwoDigitYear&&(d=f.parseTwoDigitYear);var C=k.prototype,v=C.parse;C.parse=function(x){var S=x.date,_=x.utc,j=x.args;this.$u=_;var O=j[1];if(typeof O=="string"){var E=j[2]===!0,$=j[3]===!0,B=E||$,W=j[2];$&&(W=j[2]),c=this.$locale(),!E&&W&&(c=A.Ls[W]),this.$d=(function(F,I,z,H){try{if(["x","X"].indexOf(I)>-1)return new Date((I==="X"?1e3:1)*F);var V=b(I)(F),ie=V.year,Z=V.month,ne=V.day,oe=V.hours,fe=V.minutes,Y=V.seconds,G=V.milliseconds,T=V.zone,q=V.week,X=new Date,ee=ne||(ie||Z?1:X.getDate()),M=ie||X.getFullYear(),L=0;ie&&!Z||(L=Z>0?Z-1:X.getMonth());var D,N=oe||0,J=fe||0,ae=Y||0,te=G||0;return T?new Date(Date.UTC(M,L,ee,N,J,ae,te+60*T.offset*1e3)):z?new Date(Date.UTC(M,L,ee,N,J,ae,te)):(D=new Date(M,L,ee,N,J,ae,te),q&&(D=H(D).week(q).toDate()),D)}catch(ce){return new Date("")}})(S,O,_,A),this.init(),W&&W!==!0&&(this.$L=this.locale(W).$L),B&&S!=this.format(O)&&(this.$d=new Date("")),c={}}else if(O instanceof Array)for(var R=O.length,w=1;w<=R;w+=1){j[1]=O[w-1];var P=A.apply(this,j);if(P.isValid()){this.$d=P.$d,this.$L=P.$L,this.init();break}w===R&&(this.$d=new Date(""))}else v.call(this,x)}}}))})(bn)),bn.exports}var pf=uf();const mf=gt(pf);Q.extend(mf);const ff=e=>{if(!e)return null;const t=e.replace(/[\u00A0\u202F\u2007]/g," ").replace(/\s+/g," ").trim();let n=t.match(/^(\d{1,2}):([0-5]\d)\s*([AaPp][Mm])$/);if(n){let r=parseInt(n[1],10);const a=parseInt(n[2],10),s=n[3].toLowerCase();return r===12&&(r=0),s==="pm"&&(r+=12),r>=0&&r<=23?{h:r,min:a}:null}return n=t.match(/^([01]?\d|2[0-3]):([0-5]\d)$/),n?{h:parseInt(n[1],10),min:parseInt(n[2],10)}:null},In=({food:e,kitchen:t,orderType:n="GO_GRAB",selectedDate:r=null,selectedTime:a=null,onDateChange:s=()=>{},onTimeChange:o=()=>{},disabled:l=!1,showTimeFirst:c=!1,className:d="",dateLabel:u="Pick up date:",timeLabel:m="Pick up time:",style:g={}})=>{var ne,oe,fe;const[p,y]=h.useState(r),[b,f]=h.useState(a),[k,A]=h.useState(!1),[C,v]=h.useState(Q()),x=h.useRef(null),S=h.useRef(r),_=h.useRef(a),j=h.useRef(n),O=h.useRef(e==null?void 0:e.id),E=h.useRef(t==null?void 0:t.id),$=h.useRef(!1),B=h.useRef(!1),W=h.useMemo(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[]),{getCartQuantity:R,handleQuantityChange:w}=At(),P=h.useMemo(()=>e!=null&&e.id?R(e.id,r,n):0,[e==null?void 0:e.id,r,R]),F=h.useMemo(()=>{const Y=Q().startOf("day");if(n==="GO_GRAB"){const G=[];for(let T=0;T<60;T++){const q=Y.add(T,"day"),X=q.format("YYYY-MM-DD");let ee;T===0?ee=`${q.format("MMM D, YYYY")}`:T===1?ee=`${q.format("MMM D, YYYY")}`:ee=`${q.format("dddd")}, ${q.format("MMM D, YYYY")}`,G.push({date:X,display:ee,dayjs:q,isToday:T===0,isAvailable:!0})}return G}else if(n==="PRE_ORDER"){if(!r)return console.log("🚫 DateTimePicker - No selectedDate provided for PRE_ORDER"),[];const G=Q(r),T=G.isSame(Y,"day"),q=G.isSame(Y.add(1,"day"),"day");let X;return T?X=`${G.format("MMM D, YYYY")}`:q?X=`${G.format("MMM D, YYYY")}`:X=`${G.format("dddd")}, ${G.format("MMM D, YYYY")}`,[{date:r,display:X,dayjs:G,isToday:T,isAvailable:!0}]}return[]},[n,r,e==null?void 0:e.id]),I=h.useMemo(()=>{var Y,G;if(console.log("🕐 Calculating time slots for:",{internalDate:p,orderType:n,selectedDate:r,foodId:e==null?void 0:e.id,kitchenId:t==null?void 0:t.id,hasPreorderSchedule:!!((Y=t==null?void 0:t.preorderSchedule)!=null&&Y.dates)}),!p)return console.log("❌ No internal date"),[];if(console.log("order type: "+n),n==="GO_GRAB"){const T=Q(),q=Q(p),X=9,ee=21,M=[];let L;if(q.isSame(T,"day")){L=T.add(30,"minutes");const N=L.minute(),J=Math.ceil(N/15)*15;L=L.minute(J).second(0),L.minute()===60&&(L=L.add(1,"hour").minute(0))}else L=q.hour(X).minute(0).second(0);let D=L;for(;D.hour()<ee||D.hour()===ee&&D.minute()===0;)M.push({value:D.format("h:mm A"),display:D.format("h:mm A"),dayjs:D,isAvailable:!0}),D=D.add(15,"minutes");return console.log("✅ Go&Grab time slots:",M.length),M}else if(n==="PRE_ORDER"){if(console.log("🍽️ Processing PRE_ORDER time slots"),!((G=t==null?void 0:t.preorderSchedule)!=null&&G.dates))return console.log("No preorder schedule available in kitchen."),console.log("❌ No preorder schedule in kitchen"),[];if(!(e!=null&&e.id))return console.log("No food ID available."),console.log("❌ No food ID"),[];const T=p||r;if(console.log("Date to use for PRE_ORDER: "+T),!T)return console.log("No date to use for PRE_ORDER."),console.log("❌ No date to use"),[];let q;try{const N=Q(T);console.log("Parsed date: "+N),q=N.format("YYYY-MM-DD"),console.log("Schedule date: "+q),console.log("📅 Schedule date:",q)}catch(N){return console.error("Error parsing date:",T,N),[]}const X=t.preorderSchedule.dates;if(console.log("📋 Available schedule dates:",Object.keys(X)),!X[q])return console.log("No schedule for date: "+q),console.log("❌ No schedule for date:",q),[];const ee=X[q];console.log("Schedule items for date: "+JSON.stringify(ee)),console.log("📦 Schedule items for date:",ee.length);const M=ee.filter(N=>N.foodItemId===e.id);if(console.log("Food schedule items: foodScheduleItems:"+JSON.stringify(M)),console.log("🍕 Food schedule items:",M.length,"for food ID:",e.id),M.length===0)return console.log("❌ No schedule items for this food"),console.log("❌ No schedule items for this food"),[];const L=[];M.forEach((N,J)=>{console.log(`📋 Processing schedule item ${J}:`,N),console.log("Processing schedule item: "+JSON.stringify(N)),N.availableTimes&&Array.isArray(N.availableTimes)?N.availableTimes.forEach(ae=>{try{const te=ff(ae);if(console.log("Parsed time:",ae,"->",te),!te){console.warn("⚠️ Invalid time format (strict):",ae);return}let se=Q("2000-01-01","YYYY-MM-DD",!0).hour(te.h).minute(te.min).second(0);for(let de=-30;de<=30;de+=15){const we=se.add(de,"minute"),U=we.format("h:mm A"),K=we.hour();K>=8&&K<=22&&!L.find(re=>re.value===U)&&L.push({value:U,display:U+(de===0?" (Recommended)":""),isAvailable:!0,scheduleItem:N,isRecommended:de===0,originalTime:ae})}}catch(te){console.error("❌ Error processing time:",ae,te)}}):console.log("❌ No valid availableTimes array in schedule item")}),console.log("Total time slots before sorting: "+JSON.stringify(L));const D=L.sort((N,J)=>{const ae=Q(N.value,"h:mm A",!0),te=Q(J.value,"h:mm A",!0),ce=Q("2000-01-01","YYYY-MM-DD",!0),se=ce.hour(ae.hour()).minute(ae.minute()),de=ce.hour(te.hour()).minute(te.minute());return se.diff(de)});return console.log("Sorted time slots: "+JSON.stringify(D)),console.log("✅ Final PRE_ORDER time slots:",D.length,D),D}return[]},[p,n,r,t==null?void 0:t.id,(ne=t==null?void 0:t.preorderSchedule)==null?void 0:ne.dates,e==null?void 0:e.id]);console.log("Order type: outside of the useMemo()"+n),console.log(`Available time slots: ${n} ${JSON.stringify(I)}`);const z=h.useCallback(Y=>{const G=Q(Y),T=Q().startOf("day");if(console.log("📱 Date change:",{selectedDate:Y,isBeforeToday:G.isBefore(T),orderType:n,isMobile:W}),n==="GO_GRAB"&&G.isBefore(T)){console.log("Please select today or a future date for pickup.");const q=T.format("YYYY-MM-DD");y(q),s(q);return}if(n==="PRE_ORDER"&&Y!==r){console.log("For pre-orders, the pickup date cannot be changed."),y(r);return}y(Y),f(null),B.current=!1,s(Y),w({food:e,kitchen:t,newQuantity:P,currentQuantity:P,selectedDate:p,selectedTime:a,specialInstructions:"",incomingOrderType:n}),o(null)},[n,r,s,o,W]),H=h.useCallback(Y=>{f(Y),o(Y);debugger;w({food:e,kitchen:t,newQuantity:P,currentQuantity:P,selectedDate:p,selectedTime:Y,specialInstructions:"",incomingOrderType:n})},[o]),V=()=>{if(!k)return null;const Y=T=>{v(q=>T==="next"?q.add(1,"month"):q.subtract(1,"month"))},G=T=>{v(q=>T==="next"?q.add(1,"year"):q.subtract(1,"year"))};return i.jsx("div",{className:"mobile-date-picker-overlay",onClick:()=>A(!1),children:i.jsxs("div",{className:"mobile-date-picker-content",onClick:T=>T.stopPropagation(),children:[i.jsxs("div",{className:"mobile-date-picker-header",children:[i.jsx("button",{className:"mobile-picker-btn cancel",onClick:()=>A(!1),children:"Cancel"}),i.jsx("h3",{children:"Select Pickup Date"}),i.jsx("button",{className:"mobile-picker-btn done",onClick:()=>A(!1),children:"Done"})]}),i.jsxs("div",{className:"mobile-calendar-container",children:[i.jsxs("div",{className:"mobile-calendar-navigation",children:[i.jsxs("div",{className:"calendar-nav-section",children:[i.jsx("button",{className:"nav-btn year-nav",onClick:()=>G("prev"),children:"‹‹"}),i.jsx("button",{className:"nav-btn month-nav",onClick:()=>Y("prev"),children:"‹"})]}),i.jsx("div",{className:"mobile-calendar-month-header",children:i.jsx("h4",{children:C.format("MMMM YYYY")})}),i.jsxs("div",{className:"calendar-nav-section",children:[i.jsx("button",{className:"nav-btn month-nav",onClick:()=>Y("next"),children:"›"}),i.jsx("button",{className:"nav-btn year-nav",onClick:()=>G("next"),children:"››"})]})]}),i.jsx("div",{className:"mobile-calendar-weekdays",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(T=>i.jsx("div",{className:"mobile-weekday-header",children:T},T))}),i.jsx("div",{className:"mobile-calendar-grid",children:(()=>{const T=Q().startOf("day"),q=C.startOf("month"),X=C.endOf("month"),ee=q.startOf("week"),M=X.endOf("week"),L=[];let D=ee;for(;D.isBefore(M)||D.isSame(M,"day");){const N=D.format("YYYY-MM-DD"),J=D.isSame(C,"month"),ae=D.isSame(T,"day"),te=D.isBefore(T,"day"),ce=p===N,se=D.isAfter(T.add(30,"days"),"day"),de=!te&&!se&&J;L.push(i.jsxs("button",{className:`mobile-calendar-day ${J?"current-month":"other-month"} ${ae?"today":""} ${ce?"selected":""} ${te?"past":""} ${se?"future-disabled":""} ${de?"available":"unavailable"}`,onClick:()=>{de&&(z(N),A(!1))},disabled:!de,children:[i.jsx("span",{className:"day-number",children:D.format("D")}),ae&&i.jsx("span",{className:"today-indicator",children:"Today"})]},N)),D=D.add(1,"day")}return L})()}),i.jsxs("div",{className:"mobile-quick-dates",children:[i.jsx("h5",{children:"Quick Select"}),i.jsx("div",{className:"quick-date-buttons",children:F.slice(0,7).map(T=>i.jsxs("button",{className:`quick-date-btn ${p===T.date?"selected":""} ${T.isToday?"today":""}`,onClick:()=>{z(T.date),A(!1)},disabled:!T.isAvailable,children:[i.jsx("div",{className:"quick-date-day",children:T.dayjs.format("D")}),i.jsx("div",{className:"quick-date-month",children:T.dayjs.format("MMM")}),i.jsx("div",{className:"quick-date-weekday",children:T.dayjs.format("ddd")}),T.isToday&&i.jsx("div",{className:"quick-date-today",children:"Today"})]},T.date))})]})]})]})})};if(h.useEffect(()=>{console.log("🔄 Main effect triggered:",{orderType:n,internalDate:p,selectedDate:r,foodId:e==null?void 0:e.id,kitchenId:t==null?void 0:t.id,availableTimeSlotsCount:I.length,internalTime:b});const Y=n!==j.current||(e==null?void 0:e.id)!==O.current||(t==null?void 0:t.id)!==E.current;if(Y&&(console.log("🔄 Key props changed, resetting component"),$.current=!1,B.current=!1,y(null),f(null)),(r!==S.current||Y)&&r!==p&&(console.log("🔄 Syncing selectedDate:",r),y(r)),(a!==_.current||Y)&&a!==b&&(console.log("🔄 Syncing selectedTime:",a),f(a)),!$.current&&!p&&F.length>0){const G=F[0].date;console.log("🔄 Auto-selecting default date:",G),y(G),s(G),$.current=!0}if(!B.current&&p&&!b&&I.length>0){const G=I[0].value;console.log("🔄 Auto-selecting default time:",G),f(G),o(G),B.current=!0}if(r===null&&!$.current&&F.length>0){const G=F[0].date;console.log("🔄 Parent passed null date, setting default:",G),y(G),s(G),$.current=!0}if(a===null&&!B.current&&p&&I.length>0){const G=I[0].value;console.log("🔄 Parent passed null time, setting default:",G),f(G),o(G),B.current=!0}S.current=r,_.current=a,j.current=n,O.current=e==null?void 0:e.id,E.current=t==null?void 0:t.id},[r,a,n,e==null?void 0:e.id,t==null?void 0:t.id,p,b,F,I,s,o]),h.useEffect(()=>{if(n==="PRE_ORDER"&&p&&W){console.log("📱 iOS PRE_ORDER refresh - forcing time slots recalculation");const Y=setTimeout(()=>{if(I.length>0&&!b&&!B.current){const G=I[0].value;console.log("📱 iOS auto-selecting time:",G),f(G),o(G),B.current=!0}},100);return()=>clearTimeout(Y)}},[n,p,W,I.length,b,o]),l)return i.jsxs("div",{className:`date-time-picker disabled ${d}`,style:g,children:[i.jsxs("div",{className:"picker-field",children:[i.jsx("label",{className:"picker-label",children:u}),i.jsx("div",{className:"picker-value disabled",children:"Not available"})]}),i.jsxs("div",{className:"picker-field",children:[i.jsx("label",{className:"picker-label",children:m}),i.jsx("div",{className:"picker-value disabled",children:"Not available"})]})]});if(F.length===0)return i.jsx("div",{className:`${d}`,style:g});const ie=c?{}:{"data-first":!0},Z=c?{"data-first":!0}:{};return i.jsxs("div",{className:`date-time-picker ${d}`,style:g,"data-order-type":n,"data-mobile":W,children:[i.jsxs("div",{className:"picker-field",...ie,children:[i.jsx("label",{className:"picker-label",children:u}),i.jsx("div",{className:"date-input-wrapper",children:W&&n==="GO_GRAB"?i.jsxs("div",{className:"picker-select date-select mobile-date-trigger",onClick:()=>A(!0),style:{paddingRight:"18px"},children:[i.jsx("span",{className:"",children:p?((oe=F.find(Y=>Y.date===p))==null?void 0:oe.display)||Q(p).format("MMM D, YYYY"):"Select date"}),i.jsx("svg",{className:"picker-arrow",width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",children:i.jsx("path",{d:"M1 1L6 6L11 1",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"date",ref:x,className:"picker-select date-select date-input",value:p||"",onChange:Y=>z(Y.target.value),disabled:l||F.length===0,min:n==="PRE_ORDER"&&r?r:Q().format("YYYY-MM-DD"),max:n==="PRE_ORDER"&&r?r:F.length>0?F[F.length-1].date:Q().add(7,"day").format("YYYY-MM-DD"),readOnly:n==="PRE_ORDER"}),i.jsx("div",{className:"date-display-text",onClick:()=>{var Y,G,T;!l&&n!=="PRE_ORDER"&&((Y=x.current)==null||Y.focus(),(T=(G=x.current)==null?void 0:G.showPicker)==null||T.call(G))},children:p?((fe=F.find(Y=>Y.date===p))==null?void 0:fe.display)||Q(p).format("MMM D, YYYY"):n==="PRE_ORDER"?"Date pre-selected":"Select date"}),i.jsx("svg",{className:"picker-arrow",width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",style:{opacity:n==="PRE_ORDER"?.5:1},onClick:()=>{var Y,G,T;!l&&n!=="PRE_ORDER"&&((Y=x.current)==null||Y.focus(),(T=(G=x.current)==null?void 0:G.showPicker)==null||T.call(G))},children:i.jsx("path",{d:"M1 1L6 6L11 1",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]}),i.jsxs("div",{className:"picker-field",...Z,children:[i.jsx("label",{className:"picker-label",children:m}),i.jsxs("select",{className:"picker-select time-select",value:b||"",onChange:Y=>H(Y.target.value),children:[i.jsx("option",{value:"",disabled:!0,selected:!0,children:"Select time"}),I.map(Y=>i.jsx("option",{value:Y.value,disabled:!Y.isAvailable,"data-recommended":Y.isRecommended||!1,children:Y.display},Y.value))]})]}),i.jsx(V,{})]})};function fa(){const e=St(),t=Kt(),{goGrabItems:n,preOrderItems:r,availablePreorderDates:a,kitchen:s,isLoading:o,lastUpdated:l}=Se(v=>v.listing),{cartItems:c,getCartQuantity:d}=At(),[u,m]=h.useState({}),[g,p]=h.useState({});h.useEffect(()=>{console.log("[ListingPage] Using Redux listing data:",{goGrabItems:(n==null?void 0:n.length)||0,preOrderItems:(r==null?void 0:r.length)||0,availablePreorderDates:(a==null?void 0:a.length)||0,kitchen:s==null?void 0:s.name,lastUpdated:l?new Date(l).toISOString():"never",isLoading:o}),/iPad|iPhone|iPod/.test(navigator.userAgent)&&(n==null?void 0:n.length)>0&&console.log("[ListingPage] iOS device detected - using pre-loaded Redux data")},[n,r,a,s,l,o]);const y=()=>{var x,S,_,j;const v=localStorage.getItem("detailPage");if(v){console.log("Going back to detailPage from localStorage:",v),window.location.href=v;return}if((S=(x=t.state)==null?void 0:x.from)!=null&&S.fullUrl){console.log("Going back to FoodDetailPage with params:",t.state.from.fullUrl),e(t.state.from.fullUrl);return}if((j=(_=t.state)==null?void 0:_.from)!=null&&j.pathname){console.log("Going back to:",t.state.from.pathname+(t.state.from.search||"")),e(t.state.from.pathname+(t.state.from.search||""));return}try{e(-1)}catch(O){e("/")}},b=h.useCallback((v,x,S=!1)=>{const _=S?`${v}_preorder`:v;m(j=>({...j,[_]:x})),console.log(`[ListingPage] Date changed for ${_}:`,x)},[]),f=h.useCallback((v,x,S=!1)=>{const _=S?`${v}_preorder`:v;p(j=>({...j,[_]:x})),console.log(`[ListingPage] Time changed for ${_}:`,x)},[]),k=h.useCallback(v=>{var S,_;return(_=(S=s==null?void 0:s.preorderSchedule)==null?void 0:S.dates)!=null&&_[v]?!r||r.length===0?[]:s.preorderSchedule.dates[v].map(j=>{const O=r.find(E=>E.id===j.foodItemId);return O?{...O,scheduleItem:j}:null}).filter(Boolean):[]},[s,r]),A=h.useMemo(()=>{const v=new Map;return n&&n.length>0&&n.forEach(x=>{v.set(`${x.id}`,d(x.id))}),a&&a.length>0&&a.forEach(x=>{k(x.dateString).forEach(_=>{v.set(`${_.id}-${x.dateString}`,d(_.id,x.dateString))})}),v},[n,a,c.length,d,k]),C=h.useCallback((v,x=null)=>{const S=x?`${v}-${x}`:`${v}`;return A.get(S)||0},[A]);return h.useEffect(()=>{console.log("pickeup pickupDates updated:",u),console.log("pickeup pickupTimes updated time:",g)},[u,g]),console.log("Rendering ListingPage with state:",c.map(v=>v.foodId)),i.jsx("div",{className:"container",children:i.jsx("div",{className:"mobile-container",children:i.jsxs("div",{className:"padding-20",children:[i.jsxs("div",{className:"back-link-title",children:[i.jsx("button",{className:"back-link",onClick:y,style:{border:"none",background:"none",cursor:"pointer"},children:i.jsx("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M7.94194 0.51631C8.18602 0.760388 8.18602 1.15612 7.94194 1.40019L2.34222 6.99992L7.94194 12.5996C8.18602 12.8437 8.18602 13.2394 7.94194 13.4835C7.69786 13.7276 7.30214 13.7276 7.05806 13.4835L1.01639 7.44186C0.772315 7.19778 0.772315 6.80205 1.01639 6.55798L7.05806 0.51631C7.30214 0.272233 7.69786 0.272233 7.94194 0.51631Z",fill:"#212226"})})}),i.jsx("div",{className:"listing-page-title",children:"More offers from HomeFresh"})]}),i.jsx("h2",{className:"small-title mb-2",children:(s==null?void 0:s.name)||"Coco&apos;s Kitchen"}),n.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"small-title mb-20",children:"Grab & Go"}),i.jsx("div",{className:"menu-listing",children:n.map(v=>{const x=C(v.id);return i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:v.imageUrl||"/src/assets/images/product.png",alt:v.name,onError:S=>{S.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:v.name}),i.jsx("div",{className:"text",children:v.description||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",v.cost]})]})]}),i.jsxs("div",{className:"quantity-warpper",children:[i.jsx("div",{className:"right mb-1",children:i.jsx(Yt,{food:v,kitchen:s,selectedDate:u[v.id],size:"small",initialQuantity:x,minQuantity:0,orderType:"GO_GRAB",selectedTime:g[v.id]})}),i.jsx("div",{className:"pickup-time-section",children:i.jsx(In,{food:v,kitchen:s,orderType:"GO_GRAB",selectedDate:u[v.id],selectedTime:g[v.id],onDateChange:S=>{b(v.id,S,!1)},onTimeChange:S=>{f(v.id,S,!1)},disabled:!v||!s,className:"listing-page-picker",dateLabel:"",timeLabel:""})})]})]},v.id)})})]}),a.map(v=>{const x=k(v.dateString);return console.log("preOrderItemsForDate",x),x.length===0?null:i.jsxs("div",{children:[i.jsxs("h2",{className:"small-title mb-16",children:["Pre-order for ",v.displayDate]}),i.jsx("div",{className:"menu-listing",children:x.map(S=>{const _=C(S.id,v.dateString);return i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:S.imageUrl||"/src/assets/images/product.png",alt:S.name,onError:j=>{j.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:S.name}),i.jsx("div",{className:"text",children:S.description||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",S.cost]})]})]}),i.jsxs("div",{className:"quantity-warpper",children:[i.jsx("div",{className:"right mb-1",children:i.jsx(Yt,{food:S,kitchen:s,selectedDate:u[`${S.id}_preorder`]||v.dateString,size:"small",initialQuantity:_,minQuantity:0,orderType:"PRE_ORDER",selectedTime:g[`${S.id}_preorder`]})}),i.jsx("div",{className:"pickup-time-section",children:i.jsx(In,{food:S,kitchen:s,orderType:"PRE_ORDER",selectedDate:u[`${S.id}_preorder`]||v.dateString,selectedTime:g[`${S.id}_preorder`],onDateChange:j=>{b(S.id,j,!0)},onTimeChange:j=>{f(S.id,j,!0)},disabled:!S||!s,className:"listing-page-picker",dateLabel:"",timeLabel:""})})]})]},`${S.id}-${v.dateString}`)})})]},v.dateString)}),i.jsx("button",{className:"action-button mb-16",onClick:()=>{c.length===0?alert("Oops! Your cart is empty. Add something delicious to get started."):e("/order")},children:"Continue to View Cart"}),i.jsxs("div",{className:"scanner-bottom mb-16",children:[i.jsx("div",{className:"text",children:"Full menus from your local home kitchens can be found in the HomeFresh app, available in the iOS App Store."}),i.jsx("div",{className:"qr",children:i.jsx("img",{src:Co,alt:"QR Code"})})]})]})})})}const Ae={success:(e,t={})=>yt.success(e,{icon:"✅",duration:3e3,style:{background:"#F0FDF4",color:"#15803D",border:"1px solid #22C55E",borderRadius:"12px",padding:"16px"},...t}),error:(e,t={})=>yt.error(e,{icon:"❌",duration:4e3,style:{background:"#FEF2F2",color:"#DC2626",border:"1px solid #EF4444",borderRadius:"12px",padding:"16px"},...t}),info:(e,t={})=>yt(e,{icon:"ℹ️",duration:3500,style:{background:"#EFF6FF",color:"#1D4ED8",border:"1px solid #3B82F6",borderRadius:"12px",padding:"16px"},...t}),warning:(e,t={})=>yt(e,{icon:"⚠️",duration:4e3,style:{background:"#FEF3C7",color:"#92400E",border:"1px solid #F59E0B",borderRadius:"12px",padding:"16px"},...t}),cart:(e,t={})=>yt.success(e,{icon:"🛒",duration:3e3,style:{background:"#F0F9FF",color:"#0C4A6E",border:"1px solid #0EA5E9",borderRadius:"12px",padding:"16px"},...t}),loading:(e,t={})=>yt.loading(e,{style:{background:"#F9FAFB",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"12px",padding:"16px"},...t})},hf=()=>{const e=it(),t=St();return{logout:h.useCallback(async()=>{try{const r=Ae.loading("Logging out...");await e(ko()).unwrap(),Ae.success("Successfully logged out!"),t("/login",{replace:!0})}catch(r){console.error("❌ Logout failed:",r),Ae.error("Logout failed, but redirecting anyway"),t("/login",{replace:!0})}},[e,t])}},gf=()=>(h.useEffect(()=>{const e={currentUrl:window.location.href,hostname:window.location.hostname,origin:window.location.origin,userAgent:navigator.userAgent,isWeChatBrowser:/micromessenger/i.test(navigator.userAgent),isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),timestamp:new Date().toISOString()};console.log("🔍 WeChat Debug Info:",e),localStorage.setItem("wechat_debug_info",JSON.stringify(e,null,2))},[]),null);function vf(){const[e,t]=h.useState(new Date),[n,r]=h.useState(""),a="Enjoy delicious meal from your favorite chef.";console.log("Deployed Version 82");const{user:s,isAuthenticated:o}=Se(u=>u.auth),{totalItems:l}=Se(u=>u.cart),{logout:c}=hf();h.useEffect(()=>{const u=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(u)},[]),h.useEffect(()=>{let u=0;const m=setInterval(()=>{u<a.length?(r(a.slice(0,u+1)),u++):clearInterval(m)},50);return()=>clearInterval(m)},[]);const d=u=>u.toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"2-digit",second:"2-digit"});return i.jsxs("div",{className:"landing-page",children:[i.jsxs("div",{className:"background-animation",children:[i.jsx("div",{className:"floating-food food-1",children:"🥘"}),i.jsx("div",{className:"floating-food food-2",children:"🍜"}),i.jsx("div",{className:"floating-food food-3",children:"🥗"}),i.jsx("div",{className:"floating-food food-4",children:"🍲"}),i.jsx("div",{className:"floating-food food-5",children:"🥙"}),i.jsx("div",{className:"floating-food food-6",children:"🍱"})]}),i.jsxs("div",{className:"landing-content",children:[i.jsxs("div",{className:"logo-section",children:[i.jsx("div",{className:"logo-circle",children:i.jsx("span",{className:"logo-icon",children:"🏠"})}),i.jsxs("h1",{className:"brand-name",children:["Home",i.jsx("span",{className:"accent-text",children:"Fresh"})]})]}),i.jsxs("div",{className:"coming-soon-section",children:[i.jsxs("h2",{className:"coming-soon-title",children:["Welcome to ",i.jsx("span",{className:"gradient-text",children:"HomeFresh!"})]}),i.jsxs("p",{className:"subtitle",children:[n,i.jsx("span",{className:"cursor",children:"|"})]}),i.jsxs("div",{className:"feature-grid",children:[i.jsxs("div",{className:"feature-card",children:[i.jsx("div",{className:"feature-icon",children:"👨‍🍳"}),i.jsx("h3",{children:"Home Chefs"}),i.jsx("p",{children:"Local talented chefs cooking with love"})]}),i.jsxs("div",{className:"feature-card",children:[i.jsx("div",{className:"feature-icon",children:"🚀"}),i.jsx("h3",{children:"Fresh Experience"}),i.jsx("p",{children:"Fast and reliable taste you can trust"})]}),i.jsxs("div",{className:"feature-card",children:[i.jsx("div",{className:"feature-icon",children:"💝"}),i.jsx("h3",{children:"Made with Love"}),i.jsx("p",{children:"Every meal crafted with care and passion"})]})]}),i.jsxs("div",{className:"live-clock",children:[i.jsx("span",{className:"clock-icon",children:"⏰"}),i.jsx("span",{className:"time-display",children:d(e)})]}),i.jsxs("div",{className:"cta-section",children:[i.jsx("p",{className:"launch-text",children:"We're putting the finishing touches on something special!"}),i.jsxs(wt,{to:"/foods",className:"explore-btn",children:[i.jsx("span",{children:"Explore Preview"}),i.jsx("div",{className:"btn-arrow",children:"→"})]})]}),i.jsxs("div",{className:"progress-container",children:[i.jsx("div",{className:"progress-label",children:"Launch Progress"}),i.jsx("div",{className:"progress-bar",children:i.jsx("div",{className:"progress-fill"})}),i.jsx("div",{className:"progress-text",children:"95% Complete"})]})]}),i.jsxs("footer",{className:"landing-footer",children:[i.jsx("p",{children:"Get ready for a culinary revolution 🌟"}),i.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"rgba(0,0,0,0.1)",borderRadius:"8px",fontSize:"12px"},children:[i.jsx("h4",{children:"🔧 Debug Panel (Persistence Test)"}),i.jsxs("p",{children:[i.jsx("strong",{children:"User:"})," ",o?(s==null?void 0:s.name)||"Authenticated":"Not logged in"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Cart Items:"})," ",l," items"]}),i.jsxs("div",{style:{marginTop:"10px"},children:[i.jsx("button",{onClick:c,style:{padding:"8px 16px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"10px"},children:"🚪 Test Logout (Clear All Data)"}),i.jsx(wt,{to:"/foods",style:{padding:"8px 16px",backgroundColor:"#44ff44",color:"white",textDecoration:"none",borderRadius:"4px"},children:"🛒 Go to Foods (Test Cart)"})]})]})]})]}),i.jsx(gf,{})]})}const wn="/assets/product-BvDHopBm.png",xf="/assets/user1-BYeI5APa.svg",yf=(e,t)=>{const n=it(),[r,a]=h.useState(!1),{user:s}=Se(T=>T.auth),{currentFood:o,currentKitchen:l,currentReviews:c,currentReviewStats:d,currentLikes:u,loading:m,error:g,likedFoods:p}=Se(T=>T.food),{kitchenStats:y,kitchenReviews:b,statsLoading:f,reviewsLoading:k}=Se(T=>T.kitchen),{foodReviews:A,foodReviewsLoading:C,submissionLoading:v}=Se(T=>T.reviews),{items:x,loading:S}=Se(T=>T.cart),_=y[t],j=b[t],O=A[e],E=C[e],$=f[t],B=k[t],W=p.includes(e),R=x.filter(T=>T.foodId===e&&T.kitchenId===t).reduce((T,q)=>T+q.quantity,0),w=h.useCallback(T=>x.find(q=>q.foodId===e&&q.kitchenId===t&&q.selectedDate===T.selectedDate&&q.specialInstructions===(T.specialInstructions||"")),[x,e,t]),P=h.useCallback(()=>{e&&t&&n(Ut({foodId:e,kitchenId:t}))},[n,e,t]),F=h.useCallback(()=>{t&&!_&&!$&&n(hn(t))},[n,t,_,$]),I=h.useCallback(()=>{t&&!j&&!B&&n(gn({kitchenId:t,limit:10}))},[n,t,j,B]),z=h.useCallback(()=>{e&&!O&&!E&&n(vn({foodId:e,kitchenId:t,limit:10}))},[n,e,t,O,E]),H=h.useCallback(()=>{if(!t){console.warn("Kitchen ID is required to like food");return}if(!r){console.warn("Like status not yet checked, preventing toggle");return}console.log("🔍 Toggle like called:",{foodId:e,kitchenId:t,userId:s==null?void 0:s.id,currentlyLiked:W,likedFoodsArray:p,likeStatusChecked:r}),n(zr(e))},[n,e,t,W,p,s==null?void 0:s.id,r]),V=h.useCallback((T=null,q=null)=>{const X=Q();if(T){const ee=Q(T),M=q||"6:30 PM",D=ee.isSame(X,"day")?"Go&Grab":"Pre-Order";return{date:ee.format("YYYY-MM-DD"),time:M,display:`${ee.format("MMM DD, YYYY")} at ${M}`,orderType:D}}else{const ee=q||X.add(30,"minutes").format("h:mm A");return{date:X.format("YYYY-MM-DD"),time:ee,display:`Today at ${ee}`,orderType:"Go&Grab"}}},[]),ie=h.useCallback(T=>{const q=w(T);if(q)return console.log("Item already exists, updating quantity:",q.quantity,"to",T.quantity),n(qr({cartItemId:q.id,quantity:T.quantity,specialInstructions:T.specialInstructions})),{success:!0,message:"Cart item quantity updated successfully",existingQuantity:q.quantity,newQuantity:T.quantity};const X=V(T.selectedDate,T.selectedTime),ee={foodId:e,kitchenId:t,quantity:T.quantity,orderType:T.orderType,selectedDate:T.selectedDate,selectedTime:T.selectedTime,specialInstructions:T.specialInstructions||"",pickupDetails:X,isPreOrder:T.selectedDate&&!Q(T.selectedDate).isSame(Q(),"day"),food:o?{id:o.id,name:o.name,cost:o.cost,price:o.price||o.cost,imageUrl:o.imageUrl,image:o.image||o.imageUrl,description:o.description,category:o.category,isAvailable:o.isAvailable,kitchenName:o.kitchenName,maxQuantity:o.maxQuantity,totalQuantity:o.totalQuantity,availableQuantity:o.availableQuantity,isPreOrder:o.isPreOrder,...o}:null,kitchen:l?{id:l.id,name:l.name,address:l.address,rating:l.rating,ratingCount:l.ratingCount,...l}:null};return console.log("Adding new item to cart:",ee),n(go(ee)),{success:!0,message:"Item added to cart successfully"}},[n,e,t,w,o,l,V]),Z=h.useCallback(T=>{const q=x.find(X=>X.foodId===e&&X.kitchenId===t);q&&(console.log("Updating cart item quantity:",{cartItemId:q.id,quantity:T}),n(qr({cartItemId:q.id,quantity:T})))},[n,e,t,x]),ne=h.useCallback(T=>n(xn({foodId:e,kitchenId:t,reviewData:T})),[n,e,t]),oe=h.useCallback(()=>{n(Tm())},[n]);return h.useEffect(()=>(P(),F(),z(),()=>{}),[P,F,z]),h.useEffect(()=>{e&&t&&o&&(console.log("🔍 Checking like status for food:",{foodId:e,kitchenId:t,userId:s==null?void 0:s.id}),n(fo({foodId:e,kitchenId:t})).then(T=>{console.log("✅ Like status checked:",T),a(!0)}))},[n,e,t,o,s==null?void 0:s.id]),{food:o,kitchen:l,reviews:c||[],reviewStats:d||_,kitchenStats:_,likes:u,isLiked:W,cartQuantity:R,loading:m||$,reviewsLoading:E,kitchenStatsLoading:$,kitchenReviewsLoading:B,reviewSubmissionLoading:v,cartLoading:S,error:g,user:s,toggleLike:H,addToCartAction:ie,updateCartItemQuantity:Z,addReview:ne,loadFoodDetail:P,loadKitchenStats:F,loadKitchenReviews:I,loadFoodReviews:z,clearData:oe}};function bf({isLoading:e=!0,text:t="Loading...",overlay:n=!0,size:r="medium"}){if(!e)return null;const a={small:"spinner-sm",medium:"spinner-md",large:"spinner-lg"},s=()=>i.jsx("div",{className:`mobile-loader-content ${n?"overlay":"inline"}`,children:i.jsxs("div",{className:"loader-spinner-wrapper",children:[i.jsxs("div",{className:`custom-spinner ${a[r]}`,children:[i.jsx("div",{className:"spinner-ring"}),i.jsx("div",{className:"spinner-ring"}),i.jsx("div",{className:"spinner-ring"})]}),t&&i.jsx("p",{className:"loader-text",children:t})]})});return n?i.jsx("div",{className:"mobile-loader-overlay",children:i.jsx(s,{})}):i.jsx(s,{})}const ha=({src:e,alt:t,fallbackSrc:n=wn,className:r=""})=>{const[a,s]=h.useState(null),[o,l]=h.useState(),[c,d]=h.useState(!1),[u,m]=h.useState(!1),g=h.useRef(),p=h.useCallback(f=>{g.current&&g.current.disconnect(),g.current=new IntersectionObserver(k=>{k.forEach(A=>{A.isIntersecting&&(s(e),g.current.disconnect())})},{threshold:.1,rootMargin:"50px"}),f&&g.current.observe(f),l(f)},[e]),y=()=>{d(!0)},b=()=>{m(!0),s(n),d(!0)};return i.jsxs("div",{className:"lazy-image-container",style:{position:"relative"},children:[!c&&i.jsx("div",{className:"image-placeholder",children:i.jsx("div",{className:"image-skeleton"})}),i.jsx("img",{ref:p,src:a||n,alt:t,className:`${r} ${c?"loaded":"loading"}`,onLoad:y,onError:b,loading:"lazy",style:{opacity:c?1:0,transition:"opacity 0.3s ease-in-out"}}),u&&i.jsx("div",{className:"image-error-indicator",children:i.jsx("small",{children:"Using fallback image"})})]})},ga=({rating:e=0,maxStars:t=5,size:n="small",showRating:r=!1,reviewCount:a=null,className:s=""})=>{const o=Math.max(0,Math.min(e,t)),l={small:{width:12,height:12,gap:"2px"},medium:{width:16,height:17,gap:"3px"},large:{width:20,height:21,gap:"4px"}},{width:c,height:d,gap:u}=l[n]||l.small,m=()=>{const g=[];for(let p=1;p<=t;p++){const y=Math.max(0,Math.min(1,o-(p-1)));g.push(i.jsxs("div",{className:"star-container",style:{position:"relative"},children:[i.jsx("svg",{width:c,height:d,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"star-empty",children:i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.8542 1.20117C5.80112 1.20117 5.67045 1.21576 5.60103 1.35459L4.53587 3.48434C4.36728 3.82092 4.04237 4.05484 3.6667 4.10851L1.28203 4.45209C1.12453 4.47484 1.07087 4.59151 1.05453 4.6405C1.03995 4.68776 1.01662 4.80792 1.12512 4.91176L2.84945 6.56842C3.1242 6.83267 3.24903 7.21359 3.1837 7.58634L2.7777 9.9255C2.75262 10.0719 2.8442 10.1571 2.88503 10.1863C2.9282 10.2189 3.0437 10.2837 3.18662 10.209L5.3187 9.10359C5.6547 8.93034 6.05487 8.93034 6.3897 9.10359L8.5212 10.2084C8.6647 10.2825 8.7802 10.2178 8.82395 10.1863C8.86478 10.1571 8.95637 10.0719 8.93128 9.9255L8.52412 7.58634C8.45878 7.21359 8.58362 6.83267 8.85837 6.56842L10.5827 4.91176C10.6918 4.80792 10.6684 4.68717 10.6533 4.6405C10.6375 4.59151 10.5839 4.47484 10.4264 4.45209L8.0417 4.10851C7.66662 4.05484 7.3417 3.82092 7.17312 3.48376L6.10678 1.35459C6.03795 1.21576 5.90728 1.20117 5.8542 1.20117Z",fill:"#E5E7EB",stroke:"#E5E7EB",strokeWidth:"0.2"})}),y>0&&i.jsx("div",{className:"star-filled",style:{position:"absolute",top:0,left:0,width:`${y*100}%`,overflow:"hidden"},children:i.jsx("svg",{width:c,height:d,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M9.45251 6.92967C9.30143 7.07609 9.23201 7.28784 9.26643 7.4955L9.78502 10.3655C9.82876 10.6088 9.7261 10.8549 9.52251 10.9955C9.32301 11.1413 9.0576 11.1588 8.84001 11.0422L6.25643 9.69467C6.1666 9.64684 6.06685 9.62117 5.96476 9.61825H5.80668C5.75185 9.62642 5.69818 9.64392 5.64918 9.67075L3.06501 11.0247C2.93726 11.0888 2.7926 11.1116 2.65085 11.0888C2.30551 11.0235 2.0751 10.6945 2.13168 10.3474L2.65085 7.47742C2.68526 7.268 2.61585 7.05509 2.46476 6.90633L0.358348 4.86467C0.182181 4.69375 0.120931 4.43709 0.201431 4.2055C0.279598 3.9745 0.479098 3.80592 0.720015 3.768L3.61918 3.34742C3.83968 3.32467 4.03335 3.1905 4.13251 2.99217L5.41001 0.373001C5.44035 0.314668 5.47943 0.261001 5.52668 0.215501L5.57918 0.174668C5.6066 0.144335 5.6381 0.119251 5.6731 0.0988346L5.73668 0.0755013L5.83585 0.034668H6.08143C6.30076 0.057418 6.49385 0.188668 6.59476 0.384668L7.88918 2.99217C7.98251 3.18292 8.16393 3.31533 8.37335 3.34742L11.2725 3.768C11.5175 3.803 11.7223 3.97217 11.8033 4.2055C11.8798 4.43942 11.8138 4.69608 11.6342 4.86467L9.45251 6.92967Z",fill:"#FF981F"})})})]},p))}return g};return i.jsxs("div",{className:`star-rating ${n} ${s}`,children:[i.jsx("div",{className:"stars-container",style:{gap:u},children:m()}),(r||a)&&i.jsxs("div",{className:"rating-info",children:[r&&i.jsx("span",{className:"rating-value",children:i.jsx("strong",{children:o.toFixed(1)})}),a&&i.jsxs("span",{className:"review-count",children:["(",a>1e3?`${(a/1e3).toFixed(1)}k`:a,"+ reviews)"]})]})]})};function So(e){const[t,n]=h.useState(null),[r,a]=h.useState([]),[s,o]=h.useState(!0),[l,c]=h.useState(null);return h.useEffect(()=>{async function d(){if(!e){o(!1);return}console.log(`[useKitchenWithFoods] Fetching kitchen: ${e}`);try{o(!0),c(null);const{kitchen:u,foods:m}=await Lm(e);n(u),a(m),console.log(`[useKitchenWithFoods] Loaded kitchen with ${m.length} foods`)}catch(u){console.error("[useKitchenWithFoods] Error:",u),c(u.message)}finally{o(!1)}}d()},[e]),{kitchen:t,foods:r,loading:s,error:l,hasData:!!t&&r.length>0}}const Do=({onClose:e,firebaseImageUrl:t})=>{console.log("🚀 WeChatAuthDialog rendered!");const n=async()=>{try{const a=Yi(),s=Rt();console.log("🔍 Auth context:",{isMobile:a,isWeChat:s}),sessionStorage.setItem("wechat_pending_cart_action","true");let o=Gi(t);s?(o=Ki(t),console.log("📱 WeChat browser detected - direct redirect"),window.location.href=o):a?(console.log("📱 Mobile device - attempting WeChat authentication"),o=Ki(t),window.location.href=o):(console.log("🖥️ Desktop - direct redirect"),window.location.href=o)}catch(a){console.error("❌ Error in WeChat authentication:",a);const s=Gi();window.location.href=s}},r=a=>{a.target===a.currentTarget&&e()};return i.jsx("div",{className:"wechat-auth-dialog-overlay",onClick:r,children:i.jsxs("div",{className:"wechat-auth-dialog",children:[i.jsxs("div",{className:"wechat-auth-header",children:[i.jsx("h3",{children:"Sign in to Continue"}),i.jsx("button",{className:"wechat-auth-close",onClick:e,"aria-label":"Close dialog",children:"×"})]}),i.jsxs("div",{className:"wechat-auth-content",children:[i.jsx("div",{className:"wechat-auth-icon",children:i.jsx("img",{src:Br,alt:"WeChat"})}),i.jsx("p",{className:"wechat-auth-message",children:"Please sign in with WeChat to add items to your cart"}),i.jsxs("button",{className:"wechat-auth-button",onClick:n,children:[i.jsx("img",{src:Br,alt:"WeChat"}),"Continue with WeChat"]}),i.jsx("p",{className:"wechat-auth-note",children:Yi()&&!Rt()?"This will open WeChat app for secure authentication":"We'll redirect you to WeChat for secure authentication"})]})]})})},wf=({food:e,isLiked:t})=>{console.log("🚀 ~ CustomSlider ~ isLiked:",t);const r=(()=>{if(console.log("🖼️ [CustomSlider] Checking imagesUrl array:",e),e!=null&&e.imageUrls&&Array.isArray(e.imageUrls)&&e.imageUrls.length>0)return console.log("🖼️ [CustomSlider] Using imageUrls array with",e.imageUrls.length,"images"),e.imageUrls;if(e!=null&&e.imageUrl&&!(e!=null&&e.imageUrls))return[e.imageUrl]})()||[],[a,s]=h.useState(0),[o,l]=h.useState(!0);h.useEffect(()=>{if(!o||!r||r.length<=1)return;const g=setInterval(()=>{s(p=>(p+1)%r.length)},2e3);return()=>clearInterval(g)},[o,r]),h.useEffect(()=>{r&&r.length>1&&l(!0)},[r]);const c=()=>{l(!0),setTimeout(()=>{r&&r.length>1&&l(!0)},3e3)},d=()=>{!r||r.length===0||(c(),s(g=>g===0?r.length-1:g-1))},u=()=>{!r||r.length===0||(c(),s(g=>(g+1)%r.length))},m=g=>{!r||r.length===0||(c(),s(g))};return!r||r.length===0?i.jsx("div",{className:"custom-slider",children:i.jsx("div",{className:"slider-container",children:i.jsx("div",{className:"slider-slide",children:i.jsx(ha,{src:wn,alt:"No image available",fallbackSrc:wn,className:"slider-image"})})})}):i.jsx("div",{className:`custom-slider ${o?"auto-sliding":""}`,children:i.jsxs("div",{className:"slider-container",children:[i.jsx("div",{className:"slider-track",style:{transform:`translateX(-${a*100}%)`},children:r.map((g,p)=>i.jsx("div",{className:"slider-slide",children:i.jsx(ha,{src:g,alt:`${(e==null?void 0:e.name)||"Food"} Image ${p+1}`,fallbackSrc:wn,className:"slider-image"})},p))}),r.length>1&&i.jsx("button",{className:"slider-btn slider-prev",onClick:d,"aria-label":"Previous image",children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:i.jsx("path",{d:"M12.5 15L7.5 10L12.5 5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.length>1&&i.jsx("button",{className:"slider-btn slider-next",onClick:u,"aria-label":"Next image",children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:i.jsx("path",{d:"M7.5 5L12.5 10L7.5 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.length>1&&i.jsx("div",{className:"slider-dots",children:r.map((g,p)=>i.jsx("button",{className:`slider-dot ${a===p?"active":""}`,onClick:()=>m(p),"aria-label":`Go to slide ${p+1}`},p))})]})})};function va(){var ee,M;const[e]=Bo(),t=it(),n=Kt(),r=St(),{getCartQuantity:a,handleQuantityChange:s}=At();h.useEffect(()=>{localStorage.setItem("detailPage",window.location.href)},[]);const o=()=>{if(console.log("🔍 [FoodDetailPage] Current pathname:",n.pathname),console.log("🔍 [FoodDetailPage] Search params:",e.toString()),n.pathname==="/share"||n.pathname==="/share/"){const L={kitchenId:e.get("kitchenId"),foodId:e.get("foodId"),selectedDate:e.get("date"),toggle:e.get("toggle")};return console.log("🔍 [FoodDetailPage] Extracted params:",L),L}return console.log("🔍 [FoodDetailPage] Using fallback params (pathname not /share)"),{kitchenId:null,foodId:null,selectedDate:null,toggle:null}},{kitchenId:l,foodId:c,selectedDate:d,toggle:u}=o();if(!l||!c)return i.jsx("div",{className:"mobile-container",children:i.jsx("div",{className:"padding-20",children:i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("h4",{children:"Invalid URL"}),i.jsx("p",{children:"Missing required parameters. Please check your link and try again."}),i.jsxs("small",{className:"text-muted",children:["Expected: kitchenId and foodId"," ",n.pathname==="/share"?"as query parameters":"as URL parameters"]})]})})});const{kitchen:m,foods:g}=So(l),[p,y]=h.useState("reviews"),[b,f]=h.useState(0),[k,A]=h.useState(""),C=Se(L=>L.auth.isAuthenticated),v=Se(L=>L.auth.user),[x,S]=h.useState(!1),_=L=>S(L),[j,O]=h.useState(d&&Q(d,"M/D/YYYY").format("YYYY-MM-DD")),[E,$]=h.useState(null),[B,W]=h.useState({isAvailable:!0,quantity:1,orderType:"GO_GRAB"}),{food:R,kitchen:w,likes:P,reviews:F,reviewStats:I,loading:z,error:H,isLiked:V,toggleLike:ie}=yf(c,l),Z=Fn.useMemo(()=>{var D;const L=((D=R==null?void 0:R.availability)==null?void 0:D.numAvailable)||(R==null?void 0:R.numAvailable)||0;return L>0&&!d?(console.log("DEBUG - Setting orderType to GO_GRAB due to availability:",L),"GO_GRAB"):d?(console.log("DEBUG - No availability, checking Pre-Order for date:",d),"PRE_ORDER"):"GO_GRAB"},[d,R,w]),ne=a(c,j||d,Z);console.log("FoodDetailPage data:",{food:R,kitchen:w,likes:P,reviews:F,reviewStats:I,loading:z,error:H,selectedDate:d,orderType:Z,pickupDate:j,pickupTime:E,urlPattern:n.pathname,extractedParams:{kitchenId:l,foodId:c,selectedDate:d},kitchenPreorderSchedule:w==null?void 0:w.preorderSchedule});const oe=h.useMemo(()=>{var D,N,J,ae,te;let L=0;debugger;if(Z==="GO_GRAB")L=((D=R==null?void 0:R.availability)==null?void 0:D.numAvailable)||(R==null?void 0:R.numAvailable)||(R==null?void 0:R.numberOfAvailableItem)||0;else if(Z==="PRE_ORDER"){const ce=(J=(N=w==null?void 0:w.preorderSchedule)==null?void 0:N.dates)==null?void 0:J[j];if(ce&&Array.isArray(ce)){const se=ce.find(de=>de.foodItemId===(R==null?void 0:R.id));L=se!=null&&se.isLimitedOrder?99:(se==null?void 0:se.numOfAvailableItems)||0}}return console.log("🔢 [FoodDetailPage] getCurrentAvailability:",{orderType:Z,pickupDate:j,foodId:R==null?void 0:R.id,currentAvailability:L,scheduleExists:!!((te=(ae=w==null?void 0:w.preorderSchedule)==null?void 0:ae.dates)!=null&&te[j])}),L},[Z,j,R,w]);console.log("getCurrentAvailability",oe);const fe=h.useCallback(L=>{W(L)},[]);h.useCallback(()=>{if(!B.isAvailable){console.log("This item is currently unavailable");return}if(ne===0){alert("Please use the quantity selector to add items to cart first.");return}ne>0&&k.trim()&&(console.log("[FoodDetailPage] Updating special instructions for existing cart item"),R&&w&&(s({food:R,kitchen:w,newQuantity:ne,currentQuantity:ne,selectedDate:j||d,selectedTime:E,specialInstructions:k.trim(),isPreOrder:Z==="PRE_ORDER"}),showToast.success("Special instructions updated!"))),console.log("[FoodDetailPage] Navigating back to foods page");const L=new URLSearchParams({kitchenId:l||"",foodId:c||"",...d&&{date:d}}).toString();r("/foods",{replace:!0,state:{from:{pathname:n.pathname,search:n.search,fullUrl:`/share?${L}`}}})},[B,ne,b,k,R,w,j,d,E,Z,s,l,c,r,n]),h.useEffect(()=>{ne>0&&f(ne)},[ne]),h.useEffect(()=>{d&&!j&&O(d)},[d,j]),h.useEffect(()=>{(async()=>{console.log("=== DEBUGGING REVIEWS ==="),console.log("URL params - foodId:",c,"kitchenId:",l,"selectedDate:",d);const D=await Rm();if(console.log("Connection test:",D),c){const N=await km(c);console.log("Debug reviews result:",N)}})()},[c,l,d]),console.log("🚀 ~ FoodDetailPage ~ reviewStats:",I);const Y=(I==null?void 0:I.averageRating)||0,G=(I==null?void 0:I.totalReviews)||0,T=(I==null?void 0:I.ratingPercentages)||{5:90,4:70,3:40,2:20,1:8},q=(F==null?void 0:F.length)>0?F.map(L=>({id:L.id,image:L.userProfile||xf,date:L.timeStamp?(()=>{try{let D;return typeof L.timeStamp=="string"?L.timeStamp.includes(" at ")?D=new Date(L.timeStamp.replace(" at "," ").replace(" UTC+5","")):D=new Date(L.timeStamp):L.timeStamp.seconds?D=new Date(L.timeStamp.seconds*1e3):D=new Date(L.timeStamp),D.toLocaleDateString()}catch(D){return console.warn("Error parsing timestamp:",L.timeStamp),"Unknown date"}})():"Unknown date",name:L.userName||"Anonymous User",rating:L.rating||5,description:L.message||"No comment provided"})):[],X=h.useCallback(()=>{if(!C&&!v){console.log("🔒 Authentication required for placing order"),localStorage.setItem("page",JSON.stringify({isDetailPage:!0,detailPageUrl:window.location.href+"&toggle=like"})),_(!0);return}ie(),console.log(`[FoodDetailPage] Food ${V?"unliked":"liked"}`)},[ie,V]);return h.useEffect(()=>{u==="like"&&X()},[u]),h.useEffect(()=>{(!document.referrer||!document.referrer.includes(window.location.origin))&&(console.log("🛒 Clearing cart on direct landing to FoodDetailPage"),t(Kn()))},[t]),h.useEffect(()=>{if(!(R!=null&&R.id)||!(w!=null&&w.id))return;if((!document.referrer||!document.referrer.includes(window.location.origin))&&ne===0&&(console.log("🔄 Direct landing detected - adding default quantity to cart",{foodId:R.id,kitchenId:w.id,orderType:Z,currentCartQuantity:ne}),!sessionStorage.getItem(`direct-landing-processed-${R.id}`))){sessionStorage.setItem(`direct-landing-processed-${R.id}`,"true"),console.log("getCurrentAvailability",oe);const N=setTimeout(()=>{s({food:R,kitchen:w,newQuantity:oe===0?0:1,currentQuantity:0,selectedDate:j||Q().format("YYYY-MM-DD"),selectedTime:null,specialInstructions:"",incomingOrderType:Z})},100);return()=>{clearTimeout(N)}}},[R==null?void 0:R.id,w==null?void 0:w.id,ne,oe]),h.useEffect(()=>()=>{R!=null&&R.id&&sessionStorage.removeItem(`direct-landing-processed-${R.id}`)},[R==null?void 0:R.id]),h.useEffect(()=>{var L;if(!m||!g||g.length===0||!l){console.log("[FoodDetailPage] Missing data for listing processing");return}console.log("[FoodDetailPage] Processing and storing listing data"),t(ua(!0));try{const D=g.filter(te=>{var se;return(((se=te.availability)==null?void 0:se.numAvailable)||te.numAvailable||0)>0&&te.kitchenId===l});let N=[],J=[];if((L=m==null?void 0:m.preorderSchedule)!=null&&L.dates){const te=Q(),ce=te.add(1,"day"),se=te.format("YYYY-MM-DD"),de=ce.format("YYYY-MM-DD");console.log("📅 [FoodDetailPage] Checking preorder for today and tomorrow:",{today:se,tomorrow:de});const we=m.preorderSchedule.dates[se],U=m.preorderSchedule.dates[de];J=[];const K=new Set;we&&Array.isArray(we)&&we.length>0?(J.push({dateString:se,displayDate:`Today, ${te.format("MMM D")}`,scheduleItems:we}),console.log("📅 [FoodDetailPage] Today's preorder schedule found:",{date:se,itemsCount:we.length,items:we.map(re=>({foodItemId:re.foodItemId,nameOfFood:re.nameOfFood,numOfAvailableItems:re.numOfAvailableItems}))}),we.forEach(re=>{K.add(re.foodItemId)})):console.log("📅 [FoodDetailPage] No preorder schedule found for today"),U&&Array.isArray(U)&&U.length>0?(J.push({dateString:de,displayDate:`Tomorrow, ${ce.format("MMM D")}`,scheduleItems:U}),console.log("📅 [FoodDetailPage] Tomorrow's preorder schedule found:",{date:de,itemsCount:U.length,items:U.map(re=>({foodItemId:re.foodItemId,nameOfFood:re.nameOfFood,numOfAvailableItems:re.numOfAvailableItems}))}),U.forEach(re=>{K.add(re.foodItemId)})):console.log("📅 [FoodDetailPage] No preorder schedule found for tomorrow"),K.size>0?(N=g.filter(re=>K.has(re.id)&&re.kitchenId===l),console.log("📅 [FoodDetailPage] Foods available for preorder (today + tomorrow):",{totalFoodsFound:N.length,totalDatesAvailable:J.length,foodIds:N.map(re=>re.id),foodNames:N.map(re=>re.name),availableDates:J.map(re=>re.displayDate)})):(console.log("📅 [FoodDetailPage] No preorder items found for today or tomorrow"),N=[])}else console.log("📅 [FoodDetailPage] No preorder schedule found in kitchen data"),J=[],N=[];const ae={goGrabItems:D,preOrderItems:N,availablePreorderDates:J,kitchen:m};console.log("[FoodDetailPage] Dispatching listing data:",{goGrabCount:D.length,preOrderCount:N.length,datesCount:J.length}),t(Ym(ae)),/iPad|iPhone|iPod/.test(navigator.userAgent)&&console.log("[FoodDetailPage] iOS device detected - listing data stored in Redux")}catch(D){console.error("[FoodDetailPage] Error processing listing data:",D),t(ua(!1))}},[m,g,l,t]),h.useEffect(()=>{console.log("pickupDate",j),console.log("pickupTime",E)},[j,E]),z?i.jsx("div",{className:"container",children:i.jsx("div",{className:"mobile-container",children:i.jsx(bf,{isLoading:z,text:"Loading food details...",overlay:!0,size:"medium"})})}):i.jsxs("div",{className:"container",children:[i.jsx("div",{className:"mobile-container",children:i.jsxs("div",{className:"product-detail",children:[i.jsxs("div",{className:"padding-20",children:[i.jsx("h2",{className:"title text-center",children:R==null?void 0:R.name}),i.jsxs("h2",{className:"text text-center",children:["By ",R==null?void 0:R.kitchenName]}),i.jsxs("div",{className:"review-info",children:[i.jsxs("div",{className:"left flex-0",children:[i.jsx("div",{children:i.jsx("svg",{width:"15",height:"14",viewBox:"0 0 15 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7499 4.80322L9.97336 4.26881L8.28761 0.940677C8.12458 0.667862 7.82468 0.5 7.50028 0.5C7.17588 0.5 6.87597 0.667862 6.71295 0.940677L5.02719 4.26966L1.25064 4.80322C0.920725 4.84924 0.64636 5.07363 0.543084 5.38188C0.439808 5.69013 0.525567 6.02868 0.764246 6.25497L3.49628 8.84616L2.85154 12.5053C2.79531 12.8246 2.93026 13.1472 3.19965 13.3375C3.46905 13.5279 3.82617 13.553 4.12089 13.4022L7.50028 11.6739L10.8779 13.4005C11.1726 13.5513 11.5298 13.5262 11.7992 13.3358C12.0685 13.1455 12.2035 12.8229 12.1473 12.5036L11.5025 8.84446L14.2363 6.25497C14.4744 6.02885 14.56 5.69094 14.4572 5.38312C14.3543 5.0753 14.0809 4.85087 13.7517 4.80407L13.7499 4.80322Z",fill:"#FBBC04"})})}),i.jsx("div",{className:"text",children:i.jsx("strong",{children:Y.toFixed(1)})})]}),i.jsx("div",{className:"line"}),i.jsxs("div",{className:"left flex-0",children:[i.jsx("div",{children:i.jsx("svg",{width:"14",height:"12",viewBox:"0 0 14 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M7.41337 11.8736C7.18671 11.9536 6.81337 11.9536 6.58671 11.8736C4.65337 11.2136 0.333374 8.46023 0.333374 3.79356C0.333374 1.73356 1.99337 0.0668945 4.04004 0.0668945C5.25337 0.0668945 6.32671 0.653561 7.00004 1.56023C7.67337 0.653561 8.75337 0.0668945 9.96004 0.0668945C12.0067 0.0668945 13.6667 1.73356 13.6667 3.79356C13.6667 8.46023 9.34671 11.2136 7.41337 11.8736Z",fill:"#FF5555"})})}),i.jsx("div",{className:"text",children:i.jsx("strong",{children:(ee=R==null?void 0:R.numOfLike)!=null?ee:0})})]}),i.jsx("div",{className:"line"}),i.jsxs("div",{className:"left flex-0",children:[i.jsx("div",{children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("path",{d:"M13.3067 5.9731C12.86 5.47977 12.1867 5.1931 11.2534 5.0931V4.58644C11.2534 3.6731 10.8667 2.7931 10.1867 2.17977C9.50003 1.5531 8.6067 1.25977 7.68003 1.34644C6.0867 1.49977 4.7467 3.03977 4.7467 4.70644V5.0931C3.81337 5.1931 3.14003 5.47977 2.69337 5.9731C2.0467 6.6931 2.0667 7.6531 2.14003 8.31977L2.6067 12.0331C2.7467 13.3331 3.27337 14.6664 6.14003 14.6664H9.86003C12.7267 14.6664 13.2534 13.3331 13.3934 12.0398L13.86 8.3131C13.9334 7.6531 13.9534 6.6931 13.3067 5.9731ZM7.77337 2.2731C8.44003 2.2131 9.07337 2.41977 9.5667 2.86644C10.0534 3.30644 10.3267 3.9331 10.3267 4.58644V5.0531H5.67337V4.70644C5.67337 3.51977 6.65337 2.37977 7.77337 2.2731ZM8.00003 12.3864C6.6067 12.3864 5.47337 11.2531 5.47337 9.85977C5.47337 8.46644 6.6067 7.3331 8.00003 7.3331C9.39337 7.3331 10.5267 8.46644 10.5267 9.85977C10.5267 11.2531 9.39337 12.3864 8.00003 12.3864Z",fill:"#3FC045"}),i.jsx("path",{d:"M7.62 11.0933C7.49334 11.0933 7.36667 11.0466 7.26667 10.9466L6.60667 10.2866C6.41334 10.0933 6.41334 9.7733 6.60667 9.57997C6.8 9.38664 7.12 9.38664 7.31334 9.57997L7.63334 9.89997L8.7 8.9133C8.9 8.72664 9.22 8.73997 9.40667 8.93997C9.59334 9.13997 9.58 9.45997 9.38 9.64664L7.96 10.96C7.86 11.0466 7.74 11.0933 7.62 11.0933Z",fill:"#3FC045"})]})}),i.jsx("div",{className:"text",children:i.jsx("strong",{children:(M=R==null?void 0:R.numOfSoldItem)!=null?M:0})})]}),i.jsx("div",{className:"line"}),i.jsxs("div",{className:"left",children:[i.jsx("div",{children:i.jsxs("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("path",{d:"M10.1667 6.00016C10.1667 6.92063 9.42051 7.66683 8.50004 7.66683C7.57957 7.66683 6.83337 6.92063 6.83337 6.00016C6.83337 5.07969 7.57957 4.3335 8.50004 4.3335C9.42051 4.3335 10.1667 5.07969 10.1667 6.00016Z",stroke:"#3FC045"}),i.jsx("path",{d:"M12.6481 11.3335C13.5778 12.6592 14.0225 13.3652 13.7576 13.9334C13.731 13.9904 13.6999 14.0454 13.6646 14.098C13.2816 14.6668 12.2916 14.6668 10.3118 14.6668H6.68811C4.7083 14.6668 3.71839 14.6668 3.33536 14.098C3.29999 14.0454 3.26888 13.9904 3.24232 13.9334C2.97742 13.3652 3.42213 12.6592 4.35181 11.3335",stroke:"#3FC045",strokeLinecap:"round",strokeLinejoin:"round"}),i.jsx("path",{d:"M9.33831 11.6626C9.11344 11.8791 8.81291 12.0002 8.50017 12.0002C8.18737 12.0002 7.88684 11.8791 7.66197 11.6626C5.60291 9.66736 2.8435 7.4385 4.18918 4.20265C4.91677 2.45304 6.66333 1.3335 8.50017 1.3335C10.337 1.3335 12.0835 2.45305 12.8111 4.20265C14.1551 7.43443 11.4024 9.67423 9.33831 11.6626Z",stroke:"#3FC045"})]})}),i.jsx("div",{className:"text",children:(w==null?void 0:w.address)||"Unknown location"})]})]}),i.jsx(wf,{food:R,isLiked:V,handleLikeToggle:X}),i.jsxs("div",{className:"quantity-warpper",children:[i.jsxs("div",{className:"price",style:{display:"flex",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("span",{className:"currency",children:"$"}),(R==null?void 0:R.cost)&&parseFloat(R==null?void 0:R.cost).toFixed(2)]}),oe<4&&i.jsx("div",{className:"availability-status",children:oe===0?i.jsx("span",{className:"status sold-out",children:"Sold Out"}):oe<=3?i.jsxs("span",{className:"status low-stock",children:[oe," left"]}):null})]}),i.jsx(Yt,{food:R,kitchen:w,selectedDate:j||d&&Q(d,"M/D/YYYY").format("YYYY-MM-DD"),minQuantity:0,onAvailabilityChange:fe,size:"large",className:"food-detail-quantity",orderType:Z})]}),i.jsx("div",{className:"pickup-details",children:i.jsx(In,{food:R,kitchen:w,orderType:Z,selectedDate:j,selectedTime:E,onDateChange:L=>{O(L),s({food:R,kitchen:w,newQuantity:b,currentQuantity:ne,selectedDate:L,selectedTime:E,specialInstructions:k,incomingOrderType:Z})},onTimeChange:L=>{$(L),s({food:R,kitchen:w,newQuantity:b,currentQuantity:ne,selectedDate:j,selectedTime:L,specialInstructions:k,incomingOrderType:Z})},disabled:!R||!w,className:"food-detail-picker"})})]}),i.jsxs("div",{className:"padding-20",children:[i.jsx("h3",{className:"small-title mb-8",children:"Special Request"}),i.jsx("textarea",{className:"special-instructions-input",placeholder:"Share you preference or things to avoid (e.g. peanuts, cilantro).",value:k,onChange:L=>A(L.target.value),rows:2,style:{width:"100%",padding:"12px",border:"1px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",fontFamily:"inherit",resize:"vertical",marginBottom:"10px"}}),i.jsxs("div",{className:"add-to-cart-action mt-2",children:[i.jsx("button",{className:`button text-bold font-size-18 ${B.isAvailable?"":"sold-out"}`,onClick:L=>{B.isAvailable||alert("♡ this food to the chef that we want it! When it is added to Go&Grab or Pre-Order, you will be notified."),localStorage.setItem("skipListing","true"),r("/order")},disabled:!B.isAvailable,style:{pointerEvents:"auto",fontSize:"18px",width:"200px"},children:!B.isAvailable||oe===0?"Sold Out!":"Add to Cart"}),i.jsx("button",{className:"button text-bold font-size-18",onClick:L=>{console.log("e",L);const D=new URLSearchParams({kitchenId:l||"",foodId:c||"",...d&&{date:d}}).toString();r("/foods",{replace:!0,state:{from:{pathname:n.pathname,search:n.search,fullUrl:`/share?${D}`}}})},style:{pointerEvents:"auto",fontSize:"18px",width:"200px",background:"#fd9a00"},children:"Show Me The Menu"})]}),i.jsxs("div",{className:"custom-accordian",children:[i.jsx("button",{className:`button${p==="description"?" active":""}`,onClick:()=>y("description"),children:"Description"}),i.jsx("button",{className:`button${p==="reviews"?" active":""}`,onClick:()=>y("reviews"),children:"Reviews"})]}),i.jsxs("div",{className:"accordian-content",children:[p==="description"&&i.jsx("div",{className:"description-content",children:(R==null?void 0:R.description)||"No description available."}),p==="reviews"&&i.jsxs("div",{className:"reviews-content",children:[i.jsxs("div",{className:"overall-reviews",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"bold",children:Y>0?Y.toFixed(1):"0"}),i.jsx(ga,{rating:Y,size:"small",showRating:!1}),i.jsxs("div",{className:"body-text",children:["(",G,"+ reviews)"]})]}),i.jsx("div",{className:"line"}),i.jsx("div",{className:"right",children:[5,4,3,2,1].map(L=>i.jsxs("div",{className:"review",children:[i.jsx("div",{className:"text",children:L}),i.jsx("div",{className:"progress-bar",children:i.jsx("div",{className:"fill",style:{width:`${T[L]}%`}})})]},L))})]}),i.jsx("div",{className:"reviews-list",children:q.map((L,D)=>i.jsxs("div",{className:"review-item",children:[i.jsxs("div",{className:"header",children:[i.jsxs("div",{className:"profile",children:[i.jsx("img",{src:L.image,alt:L.name,className:"image"}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"name",children:L.name}),i.jsx("div",{className:"rating",children:i.jsx(ga,{rating:L.rating||5,size:"small",showRating:!1})}),i.jsx("div",{className:"date",children:L.date})]})]}),i.jsx("div",{className:"icon"})]}),i.jsx("div",{className:"description",children:L.description})]},L.id||D))})]})]})]})]})}),x&&i.jsx(Do,{onClose:()=>_(!1)})]})}function kf(){const e=St(),t=it(),n=Kt(),r=Se(j=>j.cart.items),{getCartQuantity:a}=At(),[s,o]=h.useState(new Set),[l,c]=h.useState(!1);h.useEffect(()=>{var j;if((j=n.state)!=null&&j.editItem){const O=n.state.editItem;o(new Set([O])),window.history.replaceState({},document.title)}},[n.state]);const d=r.length>0?r[0].kitchenId:null,{kitchen:u,foods:m,loading:g}=So(d);console.log("OrderPage - Kitchen data:",{kitchenId:d,hasKitchen:!!u,foodsCount:m.length,kitchenLoading:g});const p=h.useMemo(()=>{const j=new Map;return m.forEach(O=>{j.set(O.id,O)}),j},[m]),y=h.useCallback((j,O=null,E)=>a(j,O,E),[a]),b=j=>{var $,B,W,R;const O=p.get(j.foodId);if(console.log(`OrderPage - Getting food data for ${j.foodId}:`,{hasFullData:!!O,fullFoodData:O?{id:O.id,name:O.name,availability:O.availability,numAvailable:O.numAvailable}:null}),O)return O;const E={id:j.foodId,name:($=j.food)==null?void 0:$.name,cost:(B=j.food)==null?void 0:B.cost,imageUrl:(W=j.food)==null?void 0:W.imageUrl,kitchenId:j.kitchenId,description:(R=j.food)==null?void 0:R.description,availability:{numAvailable:99},numAvailable:99};return console.log(`OrderPage - Using fallback data for ${j.foodId}:`,E),E},f=h.useMemo(()=>{const j={grabAndGo:[],preOrders:{}};r.forEach(E=>{var B,W,R,w,P,F,I,z;const $=((B=E.pickupDetails)==null?void 0:B.orderType)||E.orderType||(E.isPreOrder?"PRE_ORDER":"GO_GRAB");if($==="GO_GRAB"||$==="Go&Grab")j.grabAndGo.push({...E,displayPickupTime:((W=E.pickupDetails)==null?void 0:W.display)||"Pick up today",displayPickupClock:((R=E.pickupDetails)==null?void 0:R.time)||Q().add(30,"minutes").format("h:mm A")});else if($==="PRE_ORDER"||$==="Pre-Order"||E.isPreOrder||E.selectedDate){const H=E.selectedDate||((w=E.pickupDetails)==null?void 0:w.date);H&&(j.preOrders[H]||(j.preOrders[H]=[]),j.preOrders[H].push({...E,displayPickupTime:((P=E.pickupDetails)==null?void 0:P.display)||`Pick up ${Q(H).format("MMM D ddd")}`,displayPickupClock:((F=E.pickupDetails)==null?void 0:F.time)||"6:30 PM"}))}else j.grabAndGo.push({...E,displayPickupTime:((I=E.pickupDetails)==null?void 0:I.display)||"Pick up today",displayPickupClock:((z=E.pickupDetails)==null?void 0:z.time)||Q().add(30,"minutes").format("h:mm A")})});const O={};return Object.keys(j.preOrders).sort((E,$)=>Q(E).diff(Q($))).forEach(E=>{O[E]=j.preOrders[E]}),j.preOrders=O,j},[r]),k=h.useMemo(()=>{const j=r.reduce(($,B)=>{var P,F,I;const W=p.get(B.foodId),R=(W==null?void 0:W.cost)||((P=B.food)==null?void 0:P.cost)||0,w=typeof R=="string"?parseFloat(R):R;return console.log(`OrderPage - Pricing calculation for ${B.foodId}:`,{itemName:(F=B.food)==null?void 0:F.name,quantity:B.quantity,originalCost:(I=B.food)==null?void 0:I.cost,enrichedCost:W==null?void 0:W.cost,finalCost:w,lineTotal:w*B.quantity}),$+w*B.quantity},0),O=j*0,E=j+O;return console.log("OrderPage - Total calculation:",{subtotal:j.toFixed(2),tax:O.toFixed(2),total:E.toFixed(2),cartItemsCount:r.length}),{subtotal:j.toFixed(2),tax:O.toFixed(2),total:E.toFixed(2)}},[r,p]),A=()=>{c(!0)},C=()=>{t(Kn()),Ae.info("Cart cleared successfully"),c(!1)},v=()=>{c(!1)},x=j=>Q(j).format("MMM D ddd"),S=()=>{if(localStorage.getItem("skipListing")==="true"){localStorage.removeItem("skipListing"),console.log("Skipping listing page, going back to home");const O=localStorage.getItem("detailPage");if(O){console.log("Going back to detailPage from localStorage:",O),window.location.href=O;return}return}e("/foods")},_=(r==null?void 0:r.length)||0;return i.jsxs("div",{className:"container",children:[i.jsx("div",{className:"mobile-container",children:i.jsxs("div",{className:"padding-20",children:[i.jsxs("div",{className:"back-link-title",children:[i.jsx(wt,{className:"back-link",onClick:S,children:i.jsx("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M7.94194 0.51631C8.18602 0.760388 8.18602 1.15612 7.94194 1.40019L2.34222 6.99992L7.94194 12.5996C8.18602 12.8437 8.18602 13.2394 7.94194 13.4835C7.69786 13.7276 7.30214 13.7276 7.05806 13.4835L1.01639 7.44186C0.772315 7.19778 0.772315 6.80205 1.01639 6.55798L7.05806 0.51631C7.30214 0.272233 7.69786 0.272233 7.94194 0.51631Z",fill:"#212226"})})}),i.jsx("div",{className:"title",children:"Order"})]}),i.jsxs("div",{className:"order-count",children:[i.jsxs("div",{children:[_," Item",_!==1?"s":""," in Cart"]}),i.jsx("div",{children:i.jsx(wt,{style:{color:"#3fc045"},onClick:A,children:"Remove all"})})]}),r.length===0?i.jsxs("div",{className:"text-center py-5",children:[i.jsx("p",{children:"Your cart is empty"}),i.jsx(wt,{to:"/foods",className:"action-button",style:{textDecoration:"none",display:"inline-block",padding:"12px 24px",marginTop:"16px"},children:"Continue Shopping"})]}):i.jsxs(i.Fragment,{children:[f.grabAndGo.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"small-title mb-20",children:"Go&Grab"}),i.jsx("div",{className:"menu-listing",children:f.grabAndGo.map((j,O)=>{var $,B,W,R,w;const E=y(j.foodId,null,"GO_GRAB");return i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:(($=j.food)==null?void 0:$.imageUrl)||"/src/assets/images/product.png",alt:((B=j.food)==null?void 0:B.name)||"Food item",onError:P=>{P.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:((W=j.food)==null?void 0:W.name)||"Unknown Item"}),i.jsx("div",{className:"text",children:((R=j.food)==null?void 0:R.description)||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",((w=j.food)==null?void 0:w.cost)||"0.00"]})]})]}),i.jsxs("div",{className:"quantity-warpper",children:[i.jsx("div",{className:"right mb-1",children:i.jsx(Yt,{food:b(j),kitchen:u||j.kitchen,selectedDate:null,size:"small",initialQuantity:E,minQuantity:0,orderType:"GO_GRAB"})}),i.jsxs("div",{className:"title",children:[j.selectedDate?Q(j.selectedDate).format("MMMM D, YYYY"):Q().format("MMMM D, YYYY")," "]}),i.jsx("div",{className:"bottom",children:i.jsxs("div",{className:"time",children:["at"," ",j!=null&&j.selectedTime?Q(j==null?void 0:j.selectedTime,"h:mm A").format("h:mm A"):"5:30 PM"]})})]})]},`grab-${j.foodId}-${O}`)})})]}),Object.entries(f.preOrders).map(([j,O])=>i.jsxs("div",{children:[i.jsxs("h2",{className:"small-title mb-16",children:["Pre-order for ",x(j)]}),i.jsx("div",{className:"menu-listing",children:O.map((E,$)=>{var W,R,w,P,F;const B=y(E.foodId,j,"PRE_ORDER");return i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:((W=E.food)==null?void 0:W.imageUrl)||"/src/assets/images/product.png",alt:((R=E.food)==null?void 0:R.name)||"Food item",onError:I=>{I.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:((w=E.food)==null?void 0:w.name)||"Unknown Item"}),i.jsx("div",{className:"text",children:((P=E.food)==null?void 0:P.description)||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",((F=E.food)==null?void 0:F.cost)||"0.00"]})]})]}),i.jsxs("div",{className:"quantity-warpper",children:[i.jsx("div",{className:"right mb-1",children:i.jsx(Yt,{food:b(E),kitchen:u||E.kitchen,selectedDate:j,size:"small",initialQuantity:B,minQuantity:0,orderType:"PRE_ORDER"})}),i.jsxs("div",{className:"title",children:[Q(E.selectedDate).format("MMMM D, YYYY")," "]}),i.jsx("div",{className:"bottom",children:i.jsxs("div",{className:"time",children:["at"," ",E!=null&&E.selectedTime?Q(E==null?void 0:E.selectedTime,"h:mm A").format("h:mm A"):"5:30 PM"]})})]})]},`preorder-${E.foodId}-${j}-${$}`)})})]},j)),i.jsxs("div",{className:"order-summary",style:{backgroundColor:"#f8f9fa",padding:"16px",borderRadius:"8px",marginTop:"24px",marginBottom:"16px"},children:[i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsxs("span",{children:["Subtotal (",_," item",_!==1?"s":"","):"]}),i.jsxs("span",{children:["$",k.subtotal]})]}),i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsx("span",{children:"Tax (0%):"}),i.jsxs("span",{children:["$",k.tax]})]}),i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",fontWeight:"600",fontSize:"16px",borderTop:"1px solid #dee2e6",paddingTop:"8px"},children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",k.total]})]})]}),i.jsx("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:i.jsx("button",{className:"action-button",onClick:()=>e("/checkout"),style:{flex:"2"},children:"Check Out"})})]})]})}),l&&i.jsx("div",{className:"modal-overlay",onClick:v,children:i.jsxs("div",{className:"modal-content",onClick:j=>j.stopPropagation(),children:[i.jsx("div",{className:"modal-header",children:i.jsx("h3",{children:"Remove All Items"})}),i.jsx("div",{className:"modal-body",children:i.jsx("p",{children:"Are you sure you want to remove all items from your cart? This action cannot be undone."})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn-secondary",onClick:v,style:{padding:"10px 20px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"white",cursor:"pointer",width:"100%"},children:"Cancel"}),i.jsx("button",{className:"btn-danger",onClick:C,style:{padding:"10px 20px",border:"none",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",cursor:"pointer",width:"100%"},children:"Remove All"})]})]})})]})}var yr={exports:{}},br,xa;function jf(){if(xa)return br;xa=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return br=e,br}var wr,ya;function Rf(){if(ya)return wr;ya=1;var e=jf();function t(){}function n(){}return n.resetWarningCache=t,wr=function(){function r(o,l,c,d,u,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return s.PropTypes=s,s},wr}var ba;function Cf(){return ba||(ba=1,yr.exports=Rf()()),yr.exports}var Sf=Cf();const pe=gt(Sf),Df=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Ct(e,t,n){const r=Ef(e),{webkitRelativePath:a}=e,s=typeof t=="string"?t:typeof a=="string"&&a.length>0?a:`./${e.name}`;return typeof r.path!="string"&&wa(r,"path",s),wa(r,"relativePath",s),r}function Ef(e){const{name:t}=e;if(t&&t.lastIndexOf(".")!==-1&&!e.type){const r=t.split(".").pop().toLowerCase(),a=Df.get(r);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}function wa(e,t,n){Object.defineProperty(e,t,{value:n,writable:!1,configurable:!1,enumerable:!0})}const Af=[".DS_Store","Thumbs.db"];function Lf(e){return vt(this,void 0,void 0,function*(){return Tn(e)&&_f(e.dataTransfer)?Pf(e.dataTransfer,e.type):Of(e)?If(e):Array.isArray(e)&&e.every(t=>"getFile"in t&&typeof t.getFile=="function")?Tf(e):[]})}function _f(e){return Tn(e)}function Of(e){return Tn(e)&&Tn(e.target)}function Tn(e){return typeof e=="object"&&e!==null}function If(e){return Wr(e.target.files).map(t=>Ct(t))}function Tf(e){return vt(this,void 0,void 0,function*(){return(yield Promise.all(e.map(n=>n.getFile()))).map(n=>Ct(n))})}function Pf(e,t){return vt(this,void 0,void 0,function*(){if(e.items){const n=Wr(e.items).filter(a=>a.kind==="file");if(t!=="drop")return n;const r=yield Promise.all(n.map(Nf));return ka(Eo(r))}return ka(Wr(e.files).map(n=>Ct(n)))})}function ka(e){return e.filter(t=>Af.indexOf(t.name)===-1)}function Wr(e){if(e===null)return[];const t=[];for(let n=0;n<e.length;n++){const r=e[n];t.push(r)}return t}function Nf(e){if(typeof e.webkitGetAsEntry!="function")return ja(e);const t=e.webkitGetAsEntry();return t&&t.isDirectory?Ao(t):ja(e,t)}function Eo(e){return e.reduce((t,n)=>[...t,...Array.isArray(n)?Eo(n):[n]],[])}function ja(e,t){return vt(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const s=yield e.getAsFileSystemHandle();if(s===null)throw new Error(`${e} is not a File`);if(s!==void 0){const o=yield s.getFile();return o.handle=s,Ct(o)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return Ct(r,(n=t==null?void 0:t.fullPath)!==null&&n!==void 0?n:void 0)})}function Ff(e){return vt(this,void 0,void 0,function*(){return e.isDirectory?Ao(e):$f(e)})}function Ao(e){const t=e.createReader();return new Promise((n,r)=>{const a=[];function s(){t.readEntries(o=>vt(this,void 0,void 0,function*(){if(o.length){const l=Promise.all(o.map(Ff));a.push(l),s()}else try{const l=yield Promise.all(a);n(l)}catch(l){r(l)}}),o=>{r(o)})}s()})}function $f(e){return vt(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.file(r=>{const a=Ct(r,e.fullPath);t(a)},r=>{n(r)})})})}var ln={},Ra;function Mf(){return Ra||(Ra=1,ln.__esModule=!0,ln.default=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(",");if(n.length===0)return!0;var r=e.name||"",a=(e.type||"").toLowerCase(),s=a.replace(/\/.*$/,"");return n.some(function(o){var l=o.trim().toLowerCase();return l.charAt(0)==="."?r.toLowerCase().endsWith(l):l.endsWith("/*")?s===l.replace(/\/.*$/,""):a===l})}return!0}),ln}var Uf=Mf();const kr=gt(Uf);function Ca(e){return Bf(e)||qf(e)||_o(e)||zf()}function zf(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qf(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bf(e){if(Array.isArray(e))return Yr(e)}function Sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Da(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sa(Object(n),!0).forEach(function(r){Lo(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Lo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gt(e,t){return Gf(e)||Yf(e,t)||_o(e,t)||Wf()}function Wf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _o(e,t){if(e){if(typeof e=="string")return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yr(e,t)}}function Yr(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yf(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],a=!0,s=!1,o,l;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw l}}return r}}function Gf(e){if(Array.isArray(e))return e}var Kf=typeof kr=="function"?kr:kr.default,Hf="file-invalid-type",Qf="file-too-large",Vf="file-too-small",Zf="too-many-files",Jf=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=t.split(","),r=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:Hf,message:"File type must be ".concat(r)}},Ea=function(t){return{code:Qf,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},Aa=function(t){return{code:Vf,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},Xf={code:Zf,message:"Too many files"};function Oo(e,t){var n=e.type==="application/x-moz-file"||Kf(e,t);return[n,n?null:Jf(t)]}function Io(e,t,n){if(lt(e.size))if(lt(t)&&lt(n)){if(e.size>n)return[!1,Ea(n)];if(e.size<t)return[!1,Aa(t)]}else{if(lt(t)&&e.size<t)return[!1,Aa(t)];if(lt(n)&&e.size>n)return[!1,Ea(n)]}return[!0,null]}function lt(e){return e!=null}function eh(e){var t=e.files,n=e.accept,r=e.minSize,a=e.maxSize,s=e.multiple,o=e.maxFiles,l=e.validator;return!s&&t.length>1||s&&o>=1&&t.length>o?!1:t.every(function(c){var d=Oo(c,n),u=Gt(d,1),m=u[0],g=Io(c,r,a),p=Gt(g,1),y=p[0],b=l?l(c):null;return m&&y&&!b})}function Pn(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble!="undefined"?e.cancelBubble:!1}function cn(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function La(e){e.preventDefault()}function th(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function nh(e){return e.indexOf("Edge/")!==-1}function rh(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return th(e)||nh(e)}function qe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return t.some(function(l){return!Pn(r)&&l&&l.apply(void 0,[r].concat(s)),Pn(r)})}}function ih(){return"showOpenFilePicker"in window}function ah(e){if(lt(e)){var t=Object.entries(e).filter(function(n){var r=Gt(n,2),a=r[0],s=r[1],o=!0;return To(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(s)||!s.every(Po))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(n,r){var a=Gt(r,2),s=a[0],o=a[1];return Da(Da({},n),{},Lo({},s,o))},{});return[{description:"Files",accept:t}]}return e}function sh(e){if(lt(e))return Object.entries(e).reduce(function(t,n){var r=Gt(n,2),a=r[0],s=r[1];return[].concat(Ca(t),[a],Ca(s))},[]).filter(function(t){return To(t)||Po(t)}).join(",")}function oh(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function lh(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function To(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function Po(e){return/^.*\.[\w]+$/.test(e)}var ch=["children"],dh=["open"],uh=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],ph=["refKey","onChange","onClick"];function mh(e){return gh(e)||hh(e)||No(e)||fh()}function fh(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hh(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gh(e){if(Array.isArray(e))return Gr(e)}function jr(e,t){return yh(e)||xh(e,t)||No(e,t)||vh()}function vh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function No(e,t){if(e){if(typeof e=="string")return Gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gr(e,t)}}function Gr(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xh(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],a=!0,s=!1,o,l;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw l}}return r}}function yh(e){if(Array.isArray(e))return e}function _a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_a(Object(n),!0).forEach(function(r){Kr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Kr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nn(e,t){if(e==null)return{};var n=bh(e,t),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bh(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,s;for(s=0;s<r.length;s++)a=r[s],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}var vi=h.forwardRef(function(e,t){var n=e.children,r=Nn(e,ch),a=$o(r),s=a.open,o=Nn(a,dh);return h.useImperativeHandle(t,function(){return{open:s}},[s]),Fn.createElement(h.Fragment,null,n(he(he({},o),{},{open:s})))});vi.displayName="Dropzone";var Fo={disabled:!1,getFilesFromEvent:Lf,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};vi.defaultProps=Fo;vi.propTypes={children:pe.func,accept:pe.objectOf(pe.arrayOf(pe.string)),multiple:pe.bool,preventDropOnDocument:pe.bool,noClick:pe.bool,noKeyboard:pe.bool,noDrag:pe.bool,noDragEventsBubbling:pe.bool,minSize:pe.number,maxSize:pe.number,maxFiles:pe.number,disabled:pe.bool,getFilesFromEvent:pe.func,onFileDialogCancel:pe.func,onFileDialogOpen:pe.func,useFsAccessApi:pe.bool,autoFocus:pe.bool,onDragEnter:pe.func,onDragLeave:pe.func,onDragOver:pe.func,onDrop:pe.func,onDropAccepted:pe.func,onDropRejected:pe.func,onError:pe.func,validator:pe.func};var Hr={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function $o(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=he(he({},Fo),e),n=t.accept,r=t.disabled,a=t.getFilesFromEvent,s=t.maxSize,o=t.minSize,l=t.multiple,c=t.maxFiles,d=t.onDragEnter,u=t.onDragLeave,m=t.onDragOver,g=t.onDrop,p=t.onDropAccepted,y=t.onDropRejected,b=t.onFileDialogCancel,f=t.onFileDialogOpen,k=t.useFsAccessApi,A=t.autoFocus,C=t.preventDropOnDocument,v=t.noClick,x=t.noKeyboard,S=t.noDrag,_=t.noDragEventsBubbling,j=t.onError,O=t.validator,E=h.useMemo(function(){return sh(n)},[n]),$=h.useMemo(function(){return ah(n)},[n]),B=h.useMemo(function(){return typeof f=="function"?f:Oa},[f]),W=h.useMemo(function(){return typeof b=="function"?b:Oa},[b]),R=h.useRef(null),w=h.useRef(null),P=h.useReducer(wh,Hr),F=jr(P,2),I=F[0],z=F[1],H=I.isFocused,V=I.isFileDialogActive,ie=h.useRef(typeof window!="undefined"&&window.isSecureContext&&k&&ih()),Z=function(){!ie.current&&V&&setTimeout(function(){if(w.current){var K=w.current.files;K.length||(z({type:"closeDialog"}),W())}},300)};h.useEffect(function(){return window.addEventListener("focus",Z,!1),function(){window.removeEventListener("focus",Z,!1)}},[w,V,W,ie]);var ne=h.useRef([]),oe=function(K){R.current&&R.current.contains(K.target)||(K.preventDefault(),ne.current=[])};h.useEffect(function(){return C&&(document.addEventListener("dragover",La,!1),document.addEventListener("drop",oe,!1)),function(){C&&(document.removeEventListener("dragover",La),document.removeEventListener("drop",oe))}},[R,C]),h.useEffect(function(){return!r&&A&&R.current&&R.current.focus(),function(){}},[R,A,r]);var fe=h.useCallback(function(U){j?j(U):console.error(U)},[j]),Y=h.useCallback(function(U){U.preventDefault(),U.persist(),ce(U),ne.current=[].concat(mh(ne.current),[U.target]),cn(U)&&Promise.resolve(a(U)).then(function(K){if(!(Pn(U)&&!_)){var re=K.length,ye=re>0&&eh({files:K,accept:E,minSize:o,maxSize:s,multiple:l,maxFiles:c,validator:O}),Ee=re>0&&!ye;z({isDragAccept:ye,isDragReject:Ee,isDragActive:!0,type:"setDraggedFiles"}),d&&d(U)}}).catch(function(K){return fe(K)})},[a,d,fe,_,E,o,s,l,c,O]),G=h.useCallback(function(U){U.preventDefault(),U.persist(),ce(U);var K=cn(U);if(K&&U.dataTransfer)try{U.dataTransfer.dropEffect="copy"}catch(re){}return K&&m&&m(U),!1},[m,_]),T=h.useCallback(function(U){U.preventDefault(),U.persist(),ce(U);var K=ne.current.filter(function(ye){return R.current&&R.current.contains(ye)}),re=K.indexOf(U.target);re!==-1&&K.splice(re,1),ne.current=K,!(K.length>0)&&(z({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),cn(U)&&u&&u(U))},[R,u,_]),q=h.useCallback(function(U,K){var re=[],ye=[];U.forEach(function(Ee){var Xe=Oo(Ee,E),xt=jr(Xe,2),Qn=xt[0],Vn=xt[1],Zn=Io(Ee,o,s),Vt=jr(Zn,2),Jn=Vt[0],Xn=Vt[1],er=O?O(Ee):null;if(Qn&&Jn&&!er)re.push(Ee);else{var tr=[Vn,Xn];er&&(tr=tr.concat(er)),ye.push({file:Ee,errors:tr.filter(function(Mo){return Mo})})}}),(!l&&re.length>1||l&&c>=1&&re.length>c)&&(re.forEach(function(Ee){ye.push({file:Ee,errors:[Xf]})}),re.splice(0)),z({acceptedFiles:re,fileRejections:ye,isDragReject:ye.length>0,type:"setFiles"}),g&&g(re,ye,K),ye.length>0&&y&&y(ye,K),re.length>0&&p&&p(re,K)},[z,l,E,o,s,c,g,p,y,O]),X=h.useCallback(function(U){U.preventDefault(),U.persist(),ce(U),ne.current=[],cn(U)&&Promise.resolve(a(U)).then(function(K){Pn(U)&&!_||q(K,U)}).catch(function(K){return fe(K)}),z({type:"reset"})},[a,q,fe,_]),ee=h.useCallback(function(){if(ie.current){z({type:"openDialog"}),B();var U={multiple:l,types:$};window.showOpenFilePicker(U).then(function(K){return a(K)}).then(function(K){q(K,null),z({type:"closeDialog"})}).catch(function(K){oh(K)?(W(K),z({type:"closeDialog"})):lh(K)?(ie.current=!1,w.current?(w.current.value=null,w.current.click()):fe(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):fe(K)});return}w.current&&(z({type:"openDialog"}),B(),w.current.value=null,w.current.click())},[z,B,W,k,q,fe,$,l]),M=h.useCallback(function(U){!R.current||!R.current.isEqualNode(U.target)||(U.key===" "||U.key==="Enter"||U.keyCode===32||U.keyCode===13)&&(U.preventDefault(),ee())},[R,ee]),L=h.useCallback(function(){z({type:"focus"})},[]),D=h.useCallback(function(){z({type:"blur"})},[]),N=h.useCallback(function(){v||(rh()?setTimeout(ee,0):ee())},[v,ee]),J=function(K){return r?null:K},ae=function(K){return x?null:J(K)},te=function(K){return S?null:J(K)},ce=function(K){_&&K.stopPropagation()},se=h.useMemo(function(){return function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},K=U.refKey,re=K===void 0?"ref":K,ye=U.role,Ee=U.onKeyDown,Xe=U.onFocus,xt=U.onBlur,Qn=U.onClick,Vn=U.onDragEnter,Zn=U.onDragOver,Vt=U.onDragLeave,Jn=U.onDrop,Xn=Nn(U,uh);return he(he(Kr({onKeyDown:ae(qe(Ee,M)),onFocus:ae(qe(Xe,L)),onBlur:ae(qe(xt,D)),onClick:J(qe(Qn,N)),onDragEnter:te(qe(Vn,Y)),onDragOver:te(qe(Zn,G)),onDragLeave:te(qe(Vt,T)),onDrop:te(qe(Jn,X)),role:typeof ye=="string"&&ye!==""?ye:"presentation"},re,R),!r&&!x?{tabIndex:0}:{}),Xn)}},[R,M,L,D,N,Y,G,T,X,x,S,r]),de=h.useCallback(function(U){U.stopPropagation()},[]),we=h.useMemo(function(){return function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},K=U.refKey,re=K===void 0?"ref":K,ye=U.onChange,Ee=U.onClick,Xe=Nn(U,ph),xt=Kr({accept:E,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:J(qe(ye,X)),onClick:J(qe(Ee,de)),tabIndex:-1},re,w);return he(he({},xt),Xe)}},[w,n,l,X,r]);return he(he({},I),{},{isFocused:H&&!r,getRootProps:se,getInputProps:we,rootRef:R,inputRef:w,open:J(ee)})}function wh(e,t){switch(t.type){case"focus":return he(he({},e),{},{isFocused:!0});case"blur":return he(he({},e),{},{isFocused:!1});case"openDialog":return he(he({},Hr),{},{isFileDialogActive:!0});case"closeDialog":return he(he({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return he(he({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return he(he({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return he({},Hr);default:return e}}function Oa(){}const Ia="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.16675%201.66699H7.50008C3.33341%201.66699%201.66675%203.33366%201.66675%207.50033V12.5003C1.66675%2016.667%203.33341%2018.3337%207.50008%2018.3337H12.5001C16.6667%2018.3337%2018.3334%2016.667%2018.3334%2012.5003V10.8337'%20stroke='%233FC045'%20stroke-width='1.25'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M13.3668%202.51639L6.80014%209.08306C6.55014%209.33306%206.30014%209.82472%206.25014%2010.1831L5.89181%2012.6914C5.75848%2013.5997%206.40014%2014.2331%207.30848%2014.1081L9.81681%2013.7497C10.1668%2013.6997%2010.6585%2013.4497%2010.9168%2013.1997L17.4835%206.63306C18.6168%205.49972%2019.1501%204.18306%2017.4835%202.51639C15.8168%200.849722%2014.5001%201.38306%2013.3668%202.51639Z'%20stroke='%233FC045'%20stroke-width='1.25'%20stroke-miterlimit='10'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12.425%203.45801C12.9834%205.44967%2014.5417%207.00801%2016.5417%207.57467'%20stroke='%233FC045'%20stroke-width='1.25'%20stroke-miterlimit='10'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";var kh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const jh=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Rh=(e,t)=>{const n=h.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:l,...c},d)=>h.createElement("svg",{ref:d,...kh,width:a,height:a,stroke:r,strokeWidth:o?Number(s)*24/Number(a):s,className:`lucide lucide-${jh(e)}`,...c},[...t.map(([u,m])=>h.createElement(u,m)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${e}`,n};var xi=Rh;const Rr=xi("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Ch=xi("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Ta=xi("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Sh=async(e,t="payment-screenshots",n="anonymous")=>{try{if(!e)throw new Error("No file provided");if(!e.type.startsWith("image/"))throw new Error("File must be an image");const r=10*1024*1024;if(e.size>r)throw new Error("File size must be less than 10MB");const a=new Date().getTime(),s=e.name.split(".").pop()||"jpg",o=`${n}_${a}.${s}`,l=Qu(oo,`${t}/${o}`);console.log("Uploading file to Firebase Storage...");const c=await Ku(l,e),d=await Hu(c.ref);return console.log("File uploaded successfully:",d),d}catch(r){throw console.error("Error uploading file to Firebase Storage:",r),r}};var kn={exports:{}},Dh=kn.exports,Pa;function Eh(){return Pa||(Pa=1,(function(e,t){(function(n,r){e.exports=r()})(Dh,(function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(s,o,l){var c=o.prototype;l.utc=function(b){var f={date:b,utc:!0,args:arguments};return new o(f)},c.utc=function(b){var f=l(this.toDate(),{locale:this.$L,utc:!0});return b?f.add(this.utcOffset(),n):f},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var d=c.parse;c.parse=function(b){b.utc&&(this.$u=!0),this.$utils().u(b.$offset)||(this.$offset=b.$offset),d.call(this,b)};var u=c.init;c.init=function(){if(this.$u){var b=this.$d;this.$y=b.getUTCFullYear(),this.$M=b.getUTCMonth(),this.$D=b.getUTCDate(),this.$W=b.getUTCDay(),this.$H=b.getUTCHours(),this.$m=b.getUTCMinutes(),this.$s=b.getUTCSeconds(),this.$ms=b.getUTCMilliseconds()}else u.call(this)};var m=c.utcOffset;c.utcOffset=function(b,f){var k=this.$utils().u;if(k(b))return this.$u?0:k(this.$offset)?m.call(this):this.$offset;if(typeof b=="string"&&(b=(function(x){x===void 0&&(x="");var S=x.match(r);if(!S)return null;var _=(""+S[0]).match(a)||["-",0,0],j=_[0],O=60*+_[1]+ +_[2];return O===0?0:j==="+"?O:-O})(b),b===null))return this;var A=Math.abs(b)<=16?60*b:b,C=this;if(f)return C.$offset=A,C.$u=b===0,C;if(b!==0){var v=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(C=this.local().add(A+v,n)).$offset=A,C.$x.$localOffset=v}else C=this.utc();return C};var g=c.format;c.format=function(b){var f=b||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,f)},c.valueOf=function(){var b=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*b},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var p=c.toDate;c.toDate=function(b){return b==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var y=c.diff;c.diff=function(b,f,k){if(b&&this.$u===b.$u)return y.call(this,b,f,k);var A=this.local(),C=l(b).local();return y.call(A,C,f,k)}}}))})(kn)),kn.exports}var Ah=Eh();const Lh=gt(Ah);var jn={exports:{}},_h=jn.exports,Na;function Oh(){return Na||(Na=1,(function(e,t){(function(n,r){e.exports=r()})(_h,(function(){var n={year:0,month:1,day:2,hour:3,minute:4,second:5},r={};return function(a,s,o){var l,c=function(g,p,y){y===void 0&&(y={});var b=new Date(g),f=(function(k,A){A===void 0&&(A={});var C=A.timeZoneName||"short",v=k+"|"+C,x=r[v];return x||(x=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:k,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:C}),r[v]=x),x})(p,y);return f.formatToParts(b)},d=function(g,p){for(var y=c(g,p),b=[],f=0;f<y.length;f+=1){var k=y[f],A=k.type,C=k.value,v=n[A];v>=0&&(b[v]=parseInt(C,10))}var x=b[3],S=x===24?0:x,_=b[0]+"-"+b[1]+"-"+b[2]+" "+S+":"+b[4]+":"+b[5]+":000",j=+g;return(o.utc(_).valueOf()-(j-=j%1e3))/6e4},u=s.prototype;u.tz=function(g,p){g===void 0&&(g=l);var y,b=this.utcOffset(),f=this.toDate(),k=f.toLocaleString("en-US",{timeZone:g}),A=Math.round((f-new Date(k))/1e3/60),C=15*-Math.round(f.getTimezoneOffset()/15)-A;if(!Number(C))y=this.utcOffset(0,p);else if(y=o(k,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(C,!0),p){var v=y.utcOffset();y=y.add(b-v,"minute")}return y.$x.$timezone=g,y},u.offsetName=function(g){var p=this.$x.$timezone||o.tz.guess(),y=c(this.valueOf(),p,{timeZoneName:g}).find((function(b){return b.type.toLowerCase()==="timezonename"}));return y&&y.value};var m=u.startOf;u.startOf=function(g,p){if(!this.$x||!this.$x.$timezone)return m.call(this,g,p);var y=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return m.call(y,g,p).tz(this.$x.$timezone,!0)},o.tz=function(g,p,y){var b=y&&p,f=y||p||l,k=d(+o(),f);if(typeof g!="string")return o(g).tz(f);var A=(function(S,_,j){var O=S-60*_*1e3,E=d(O,j);if(_===E)return[O,_];var $=d(O-=60*(E-_)*1e3,j);return E===$?[O,E]:[S-60*Math.min(E,$)*1e3,Math.max(E,$)]})(o.utc(g,b).valueOf(),k,f),C=A[0],v=A[1],x=o(C).utcOffset(v);return x.$x.$timezone=f,x},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(g){l=g}}}))})(jn)),jn.exports}var Ih=Oh();const Th=gt(Ih);Q.extend(Lh);Q.extend(Th);const Ph=async e=>{var t,n,r,a,s;try{console.log("Placing order with data:",e);const o=await Ga(ge(le,"orders"),e);console.log("Order placed successfully with ID:",o.id),await Nt(o,{orderIDKey:o.id});for(const l of e.orderedFoodItems)try{if(l.orderType==="grabAndGo"){console.log("🏃 [ORDER SERVICE] Processing Go&Grab item..."),console.log("🏃 [ORDER SERVICE] Item details:",{foodItemId:l.foodItemId,quantity:l.quantity,quantityType:typeof l.quantity});let c=null,d=null;if(e.kitchenId){c=$e(le,"kitchens",e.kitchenId,"foodItems",l.foodItemId);try{d=await Ge(c)}catch(u){d=null}}if(!d||!d.exists()){c=$e(le,"foodItems",l.foodItemId);try{d=await Ge(c)}catch(u){console.log("error",u)}}if(d&&d.exists()){const u=d.data();console.log("📄 [ORDER SERVICE] Current food item data:",{documentId:l.foodItemId,exists:!0,foundIn:c.path,currentData:{numAvailable:u.numAvailable,numOfSoldItem:u.numOfSoldItem,name:u.name,allFields:Object.keys(u)}});const m=u.numOfSoldItem||0,g=u.numAvailable||0,p=parseInt(l.quantity),y=m+p,b=Math.max(0,g-p);if(console.log("📊 [ORDER SERVICE] Inventory calculation:",{currentSold:m,currentAvailable:g,orderQuantity:p,newSoldItems:y,newAvailableItems:b,calculation:`Sold: ${m} + ${p} = ${y}, Available: ${g} - ${p} = ${b}`}),isNaN(y)||isNaN(b)){const f=`Invalid calculation: newSoldItems=${y}, newAvailableItems=${b}`;throw new Error(f)}console.log("🔄 [ORDER SERVICE] Updating document with new values..."),await Nt(c,{numOfSoldItem:y,numAvailable:b})}else{const u=`Food item document not found: ${l.foodItemId}`;console.error(`❌ [ORDER SERVICE] ${u}`),console.error("❌ [ORDER SERVICE] Tried both paths:",[`kitchens/${e.kitchenId}/foodItems/${l.foodItemId}`,`foodItems/${l.foodItemId}`])}}else if(l.orderType==="preorder"){console.log("📅 [ORDER SERVICE] Processing PreOrder item...");const c=$e(le,"kitchens",e.kitchenId),d=(l.pickupDate instanceof Date,Q(l.pickupDate).format("YYYY-MM-DD"));console.log("📅 [ORDER SERVICE] PreOrder details:",{kitchenId:e.kitchenId,pickupDate:d,originalPickupDate:l.pickupDate,foodItemId:l.foodItemId,quantity:l.quantity});const u=await Ge(c);if(u.exists()){const m=u.data();console.log("🏪 [ORDER SERVICE] Kitchen data retrieved"),console.log("🏪 [ORDER SERVICE] PreorderSchedule structure:",{hasPreorderSchedule:!!m.preorderSchedule,hasDates:!!((t=m.preorderSchedule)!=null&&t.dates),availableDates:(n=m.preorderSchedule)!=null&&n.dates?Object.keys(m.preorderSchedule.dates):[]});const g=(a=(r=m.preorderSchedule)==null?void 0:r.dates)==null?void 0:a[d];if(console.log("📅 [ORDER SERVICE] Date schedule for",d,":",{exists:!!g,isArray:Array.isArray(g),length:(g==null?void 0:g.length)||0,items:(g==null?void 0:g.map(p=>({foodItemId:p.foodItemId,numOfAvailableItems:p.numOfAvailableItems,nameOfFood:p.nameOfFood})))||[]}),g&&Array.isArray(g)){const p=g.findIndex(y=>y.foodItemId===l.foodItemId);if(console.log("🔍 [ORDER SERVICE] Food item search:",{searchingForFoodId:l.foodItemId,foundAtIndex:p,totalItemsInSchedule:g.length}),p!==-1){const y=g[p],b=y.numOfAvailableItems||0,f=Math.max(0,b-l.quantity);console.log("📊 [ORDER SERVICE] Availability calculation:",{currentFoodItem:y,currentAvailable:b,orderedQuantity:l.quantity,newAvailable:f,calculation:`${b} - ${l.quantity} = ${f}`});const k={...y,numOfAvailableItems:y!=null&&y.isLimitedOrder?f:b};console.log("🔄 [ORDER SERVICE] Updated food item object:",k);const A=[...g];A[p]=k,console.log("📋 [ORDER SERVICE] Updated schedule array:",{originalLength:g.length,updatedLength:A.length,updatedIndex:p,updatedItem:A[p]});const C=`preorderSchedule.dates.${d}`;console.log("🔄 [ORDER SERVICE] Updating Firestore:",{updatePath:C,dataToUpdate:A}),await Nt(c,{[C]:A}),console.log(`✅ [ORDER SERVICE] Updated PreOrder for food ${l.foodItemId} on ${d}: available ${b} -> ${f} (ordered: ${l.quantity})`)}else{const y=`Food item ${l.foodItemId} not found in preorder schedule for ${d}`;console.warn(`⚠️ [ORDER SERVICE] ${y}`),console.warn("⚠️ [ORDER SERVICE] Available food items in schedule:",g.map(b=>({foodItemId:b.foodItemId,nameOfFood:b.nameOfFood})))}}else{const p=`No preorder schedule found for date ${d}`;console.warn(`⚠️ [ORDER SERVICE] ${p}`),console.warn("⚠️ [ORDER SERVICE] Available dates:",(s=m.preorderSchedule)!=null&&s.dates?Object.keys(m.preorderSchedule.dates):"No dates object")}}else{const m=`Kitchen document not found: ${e.kitchenId}`;console.error(`❌ [ORDER SERVICE] ${m}`)}}else{const c=`Unknown order type: ${l.orderType}`;console.warn(`⚠️ [ORDER SERVICE] ${c}`)}}catch(c){const d=`Could not update item ${l.foodItemId} (${l.orderType}): ${c.message}`;console.error(d,c)}return o.id}catch(o){throw console.error("Error placing order:",o),o}},Nh=()=>Math.floor(1e5+Math.random()*9e5).toString(),Fh=({cartItems:e,kitchenInfo:t,firebaseImageUrl:n,currentUser:r,paymentCalculation:a,groupedCartItems:s,paymentType:o})=>{var b;const l=new Date,c=Nh(),d=Object.keys(s.preOrders).length>0,u=s.grabAndGo.length>0;let m="grabAndGo";(d&&!u||d&&u)&&(m="preorder");let g=l;if(d){const f=Object.keys(s.preOrders);if(f.length>0){const k=f.sort()[0];g=new Date(k)}}console.log("kitchenInfo:",t);const p=e.map(f=>{var k,A,C,v,x,S,_,j,O,E,$,B,W,R;return{countRating:0,foodItemId:f.foodId||f.id,id:Fa(),imageUrl:((k=f.food)==null?void 0:k.imageUrl)||((A=f.food)==null?void 0:A.image)||"",isFromPreorder:((C=f.pickupDetails)==null?void 0:C.orderType)==="PRE_ORDER"||f.isPreOrder||!1,name:((v=f.food)==null?void 0:v.name)||"Unknown Item",numOfLike:((x=f.food)==null?void 0:x.numOfLike)||0,numOfSoldItem:((S=f.food)==null?void 0:S.numOfSoldItem)||0,numberOfAvailableItem:((_=f.food)==null?void 0:_.numberOfAvailableItem)||0,quantity:parseInt(f.quantity||1),orderStatus:"inProgress",orderType:f.pickupDetails.orderType==="PRE_ORDER"?"preorder":"grabAndGo",rating:0,specialInstructions:f.specialInstructions||"",preOrder:{availableTimes:[],foodItemId:f.foodId||f.id,id:Fa(),isLimitedOrder:((j=f==null?void 0:f.food)==null?void 0:j.isLimitedOrder)||!1,nameOfFood:((O=f.food)==null?void 0:O.name)||"Unknown Item",numOfAvailableItems:((E=f.food)==null?void 0:E.numberOfAvailableItem)||0,price:parseFloat((($=f.food)==null?void 0:$.cost)||((B=f.food)==null?void 0:B.price)||0)},price:parseFloat(((W=f.food)==null?void 0:W.cost)||((R=f.food)==null?void 0:R.price)||0),pickupDate:new Date(f.selectedDate),pickupTime:f.selectedTime||"4:30 PM",paymentType:o||"online"}});return{datePickedUp:g,datePlaced:l,kitchenId:(t==null?void 0:t.id)||(t==null?void 0:t.kitchenId)||((b=e[0])==null?void 0:b.kitchenId),kitchenName:t==null?void 0:t.name,orderID:c,orderIDKey:"",orderPaymentImage:n||"",orderStatus:"inProgress",orderTotalCoast:parseFloat(a.totalPayment),orderType:m,orderedFoodItems:p,paymentVia:{other:{}},pickUpAddress:t==null?void 0:t.address,userId:r==null?void 0:r.id,subtotal:parseFloat(a.subtotal),salesTax:parseFloat(a.salesTax),taxRate:.0725,paymentType:o||"online"}},Fa=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16).toUpperCase()});function $h(){var X,ee;const[e,t]=h.useState(null),[n,r]=h.useState(null),[a,s]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,m]=h.useState(!1),[g,p]=h.useState(!1),[y,b]=h.useState(null),[f,k]=h.useState(null),[A,C]=h.useState(null),[v,x]=h.useState(!1),[S,_]=h.useState("online"),{handleQuantityChange:j}=At(),O=St(),E=it(),$=Se(M=>M.cart.items),B=Se(M=>M.food.currentKitchen),W=Se(M=>M.auth.user),R=Se(M=>M.auth.isAuthenticated);h.useEffect(()=>{const L=new URLSearchParams(window.location.search).get("firebaseImageUrl");console.log("firebaseImageUrl from URL params:",L),L&&(s(L),t(L),window.history.replaceState({},document.title,window.location.pathname))},[]);const w=h.useMemo(()=>{var M,L;if(B){const D=B;if(console.log("kitchen",D),D)return{id:(D==null?void 0:D.id)||(D==null?void 0:D.ownerId)||"",name:(D==null?void 0:D.name)||"",address:(D==null?void 0:D.address)||"",latitude:((M=D==null?void 0:D.location)==null?void 0:M.lat)||(D==null?void 0:D.latitude)||41.5742,longitude:((L=D==null?void 0:D.location)==null?void 0:L.lng)||(D==null?void 0:D.longitude)||-70.6109,preorderSchedule:(D==null?void 0:D.preorderSchedule)||null,paypal:(D==null?void 0:D.paypal)||"",venmo:(D==null?void 0:D.venmo)||"",zelle:(D==null?void 0:D.zelle)||""}}return null},[B]),P=M=>{var L,D;b(M),k(M.selectedDate||((L=M.pickupDetails)==null?void 0:L.date)),C((D=M.pickupDetails)==null?void 0:D.time),p(!0)},F=()=>{p(!1),b(null),k(null),C(null)},I=M=>{k(M)},z=M=>{C(M)},H=h.useCallback(()=>{x(!1)},[]),V=async()=>{if(y&&f&&A){const M=y.orderType==="PRE_ORDER",L={date:f,time:A,display:M?`Pick up ${Q(f).format("MMM D ddd")}`:"Pick up today",orderType:M?"PRE_ORDER":"GO_GRAB"};console.log("🔄 Updating pickup details for item:",y),console.log("🔄 New pickup details:",L);try{await j({food:y.food,kitchen:w,newQuantity:y.quantity,currentQuantity:y.quantity,selectedDate:f,selectedTime:A,specialInstructions:y.specialInstructions||"",incomingOrderType:M?"PRE_ORDER":"GO_GRAB"}),Ae.success(`Pickup time updated to ${L.display} at ${L.time}`),F()}catch(D){console.error("Error updating pickup details:",D),Ae.error("Failed to update pickup time")}}else Ae.error("Please select both date and time")},ie=h.useMemo(()=>{const M={grabAndGo:[],preOrders:{}};console.log("Grouping cart items:",$),$.forEach(D=>{var J,ae,te,ce,se,de,we,U;const N=((J=D.pickupDetails)==null?void 0:J.orderType)||D.orderType||(D.isPreOrder?"PRE_ORDER":"GO_GRAB");if(N==="GO_GRAB")M.grabAndGo.push({...D,displayPickupTime:((ae=D.pickupDetails)==null?void 0:ae.display)||"Pick up today",displayPickupClock:((te=D.pickupDetails)==null?void 0:te.time)||Q().add(30,"minutes").format("h:mm A")});else if(N==="PRE_ORDER"||D.isPreOrder||D.selectedDate){const K=D.selectedDate||((ce=D.pickupDetails)==null?void 0:ce.date);K&&(M.preOrders[K]||(M.preOrders[K]=[]),M.preOrders[K].push({...D,displayPickupTime:((se=D.pickupDetails)==null?void 0:se.display)||`Pick up ${Q(K).format("MMM D ddd")}`,displayPickupClock:((de=D.pickupDetails)==null?void 0:de.time)||"6:30 PM"}))}else M.grabAndGo.push({...D,displayPickupTime:((we=D.pickupDetails)==null?void 0:we.display)||"Pick up today",displayPickupClock:((U=D.pickupDetails)==null?void 0:U.time)||Q().add(30,"minutes").format("h:mm A")})});const L={};return Object.keys(M.preOrders).sort((D,N)=>Q(D).diff(Q(N))).forEach(D=>{L[D]=M.preOrders[D]}),M.preOrders=L,M},[$]),Z=h.useMemo(()=>{const M=$.reduce((J,ae)=>{var se,de;const te=parseFloat(((se=ae.food)==null?void 0:se.cost)||((de=ae.food)==null?void 0:de.price)||0),ce=parseInt(ae.quantity||1);return J+te*ce},0),D=M*0,N=M+D;return{subtotal:M.toFixed(2),salesTax:D.toFixed(2),totalPayment:N.toFixed(2)}},[$]),ne=async M=>{if(M.length>0){const L=M[0];r(L),d(null),e&&URL.revokeObjectURL(e);const D=URL.createObjectURL(L);t(D);try{l(!0);const N=(W==null?void 0:W.uid)||"anonymous",J=await Sh(L,"payment-screenshots",N);s(J),Ae.success("Payment screenshot uploaded successfully!"),console.log("Firebase Storage URL:",J)}catch(N){console.error("Error uploading to Firebase:",N),d(N.message),Ae.error(`Upload failed: ${N.message}`)}finally{l(!1)}}},{getRootProps:oe,getInputProps:fe,isDragActive:Y}=$o({onDrop:ne,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".bmp",".webp"]},multiple:!1,maxSize:10*1024*1024}),G=()=>{e&&URL.revokeObjectURL(e),t(null),r(null),s(null),d(null)},T=async()=>{var M;try{if($.length===0){Ae.error("Your cart is empty. Please add items before placing an order.");return}if(console.log("Placing order for user:",W),console.log("Placing order for isAuthenticated:",R),!R||!W){console.log("🔒 Authentication required for placing order"),x(!0);return}if(S==="online"&&!a){Ae.error("Please upload a payment confirmation screenshot before placing your order.");return}if(!w||!w.id||!((M=$[0])!=null&&M.kitchenId)){Ae.error("Kitchen information is missing. Please return to the listing page and try again.");return}m(!0);const L=Fh({cartItems:$,kitchenInfo:w,firebaseImageUrl:a,currentUser:W,paymentCalculation:Z,groupedCartItems:ie,paymentType:S});console.log("Order data to be placed:",L);const D=await Ph(L);E(Kn()),Ae.success("Order placed successfully! Redirecting to success page..."),setTimeout(()=>{try{localStorage.removeItem("skipListing")}catch(N){console.error("Error removing skipListing from localStorage:",N)}O("/success",{state:{orderID:L==null?void 0:L.orderID,orderDocId:D,totalAmount:Z==null?void 0:Z.totalPayment,kitchenName:w==null?void 0:w.name,pickupAddress:w==null?void 0:w.address,orderedItems:$.map(N=>{var ce,se,de,we,U,K,re,ye,Ee,Xe;const J=((ce=N.pickupDetails)==null?void 0:ce.date)||N.selectedDate,ae=(se=N.pickupDetails)==null?void 0:se.orderType,te=ae==="PRE_ORDER"||N.isPreOrder||J&&J!==Q().format("YYYY-MM-DD");return console.log("🔍 [PaymentPage] Mapping cart item:",{name:(de=N.food)==null?void 0:de.name,pickupDate:J,orderType:ae,isPreOrderItem:te,originalIsPreOrder:N.isPreOrder}),{id:(N==null?void 0:N.foodId)||(N==null?void 0:N.id),foodItemId:(N==null?void 0:N.foodId)||(N==null?void 0:N.id),name:((we=N==null?void 0:N.food)==null?void 0:we.name)||"Unknown Item",description:((U=N==null?void 0:N.food)==null?void 0:U.description)||"This dish features tender, juicy flavors",imageUrl:((K=N==null?void 0:N.food)==null?void 0:K.imageUrl)||((re=N==null?void 0:N.food)==null?void 0:re.image),price:((ye=N==null?void 0:N.food)==null?void 0:ye.cost)||((Ee=N==null?void 0:N.food)==null?void 0:Ee.price)||"0.00",quantity:(N==null?void 0:N.quantity)||1,pickupDate:J,pickupTime:(Xe=N==null?void 0:N.pickupDetails)==null?void 0:Xe.time,isPreOrder:te,orderType:ae,isFromPreorder:(N==null?void 0:N.isFromPreorder)||te}})}})},2e3)}catch(L){console.error("Error placing order:",L),Ae.error(`Failed to place order: ${L.message}`)}finally{m(!1)}},q=async M=>{try{await navigator.clipboard.writeText(M),Ae.success(`${M} copied to clipboard!`)}catch(L){console.error("Failed to copy email:",L),Ae.error("Failed to copy email")}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"container",children:i.jsx("div",{className:"mobile-container",children:i.jsxs("div",{className:"padding-20 order-page",children:[i.jsx("h4",{className:"medium-title mb-12",children:"Pickup Address"}),i.jsx("p",{className:"body-text-med mb-20",children:w==null?void 0:w.address}),i.jsx("div",{className:"hr mb-18"}),i.jsxs("div",{className:"other-payments-wrapper mb-20",children:[i.jsxs("h2",{className:"title",children:["Other Payments acceptable to"," ",(w==null?void 0:w.name)||"the Kitchen"]}),(w==null?void 0:w.paypal)&&(w==null?void 0:w.paypal)!==""&&i.jsxs("div",{className:"item-flex",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"text",children:"PayPal to"}),i.jsx("a",{className:"email",children:w==null?void 0:w.paypal})]}),i.jsxs("div",{className:"copy",onClick:async()=>await q(w==null?void 0:w.paypal),children:[i.jsx(Rr,{})," Copy"]})]}),(w==null?void 0:w.venmo)&&(w==null?void 0:w.venmo)!==""&&i.jsxs("div",{className:"item-flex",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"text",children:"Venmo to"}),i.jsx("a",{className:"email",children:w==null?void 0:w.venmo})]}),i.jsxs("div",{className:"copy",onClick:async()=>await q(w==null?void 0:w.venmo),children:[i.jsx(Rr,{})," Copy"]})]}),(w==null?void 0:w.zelle)&&(w==null?void 0:w.zelle)!==""&&i.jsxs("div",{className:"item-flex",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"text",children:"Zelle to"}),i.jsx("a",{className:"email",children:w==null?void 0:w.zelle})]}),i.jsxs("div",{className:"copy",onClick:async()=>await q(w==null?void 0:w.zelle),children:[i.jsx(Rr,{})," Copy"]})]})]}),i.jsxs("div",{className:"payment-method mb-20",children:[i.jsx("h5",{className:"medium-title mb-20",children:"Payment Details"}),i.jsx("div",{className:"hr mb-20"}),i.jsxs("div",{className:"item-flex",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["$",Z.subtotal]})]}),i.jsxs("div",{className:"item-flex",children:[i.jsx("span",{children:"Sales Tax (0%)"}),i.jsxs("span",{children:["$",Z.salesTax]})]}),i.jsx("div",{className:"hr mb-12"}),i.jsxs("div",{className:"item-flex bold",children:[i.jsx("span",{children:"Total Payment"}),i.jsxs("span",{children:["$",Z.totalPayment]})]})]}),i.jsxs("div",{className:"order-items-section mb-20",children:[i.jsx("h3",{className:"order-items-title",children:"Select Pickup Date & Time"}),$.length===0?i.jsx("div",{className:"empty-cart-message",children:i.jsx("p",{className:"body-text-med",children:"No items in cart"})}):i.jsxs("div",{className:"pickup-items-list",children:[ie.grabAndGo.length>0&&ie.grabAndGo.map((M,L)=>{var D,N,J,ae,te,ce;return i.jsxs("div",{className:"pickup-item-row",children:[i.jsxs("div",{className:"item-info",children:[i.jsx("div",{className:"food-image",children:i.jsx("img",{src:((D=M.food)==null?void 0:D.imageUrl)||((N=M.food)==null?void 0:N.image),alt:(J=M.food)==null?void 0:J.name,onError:se=>{se.target.style.display="none"}})}),i.jsxs("div",{className:"food-details",children:[i.jsx("h5",{className:"food-name",children:((ae=M.food)==null?void 0:ae.name)||"Unknown Item"}),i.jsxs("div",{className:"pickup-time",children:[Q(M.selectedDate).format("dddd, MMMM D, YYYY")," ","at"," ",Q(M.selectedTime,"h:mm A").format("h:mm A")]}),i.jsxs("div",{className:"item-quantity",children:["Qty: ",M.quantity," × $",((te=M.food)==null?void 0:te.cost)||((ce=M.food)==null?void 0:ce.price)||"0.00"]})]})]}),i.jsx("div",{className:"edit-icon",role:"button",tabIndex:0,onClick:()=>P(M),children:i.jsx("img",{src:Ia,alt:"Edit pickup time"})})]},`grab-${M.foodId}-${L}`)}),Object.keys(ie.preOrders).length>0&&Object.entries(ie.preOrders).map(([M,L])=>L.map((D,N)=>{var J,ae,te,ce,se,de;return i.jsxs("div",{className:"pickup-item-row",children:[i.jsxs("div",{className:"item-info",children:[i.jsx("div",{className:"food-image",children:i.jsx("img",{src:((J=D.food)==null?void 0:J.imageUrl)||((ae=D.food)==null?void 0:ae.image),alt:(te=D.food)==null?void 0:te.name,onError:we=>{we.target.style.display="none"}})}),i.jsxs("div",{className:"food-details",children:[i.jsx("h5",{className:"food-name",children:((ce=D.food)==null?void 0:ce.name)||"Unknown Item"}),i.jsxs("div",{className:"pickup-time",children:[Q(D.selectedDate).format("dddd, MMMM D, YYYY")," ","at"," ",Q(D.selectedTime,"h:mm A").format("h:mm A")]}),i.jsxs("div",{className:"item-quantity",children:["Qty: ",D.quantity," × $",((se=D.food)==null?void 0:se.cost)||((de=D.food)==null?void 0:de.price)||"0.00"]})]})]}),i.jsx("div",{className:"edit-icon",role:"button",tabIndex:0,onClick:()=>P(D),children:i.jsx("img",{src:Ia,alt:"Edit pickup time"})})]},`preorder-${D.foodId}-${M}-${N}`)}))]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{children:[i.jsx("input",{type:"radio",id:"paymentType",value:"online",checked:S==="online",name:"paymentType",required:!0,onChange:()=>_("online")}),i.jsx("label",{htmlFor:"paymentType",className:"body-text-med ms-2",children:"Online payment"})]}),i.jsxs("div",{children:[i.jsx("input",{type:"radio",id:"paymentType2",value:"cash",checked:S==="cash",name:"paymentType",onChange:()=>_("cash")}),i.jsx("label",{htmlFor:"paymentType2",className:"body-text-med ms-2",children:"I will pay cash"})]})]}),S==="online"&&i.jsxs("div",{className:"upload-section mb-20",children:[i.jsx("h5",{className:"medium-title mb-12",children:"Payment Confirmation"}),i.jsx("p",{className:"body-text-med mb-16",children:"Upload payment confirmation screenshot"}),e?i.jsx("div",{className:"upload-preview-container",children:i.jsxs("div",{className:"upload-preview",children:[i.jsx("img",{src:e,alt:"Payment confirmation preview",className:"preview-image"}),i.jsx("button",{type:"button",className:"remove-image-btn",onClick:G,"aria-label":"Remove image",disabled:o,children:i.jsx(Ta,{size:16})}),o&&i.jsxs("div",{className:"upload-status-overlay",children:[i.jsx("div",{className:"upload-spinner"}),i.jsx("p",{children:"Uploading to Firebase..."})]})]})}):i.jsxs("div",{...oe(),className:`upload-dropzone ${Y?"active":""}`,children:[i.jsx("input",{...fe()}),i.jsxs("div",{className:"upload-content",children:[i.jsx("div",{className:"upload-icon",children:i.jsx(Ch,{size:32})}),i.jsx("h6",{className:"upload-title",children:Y?"Drop image here":"Upload Screenshot"}),i.jsxs("p",{className:"upload-description",children:["Drag & drop your payment confirmation or"," ",i.jsx("span",{className:"upload-link",children:"browse files"})]}),i.jsx("p",{className:"upload-formats",children:"Supports: JPG, PNG, GIF, WebP (Max 10MB)"})]})]})]}),i.jsx("button",{className:"action-button",onClick:T,disabled:u||o||$.length===0,children:u?"Placing Order...":R?"Place My Order":"Login to Place Order"})]})})}),g&&y&&i.jsx("div",{className:"modal-overlay",onClick:F,children:i.jsxs("div",{className:"modal-container",onClick:M=>M.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{className:"modal-title",children:"Edit Pickup Time"}),i.jsx("button",{className:"modal-close-btn",onClick:F,"aria-label":"Close modal",children:i.jsx(Ta,{size:24})})]}),i.jsxs("div",{className:"modal-content",children:[i.jsxs("div",{className:"editing-item-info",children:[i.jsx("h4",{children:((X=y.food)==null?void 0:X.name)||"Food Item"}),i.jsxs("p",{children:["Current pickup: ",y.displayPickupTime," at"," ",y.displayPickupClock]})]}),i.jsx("div",{className:"date-time-picker-container",children:i.jsx(In,{food:y.food,kitchen:w,orderType:y.orderType||((ee=y.pickupDetails)==null?void 0:ee.orderType)||"GO_GRAB",selectedDate:f,selectedTime:A,onDateChange:I,onTimeChange:z,disabled:!1,className:"payment-modal-picker",dateLabel:"Select Pickup Date:",timeLabel:"Select Pickup Time:"})})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn-secondary",onClick:F,children:"Cancel"}),i.jsx("button",{className:"btn-primary",onClick:V,disabled:!f||!A,children:"Update Pickup Time"})]})]})}),v&&i.jsx(Do,{firebaseImageUrl:a,onClose:H})]})}const Mh="data:image/svg+xml,%3csvg%20width='173'%20height='162'%20viewBox='0%200%20173%20162'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='85.5'%20cy='93'%20r='67'%20fill='%23829F35'/%3e%3ccircle%20cx='166'%20cy='32.5'%20r='6.5'%20fill='%23829F35'/%3e%3cellipse%20cx='11'%20cy='10'%20rx='10.5'%20ry='10'%20fill='%23829F35'/%3e%3cellipse%20cx='5.5'%20cy='136.5'%20rx='5'%20ry='5.5'%20fill='%23829F35'/%3e%3cellipse%20cx='154'%20cy='160'%20rx='2.5'%20ry='2'%20fill='%23829F35'/%3e%3cpath%20d='M82.1976%20111C80.5838%20111%2078.9701%20110.393%2078.048%20109.179L65.138%2094.6121C63.2937%2092.5889%2063.7548%2089.7565%2066.0602%2088.1379C68.3655%2086.5193%2071.593%2086.924%2073.4373%2088.9472L82.1976%2098.8609L101.563%2076.808C103.407%2074.7848%20106.635%2074.3801%20108.94%2075.9987C111.245%2077.6173%20111.706%2080.4498%20109.862%2082.4729L86.3473%20109.179C85.1946%20110.191%2083.8114%20111%2082.1976%20111Z'%20fill='white'/%3e%3ccircle%20cx='114'%20cy='103.5'%20r='2.5'%20fill='white'/%3e%3ccircle%20cx='48.5'%20cy='76'%20r='4'%20fill='white'/%3e%3ccircle%20cx='107'%20cy='54.5'%20r='1.5'%20fill='white'/%3e%3ccircle%20cx='65.5'%20cy='125'%20r='2'%20fill='white'/%3e%3ccircle%20cx='87.5'%20cy='77'%20r='1'%20fill='white'/%3e%3c/svg%3e";function Uh(){const t=Kt().state||{},{orderID:n,totalAmount:r,kitchenName:a,pickupAddress:s,orderedItems:o}=t;console.log("🔍 [SuccessPage] Order details received:",{orderID:n,totalAmount:r,kitchenName:a,pickupAddress:s,orderedItemsCount:(o==null?void 0:o.length)||0,orderedItems:o});const l=()=>window.WeixinJSBridge?(window.WeixinJSBridge.call("closeWindow"),!0):!1,c=()=>{if(l()){console.log("Closed WeChat window");return}const y=localStorage.getItem("detailPage");if(y){console.log("Going back to detailPage from localStorage:",y),window.location.href=y;return}window.location.href="/"},d=p=>p?Q(p).format("ddd, MMM D"):"Today",u=h.useMemo(()=>{if(!(o!=null&&o.length))return{goGrab:[],preOrders:{}};const p={goGrab:[],preOrders:{}};return console.log("🔍 [SuccessPage] Grouping ordered items:",o),o.forEach(y=>{if(console.log("🔍 [SuccessPage] Processing item:",{name:y.name,isPreOrder:y.isPreOrder,pickupDate:y.pickupDate,hasPickupDate:!!y.pickupDate}),(y.orderType==="PRE_ORDER"||y.orderType==="Pre-Order")&&y.pickupDate){const f=y.pickupDate;p.preOrders[f]||(p.preOrders[f]=[]),p.preOrders[f].push(y),console.log("🔍 [SuccessPage] Added to pre-orders for date:",f)}else p.goGrab.push(y),console.log("🔍 [SuccessPage] Added to go&grab")}),console.log("🔍 [SuccessPage] Final grouping:",{goGrabCount:p.goGrab.length,preOrderDates:Object.keys(p.preOrders),preOrderCounts:Object.entries(p.preOrders).map(([y,b])=>({date:y,count:b.length}))}),p},[o]),m=h.useMemo(()=>{if(!(o!=null&&o.length))return{subtotal:"0.00",tax:"0.00",total:"0.00"};const p=o.reduce((f,k)=>{const A=parseFloat(k.price||k.cost||0),C=parseInt(k.quantity||1);return f+A*C},0),y=p*0,b=p+y;return{subtotal:p.toFixed(2),tax:y.toFixed(2),total:b.toFixed(2)}},[o]),g=(o==null?void 0:o.reduce((p,y)=>p+parseInt(y.quantity||1),0))||0;return i.jsx("div",{className:"container",children:i.jsx("div",{className:"mobile-container",children:i.jsxs("div",{className:"padding-20 order-page",children:[i.jsxs("div",{className:"success-image-wrapper pt-5",children:[i.jsx("img",{src:Mh,alt:"Success"}),i.jsx("h2",{className:"title",children:"Your order has been successfully placed"})]}),o&&o.length>0?i.jsxs(i.Fragment,{children:[u.goGrab.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"small-title mb-16",children:"Go & Grab"}),i.jsx("div",{className:"menu-listing",children:u.goGrab.map((p,y)=>i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:p.imageUrl||"/src/assets/images/product.png",alt:p.name||"Food item",onError:b=>{b.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:p.name||"Unknown Item"}),i.jsx("div",{className:"text",children:p.description||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",p.price||p.cost||"0.00"]})]})]}),i.jsx("div",{className:"quantity-warpper",children:i.jsx("div",{className:"right",children:i.jsxs("div",{className:"quantity-text",children:["Qty: ",p.quantity||1]})})})]},`go-grab-${p.foodItemId||p.id}-${y}`))})]}),Object.entries(u.preOrders).map(([p,y])=>i.jsxs("div",{children:[i.jsxs("h2",{className:"small-title mb-16",children:["Pre-order for ",d(p)]}),i.jsx("div",{className:"menu-listing",children:y.map((b,f)=>i.jsxs("div",{className:"menu-list",children:[i.jsxs("div",{className:"left",children:[i.jsx("div",{className:"image",children:i.jsx("img",{src:b.imageUrl||"/src/assets/images/product.png",alt:b.name||"Food item",onError:k=>{k.target.src="/src/assets/images/product.png"}})}),i.jsxs("div",{className:"data",children:[i.jsx("div",{className:"title",children:b.name||"Unknown Item"}),i.jsx("div",{className:"text",children:b.description||"This dish features tender, juicy flavors"}),i.jsxs("div",{className:"price",children:["$ ",b.price||b.cost||"0.00"]})]})]}),i.jsx("div",{className:"quantity-warpper",children:i.jsxs("div",{className:"right flex-column",children:[i.jsxs("div",{className:"quantity-text",children:["Qty: ",b.quantity||1]}),b.pickupTime&&i.jsx("div",{className:"pickup-time-display",children:b.pickupTime})]})})]},`preorder-${b.foodItemId||b.id}-${p}-${f}`))})]},p)),i.jsxs("div",{className:"order-summary",style:{backgroundColor:"#f8f9fa",padding:"16px",borderRadius:"8px",marginTop:"24px",marginBottom:"16px"},children:[i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsxs("span",{children:["Subtotal (",g," item",g!==1?"s":"","):"]}),i.jsxs("span",{children:["$",m.subtotal]})]}),i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsx("span",{children:"Tax (0%):"}),i.jsxs("span",{children:["$",m.tax]})]}),i.jsxs("div",{className:"summary-row",style:{display:"flex",justifyContent:"space-between",fontWeight:"600",fontSize:"16px",borderTop:"1px solid #dee2e6",paddingTop:"8px"},children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",m.total]})]})]})]}):i.jsxs("div",{style:{padding:"20px",background:"#f0f0f0",margin:"20px 0",borderRadius:"8px"},children:[i.jsx("h4",{children:"Debug: No Ordered Items Found"}),i.jsxs("p",{children:["Order Details: ",JSON.stringify(t,null,2)]})]}),i.jsx("div",{className:"success-actions mb-16",children:i.jsx(wt,{onClick:c,className:"action-button",children:"Back to Home"})}),i.jsxs("div",{className:"scanner-bottom mb-16",children:[i.jsxs("div",{className:"text",children:["Order can be viewed in the ",i.jsx("strong",{children:"HomeFresh"})," app, available in the iOS App Store. The app also sends reminders on the morning of each scheduled pickup."]}),i.jsx("div",{className:"qr",children:i.jsx("img",{src:Co,alt:"QR Code"})})]})]})})})}function zh(){const{user:e,initializing:t}=gi(),n=Kt();return t?i.jsx("div",{className:"d-flex vh-100 align-items-center justify-content-center",children:"Loading..."}):e?i.jsx(Yo,{}):i.jsx(Wo,{to:"/login",replace:!0,state:{from:n}})}class qh extends Fn.Component{constructor(n){super(n);et(this,"logErrorToService",(n,r,a)=>{console.log("📡 [ERROR BOUNDARY] Logging error to service:",a)});et(this,"handleReload",()=>{window.location.reload()});et(this,"handleGoBack",()=>{window.history.back()});et(this,"handleCopyError",()=>{var r,a,s;const n={errorId:this.state.errorId,message:(r=this.state.error)==null?void 0:r.message,stack:(a=this.state.error)==null?void 0:a.stack,componentStack:(s=this.state.errorInfo)==null?void 0:s.componentStack,timestamp:new Date().toISOString(),url:window.location.href};navigator.clipboard.writeText(JSON.stringify(n,null,2)).then(()=>{alert("Error details copied to clipboard!")}).catch(()=>{console.error("Failed to copy error details")})});et(this,"toggleErrorDetails",()=>{this.setState(n=>({showDetails:!n.showDetails}))});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){const a=`ERR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.error("🚨 [ERROR BOUNDARY] Application crashed:",{errorId:a,error:n.message,stack:n.stack,componentStack:r.componentStack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href}),this.setState({error:n,errorInfo:r,errorId:a}),this.logErrorToService(n,r,a)}render(){if(this.state.hasError){const{error:n,errorInfo:r,errorId:a,showDetails:s}=this.state;return i.jsx("div",{className:"error-boundary",children:i.jsxs("div",{className:"error-boundary-container",children:[i.jsxs("div",{className:"error-boundary-header",children:[i.jsx("div",{className:"error-icon",children:"🚨"}),i.jsx("h1",{children:"Oops! Something went wrong"}),i.jsx("p",{className:"error-subtitle",children:"The application encountered an unexpected error and crashed."})]}),i.jsxs("div",{className:"error-boundary-content",children:[i.jsxs("div",{className:"error-summary",children:[i.jsx("h3",{children:"Error Summary"}),i.jsxs("div",{className:"error-item",children:[i.jsx("span",{className:"error-label",children:"Error ID:"}),i.jsx("code",{className:"error-value",children:a})]}),i.jsxs("div",{className:"error-item",children:[i.jsx("span",{className:"error-label",children:"Message:"}),i.jsx("code",{className:"error-value",children:(n==null?void 0:n.message)||"Unknown error"})]}),i.jsxs("div",{className:"error-item",children:[i.jsx("span",{className:"error-label",children:"Time:"}),i.jsx("code",{className:"error-value",children:new Date().toLocaleString()})]}),i.jsxs("div",{className:"error-item",children:[i.jsx("span",{className:"error-label",children:"Page:"}),i.jsx("code",{className:"error-value",children:window.location.pathname})]})]}),i.jsxs("div",{className:"error-actions",children:[i.jsx("button",{onClick:this.handleReload,className:"error-btn error-btn-primary",children:"🔄 Reload Page"}),i.jsx("button",{onClick:this.handleGoBack,className:"error-btn error-btn-secondary",children:"⬅️ Go Back"}),i.jsx("button",{onClick:this.handleCopyError,className:"error-btn error-btn-copy",children:"📋 Copy Error Details"})]}),i.jsxs("div",{className:"error-details-section",children:[i.jsxs("button",{onClick:this.toggleErrorDetails,className:"error-details-toggle",children:[s?"▼":"▶"," Developer Details",!s&&i.jsx("span",{className:"toggle-hint",children:"(Click to expand)"})]}),s&&i.jsxs("div",{className:"error-details",children:[i.jsxs("div",{className:"error-detail-block",children:[i.jsx("h4",{children:"Stack Trace"}),i.jsx("pre",{className:"error-stack",children:(n==null?void 0:n.stack)||"No stack trace available"})]}),i.jsxs("div",{className:"error-detail-block",children:[i.jsx("h4",{children:"Component Stack"}),i.jsx("pre",{className:"error-stack",children:(r==null?void 0:r.componentStack)||"No component stack available"})]}),i.jsxs("div",{className:"error-detail-block",children:[i.jsx("h4",{children:"Browser Info"}),i.jsx("pre",{className:"error-stack",children:`User Agent: ${navigator.userAgent}
URL: ${window.location.href}
Timestamp: ${new Date().toISOString()}`})]})]})]}),i.jsxs("div",{className:"error-help",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Need help?"})," This error has been logged with ID: ",i.jsx("code",{children:a})]}),i.jsx("p",{children:"You can copy the error details above and share them with the development team."})]})]})]})})}return this.props.children}}const Bh=()=>{const[e,t]=h.useState(!1);if(e)throw new Error("This is a test error for debugging!");return i.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[i.jsx("h2",{children:"Error Boundary Test"}),i.jsx("button",{onClick:()=>t(!0),style:{padding:"10px 20px",backgroundColor:"#ff6b6b",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"🚨 Trigger Test Error"})]})};function Wh(){return i.jsx(qh,{children:i.jsxs(Go,{children:[i.jsx(Oe,{path:"/",element:i.jsx(vf,{})}),i.jsx(Oe,{path:"/foods",element:i.jsx(fa,{})}),i.jsx(Oe,{path:"/foods/:kitchenId",element:i.jsx(fa,{})}),i.jsx(Oe,{path:"/share",element:i.jsx(va,{})}),i.jsx(Oe,{path:"/share/",element:i.jsx(va,{})}),i.jsx(Oe,{path:"/order",element:i.jsx(kf,{})}),i.jsx(Oe,{path:"/checkout",element:i.jsx($h,{})}),i.jsx(Oe,{path:"/success",element:i.jsx(Uh,{})}),i.jsx(Oe,{path:"/login",element:i.jsx(tf,{})}),i.jsx(Oe,{path:"/wechat/callback",element:i.jsx(rf,{})}),i.jsx(Oe,{path:"/wechat/debug",element:i.jsx(sf,{})}),i.jsx(Oe,{path:"/test-error",element:i.jsx(Bh,{})}),i.jsx(Oe,{element:i.jsx(zh,{}),children:i.jsx(Oe,{path:"/home",element:i.jsx(ef,{})})})]})})}const Yh=()=>{const e=it(),t=Se(s=>s.auth),[n,r]=h.useState(window.innerWidth<768);h.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const a=()=>{e(bs())};return n?null:i.jsxs("div",{style:{position:"fixed",top:"10px",right:"10px",background:"#f8f9fa",padding:"15px",border:"2px solid #dee2e6",borderRadius:"8px",fontSize:"12px",fontFamily:"monospace",zIndex:9999,maxWidth:"300px"},children:[i.jsx("h6",{style:{margin:"0 0 10px 0",fontSize:"14px"},children:"🔍 Auth Debug Panel"}),i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("strong",{children:"Is Authenticated:"})," ",i.jsx("span",{style:{color:t.isAuthenticated?"green":"red"},children:t.isAuthenticated?"✅ YES":"❌ NO"})]}),i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("strong",{children:"Auth Status:"})," ",i.jsx("span",{style:{color:t.loading?"orange":"gray"},children:t.loading?"� LOADING":"READY"})]}),i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("strong",{children:"User:"})," ",t.user?i.jsx("span",{style:{color:"green"},children:t.user.nickname||t.user.openid||"WeChat User"}):i.jsx("span",{style:{color:"red"},children:"None"})]}),t.error&&i.jsxs("div",{style:{marginBottom:"10px",color:"red"},children:[i.jsx("strong",{children:"Error:"})," ",t.error]}),t.isAuthenticated&&i.jsx("button",{onClick:a,style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:"🔓 Logout"}),i.jsx("div",{style:{marginTop:"10px",fontSize:"10px",color:"#6c757d"},children:"WeChat Authentication System"})]})};ul.createRoot(document.getElementById("root")).render(i.jsx(Fn.StrictMode,{children:i.jsx(Sl,{store:bo,children:i.jsx(Va,{loading:i.jsx("div",{children:"Loading..."}),persistor:wo,children:i.jsx(Ko,{children:i.jsxs(Xm,{children:[i.jsx(Wh,{}),i.jsx(Yh,{}),i.jsx(jc,{position:"top-center",reverseOrder:!1,gutter:8,toastOptions:{duration:3e3,style:{background:"#fff",color:"#333",borderRadius:"12px",padding:"16px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid #e0e0e0"},success:{iconTheme:{primary:"#10B981",secondary:"#fff"}},error:{iconTheme:{primary:"#EF4444",secondary:"#fff"}}}})]})})})})}));
